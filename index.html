<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
            cursor: text;
        }
        th {
            background-color: #003366;
            color: white;
            padding: 12px 8px;
            text-align: center;
            position: relative;
            cursor: pointer;
            font-weight: bold;
        }
        th:hover {
            background-color: #004080;
        }
        /* ‡∏•‡∏ö sort icons ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î */
        .pivot-table th {
            background-color: #f4f4f4;
            color: #333;
            font-weight: normal;
        }
        .pivot-table th:first-child {
            background-color: #f4f4f4;
            color: #333;
        }
        .grand-total th, .grand-total td {
            background-color: #b7e1cd;
            color: #333;
        }
        .pivot-table th, .pivot-table td {
            background-color: #e6f3ff;
        }
        .pivot-table th:first-child, .pivot-table td:first-child {
            background-color: #d9ead3;
        }
        .area-total {
            color: #006400; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
        }
        canvas {
            margin-top: 20px;
            max-width: 800px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏£‡∏≤‡∏ü */
            max-height: 400px;
        }
        .controls {
            margin-bottom: 20px;
            display: flex;
            justify-content: flex-end;
            align-items: center;
        }
        .controls button {
            margin-right: 10px;
            padding: 10px 15px;
            font-size: 14px;
            cursor: pointer;
        }
        .card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 15px 25px;
            text-align: center;
            margin: 0;
            min-width: 250px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .card-icon {
            width: 48px;
            height: 48px;
            color: #006400;
            margin-right: 15px;
            flex-shrink: 0;
        }
        .card-content {
            flex-grow: 1;
        }
        .card-title {
            color: #333;
            font-size: 14px;
            margin-bottom: 5px;
            text-align: left;
        }
        .card-value {
            color: #006400;
            font-size: 20px;
            font-weight: bold;
            text-align: left;
        }
        #chart-container {
            margin-left: 0px;
            padding-left: 20px;
            position: relative;
            display: flex;
            flex-direction: row; /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô row ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≤‡∏ü‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
            gap: 20px;
            width: calc(100% - 20px);
            margin-bottom: 20px;
        }
        
        /* Responsive design ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü */
        @media (max-width: 1200px) {
            #chart-container {
                margin-left: 0;
                padding-left: 20px;
                width: calc(100% - 20px);
            }
        }
        
        /* ‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤ body ‡πÅ‡∏•‡∏∞ parent containers ‡πÑ‡∏°‡πà‡∏ã‡πà‡∏≠‡∏ô legend */
        body {
            overflow-x: visible;
        }
        
        .main-page {
            overflow: visible;
        }
        .chart-wrapper {
            flex: 1;
            min-width: 0;
            position: relative;
            overflow: visible;
        }
        
        /* Force ‡∏™‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° legend ‡∏Ç‡∏≠‡∏á Chart.js ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏î‡∏≥ */
        .chartjs-legend li span,
        .chartjs-legend-item span,
        .chartjs-legend li,
        .chartjs-legend-item,
        canvas + div li,
        canvas + div span {
            color: #000000 !important;
        }
        
        /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Chart.js v3+ */
        .chartjs-legend .chartjs-legend-item,
        .chartjs-legend .chartjs-legend-item span {
            color: #000000 !important;
        }
        .total-display {
            position: absolute;
            top: -30px;
            right: 0;
            font-size: 16px;
            font-weight: bold;
            color: #006400;
        }
        #chart-label {
            position: absolute;
            top: -20px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° */
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            font-weight: bold;
        }
        canvas#myChart {
            height: 500px !important; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏ü */
            max-height: 500px !important;
        }
        .card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 15px 25px;
            text-align: center;
            margin: 0;
            min-width: 250px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .card-content {
            flex: 1;
        }
        .card-icon {
            width: 48px;
            height: 48px;
            color: #006400;
        }
        .card-title {
            color: #333;
            font-size: 18px;
            margin-bottom: 10px;
        }
        .card-value {
            color: #006400;
            font-size: 24px;
            font-weight: bold;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å */
        #data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
        }
        #data-table th, #data-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
            cursor: text;
            background-color: white;
            position: relative;
        }
        #data-table tbody tr td {
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
            cursor: text;
        }
        #data-table th {
            background-color: #003366;
            color: white;
            padding: 12px 8px;
            text-align: center;
            position: relative;
            cursor: pointer;
            font-weight: bold;
        }
        #data-table th:hover {
            background-color: #004080;
        }
        /* ‡∏•‡∏ö sort icons ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏≠‡∏Å */
        .table-header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .table-header-container h2 {
            margin: 0;
        }
        .table-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .search-container {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .search-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            width: 200px;
        }
        .search-input:focus {
            outline: none;
            border-color: #003366;
            box-shadow: 0 0 0 2px rgba(0, 51, 102, 0.1);
        }
        .table-buttons button {
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .table-buttons button:hover {
            background-color: #f0f0f0;
        }
        .table-buttons button svg {
            width: 16px;
            height: 16px;
                }
        .legend-container {
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%);
            display: flex !important;
            flex-direction: column;
            gap: 10px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            width: 180px;
            z-index: 1000;
        }
        .legend-item {
            display: flex !important;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        
        /* Force legend visibility ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü‡∏´‡∏•‡∏±‡∏Å */
        #chart-container .chart-wrapper:first-child .legend-container {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: static !important;
            left: auto !important;
            top: auto !important;
            transform: none !important;
            flex-direction: row !important;
            flex-wrap: wrap !important;
            justify-content: center !important;
            width: 100% !important;
            margin-bottom: 20px !important;
        }
        /* Force legend visibility ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü Daily - ‡∏à‡∏±‡∏î‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
        #chart-container .chart-wrapper:last-child .legend-container {
            visibility: visible !important;
            opacity: 1 !important;
            position: static !important;
            left: auto !important;
            top: auto !important;
            transform: none !important;
            flex-direction: row !important;
            flex-wrap: wrap !important;
            justify-content: center !important;
            width: 100% !important;
            margin-bottom: 20px !important;
        }
        
        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü Daily Chart ‡πÉ‡∏´‡πâ Legend ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏ü */
        #chart-container .chart-wrapper:last-child {
            display: flex;
            flex-direction: column;
        }
        
        #chart-container .chart-wrapper:last-child h3 {
            margin-top: 0px !important;
            margin-bottom: 15px !important;
            order: -1; /* ‡πÉ‡∏´‡πâ title ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
        }
        
        /* ‡∏™‡∏£‡πâ‡∏≤‡∏á container ‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö legend ‡πÅ‡∏•‡∏∞ chart ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
        .legend-and-chart-container {
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            gap: 20px !important;
            width: 100% !important;
        }
        
        
        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á chart container ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö layout ‡πÅ‡∏ö‡∏ö column */
        #chart-container .chart-wrapper:last-child .legend-and-chart-container > div:last-child {
            min-width: 0; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ overflow */
            width: 100%;
            display: flex;
            justify-content: center;
        }
        
        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á legend items ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö daily chart ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
        #chart-container .chart-wrapper:last-child .legend-item {
            margin-bottom: 5px;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        
        .legend-item:hover {
            background-color: #f5f5f5;
        }
        .legend-item.hidden .legend-color {
            opacity: 0.5;
        }
        .legend-item.hidden span {
            color: #999;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        .header-container {
            background-color: #003366;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            width: 100%;
        }
        h1 {
            color: white;
            margin: 0;
            font-size: 24px;
        }
        #current-date {
            color: white;
            font-size: 16px;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤ */
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding: 10px 0;
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö pagination ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
        #pagination-container-top {
            margin-top: 10px;
            margin-bottom: 15px;
        }
        

        .pagination-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .pagination-button {
            padding: 8px 12px;
            background-color: #003366;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        .pagination-button:hover {
            background-color: #004080;
        }
        .pagination-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .pagination-info {
            font-size: 14px;
            color: #333;
            margin: 0 10px;
        }
        .page-size-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .page-size-selector select {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .page-size-selector label {
            font-size: 14px;
            color: #333;
        }
        .pagination-pages {
            display: flex;
            gap: 5px;
            align-items: center;
        }
        .page-number {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        .page-number.active {
            background-color: #003366;
            color: white;
            border-color: #003366;
        }
        .page-number:hover:not(.active) {
            background-color: #f5f5f5;
        }
        .page-ellipsis {
            padding: 6px 5px;
            font-size: 14px;
            color: #333;
        }



        /* Group Code Chart Container */
        #group-code-chart-container {
            margin-left: 20px;
            position: relative;
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        #group-code-legend {
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            width: 180px;
        }

        canvas#groupCodeChart, canvas#groupCodeLineChart {
            height: 500px !important;
            max-height: 500px !important;
        }

        /* Animation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö loading spinner */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Table Filter Dropdown -->
    <style>
        /* Table Filter Styles */
        .th-content {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            position: relative;
            white-space: nowrap;
            min-width: 120px;
            gap: 8px;
        }
        
        .sort-icon {
            margin-right: 5px !important;
            opacity: 0.7;
            font-size: 12px;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .sort-icon:hover {
            opacity: 1;
        }
        
        .filter-dropdown {
            position: relative;
            margin-left: auto;
            flex-shrink: 0;
        }
        
        .filter-btn {
            background: none;
            border: none;
            color: white;
            font-size: 12px;
            cursor: pointer;
            padding: 2px 4px;
            border-radius: 3px;
            transition: background-color 0.2s;
        }
        
        .filter-btn:hover {
            background-color: rgba(255,255,255,0.2);
        }
        
        .filter-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            min-width: 200px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .filter-menu.show {
            display: block;
        }
        
        .filter-search {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        
        .filter-search input {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 12px;
        }
        
        .filter-options {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .filter-options label {
            display: flex;
            align-items: center;
            padding: 6px 8px;
            font-size: 12px;
            color: #333;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .filter-options label:hover {
            background-color: #f5f5f5;
        }
        
        .filter-options input[type="checkbox"] {
            margin-right: 8px;
        }
        
        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á data-table */
        #data-table th {
            position: relative;
            padding: 12px 8px;
            background-color: #003366;
            color: white;
            border: 1px solid #ddd;
            text-align: left;
            font-weight: bold;
        }
        
        #data-table td {
            padding: 8px;
            border: 1px solid #ddd;
            font-size: 13px;
        }
        
        /* Hidden rows */
        .filtered-out {
            display: none !important;
        }
    </style>

    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Simple Navbar -->
    <style>
        .navbar {
            background: linear-gradient(135deg, #003366, #004080);
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
        }
        
        .navbar-brand {
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        
        .navbar-menu {
            display: flex;
            align-items: center;
            margin-left: 15px;
            gap: 10px;
        }
        
        .nav-item {
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            padding: 10px 20px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .nav-item.active {
            background: rgba(255,255,255,0.2);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .nav-item:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .navbar-status {
            color: rgba(255,255,255,0.8);
            font-size: 14px;
            margin-left: auto;
        }
        
        /* Responsive navbar */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .navbar-menu {
                justify-content: center;
                margin-left: 0;
                flex-wrap: wrap;
            }
            
            .navbar-status {
                order: -1;
            }
        }
        
        /* CSS ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Daily Chart Layout - FORCE LAYOUT */
        
        /* Responsive design ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü Daily */
        @media (max-width: 1000px) {
            .chart-wrapper div[style*="display: flex"] {
                flex-direction: column !important;
                align-items: center !important;
                gap: 15px !important;
            }
            
        }
        
        /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ã‡∏π‡∏°‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 80% ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏Ñ‡∏ö */
        @media (max-width: 800px) {
            .chart-wrapper div[style*="display: flex"] {
                flex-direction: column !important;
                align-items: center !important;
                justify-content: center !important;
                gap: 15px !important;
                max-width: 100% !important;
                overflow-x: visible !important;
            }
            
        }
        .legend-and-chart-container {
            display: flex !important;
            flex-direction: row !important;
            align-items: flex-start !important;
            gap: 20px !important;
            width: 100% !important;
        }
        
        .legend-and-chart-container .legend-container {
            display: flex !important;
            flex-direction: column !important;
            width: 200px !important;
            flex-shrink: 0 !important;
            margin-right: 20px !important;
            margin-bottom: 0px !important;
        }
        
        .legend-and-chart-container > div:last-child {
            flex: 1 !important;
            min-width: 0 !important;
        }
        
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</head>
<body>
    <div class="header-container">
        <h1>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà(2025)</h1>
        <p id="current-date"></p>
    </div>

    <!-- Simple Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-brand">üìä SLA Training Dashboard</div>
        <div class="navbar-menu">
            <a href="#" class="nav-item active" onclick="showHomePage()">
                üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </a>
            <a href="#" class="nav-item" onclick="showDailyReport()">
                üìã ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
            </a>
        </div>
        <div class="navbar-status">
            <span id="navbar-status">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</span>
        </div>
    </nav>

    <!-- Training Status Section -->
    <div id="main-page">
    <div id="training-status">
        <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡∏•‡∏±‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ -->
        <div style="margin-bottom: 20px;">
            <div style="display: flex; gap: 8px; justify-content: flex-start; overflow-x: auto;">
                <div class="card" style="width: 14%; min-width: 120px; padding: 8px 12px; background-color: #203864; color: white;">
                    <svg class="card-icon" style="width: 24px; height: 24px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 14V16C8.69 16 6 18.69 6 22H4C4 17.58 7.58 14 12 14ZM12 13C9.33 13 7 10.67 7 8C7 5.33 9.33 3 12 3C14.67 3 17 5.33 17 8C17 10.67 14.67 13 12 13ZM12 5C10.44 5 9 6.44 9 8C9 9.56 10.44 11 12 11C13.56 11 15 9.56 15 8C15 6.44 13.56 5 12 5Z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title" style="font-size: 13px; white-space: nowrap; color: white;">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°</div>
                        <div class="card-value" id="total-technician-count" style="font-size: 16px; color: white;">-</div>
                    </div>
                </div>
                <div class="card" style="width: 14%; min-width: 120px; padding: 8px 12px; background-color: #F0A483; color: white;">
                    <svg class="card-icon" style="width: 24px; height: 24px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title" style="font-size: 13px; white-space: nowrap; color: white;">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°</div>
                        <div class="card-value" id="not-attended-count" style="font-size: 16px; color: white;">-</div>
                    </div>
                </div>
                <div class="card" style="width: 14%; min-width: 120px; padding: 8px 12px; background-color: #E8CA6B; color: white;">
                    <svg class="card-icon" style="width: 24px; height: 24px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title" style="font-size: 13px; white-space: nowrap; color: white;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°</div>
                        <div class="card-value" id="attended-count" style="font-size: 16px; color: white;">-</div>
                    </div>
                </div>
                <div class="card" style="width: 14%; min-width: 120px; padding: 8px 12px; background-color: #D90429; color: white;">
                    <svg class="card-icon" style="width: 24px; height: 24px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title" style="font-size: 13px; white-space: nowrap; color: white;">‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°</div>
                        <div class="card-value" id="failed-training-count" style="font-size: 16px; color: white;">-</div>
                    </div>
                </div>
                <div class="card" style="width: 14%; min-width: 120px; padding: 8px 12px; background-color: #056D8D; color: white;">
                    <svg class="card-icon" style="width: 24px; height: 24px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title" style="font-size: 13px; white-space: nowrap; color: white;">‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°</div>
                        <div class="card-value" id="passed-training-count" style="font-size: 16px; color: white;">-</div>
                    </div>
                </div>
                <div class="card" style="width: 14%; min-width: 120px; padding: 8px 12px; background-color: #C55A11; color: white;">
                    <svg class="card-icon" style="width: 24px; height: 24px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title" style="font-size: 13px; white-space: nowrap; color: white;">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°</div>
                        <div class="card-value" id="in-training-count" style="font-size: 16px; color: white;">-</div>
                    </div>
                </div>
                <div class="card" style="width: 14%; min-width: 120px; padding: 8px 12px; background-color: #0EAD69; color: white;">
                    <svg class="card-icon" style="width: 24px; height: 24px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title" style="font-size: 13px; white-space: nowrap; color: white;">‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</div>
                        <div class="card-value" id="new-technician-count" style="font-size: 16px; color: white;">-</div>
                    </div>
                </div>
                <div class="card" style="width: 14%; min-width: 120px; padding: 8px 12px;">
                    <svg class="card-icon" style="width: 24px; height: 24px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 14V16C8.69 16 6 18.69 6 22H4C4 17.58 7.58 14 12 14ZM12 13C9.33 13 7 10.67 7 8C7 5.33 9.33 3 12 3C14.67 3 17 5.33 17 8C17 10.67 14.67 13 12 13ZM12 5C10.44 5 9 6.44 9 8C9 9.56 10.44 11 12 11C13.56 11 15 9.56 15 8C15 6.44 13.56 5 12 5ZM20.75 16C21.44 16 22 16.56 22 17.25C22 17.94 21.44 18.5 20.75 18.5H19.5V19.75C19.5 20.44 18.94 21 18.25 21C17.56 21 17 20.44 17 19.75V18.5H15.75C15.06 18.5 14.5 17.94 14.5 17.25C14.5 16.56 15.06 16 15.75 16H17V14.75C17 14.06 17.56 13.5 18.25 13.5C18.94 13.5 19.5 14.06 19.5 14.75V16H20.75Z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title" style="font-size: 13px; white-space: nowrap;">SLA ‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</div>
                        <div class="card-value" id="sla-value" style="font-size: 16px;">-</div>
                    </div>
                </div>
            </div>
        </div>





    <!-- Container ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü‡∏´‡∏•‡∏±‡∏Å 2 ‡∏ï‡∏±‡∏ß -->
    <div id="chart-container" style="display: flex; gap: 20px; margin: 20px 0;">
        <!-- ‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏° by Month -->
        <div class="chart-wrapper" style="flex: 1;">
            <h3 style="color: #003366; margin-bottom: 15px; text-align: center;">üìä Training Registration vs Completion by Month</h3>
            <div id="chart-label"></div>
            <canvas id="myChart" width="400" height="400"></canvas>
        </div>
        
        <!-- ‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ä‡πà‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà -->
        <div class="chart-wrapper" style="flex: 1;">
            <h4 id="area-chart-title" style="color: #003366; margin-bottom: 15px; text-align: center;">üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ä‡πà‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (Stack Column Chart)</h4>
            <div style="background-color: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border: 1px solid #e9ecef;">
                <!-- Legend for Area Status Chart - ‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô -->
                <div id="area-status-legend" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; padding: 10px; background-color: #f8f9fa; border-radius: 6px; max-height: 120px; overflow-y: auto; margin-bottom: 15px;">
                    <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
                </div>
                <div style="position: relative; height: 400px; width: 100%; overflow-x: auto;">
                    <canvas id="areaStatusChart" style="width: 100%; height: 100%; min-width: 600px;"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Container ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
    <div class="summary-table-container" style="margin: 20px 0; background-color: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border: 1px solid #e9ecef;">
        <h3 style="color: #003366; margin-bottom: 15px; text-align: center; font-size: 16px;">üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h3>
        <div id="summary-table-container" style="max-height: 500px; overflow-y: auto;">
            <table id="summary-table" style="width: 100%; border-collapse: collapse; font-size: 11px;">
                <thead>
                    <tr style="background-color: #f8f9fa; position: sticky; top: 0;">
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏™‡πà‡∏á Gen ID</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User</th>
                        <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á</th>
                            <th style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á</th>
                        </tr>
                    </thead>
                    <tbody id="summary-table-body">
                        <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà September 2025 -->
    <h2 id="pivot-table-title">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</h2>
    <table id="pivot-table" class="pivot-table">
        <thead>
            <tr id="pivot-header"></tr>
        </thead>
        <tbody id="pivot-body"></tbody>
    </table>

    <div class="table-header-container">
        <h2>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà</h2>
        <div style="display: flex; gap: 10px; align-items: center;">
            <button onclick="resetAllFilters()" style="background-color: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: background-color 0.2s;" 
                    onmouseover="this.style.backgroundColor='#545b62'" 
                    onmouseout="this.style.backgroundColor='#6c757d'">
                üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï Filter
            </button>
            <button onclick="loadSampleData()" style="background-color: #17a2b8; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: background-color 0.2s; margin-left: 10px;" 
                    onmouseover="this.style.backgroundColor='#138496'" 
                    onmouseout="this.style.backgroundColor='#17a2b8'">
                üîÑ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
            </button>
            <button onclick="testFilter()" style="background-color: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: background-color 0.2s; margin-left: 10px;" 
                    onmouseover="this.style.backgroundColor='#218838'" 
                    onmouseout="this.style.backgroundColor='#28a745'">
                üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Filter
            </button>
            <span id="filter-status" style="font-size: 12px; color: #666;"></span>
        </div>
    </div>
    <div style="display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 10px;">
        <div class="card month-card" data-month="all" style="background-color: #003366; color: white; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">All</div>
        <div class="card month-card" data-month="Jan" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Jan</div>
        <div class="card month-card" data-month="Feb" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Feb</div>
        <div class="card month-card" data-month="Mar" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Mar</div>
        <div class="card month-card" data-month="Apr" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Apr</div>
        <div class="card month-card" data-month="May" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">May</div>
        <div class="card month-card" data-month="Jun" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Jun</div>
        <div class="card month-card" data-month="Jul" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Jul</div>
        <div class="card month-card" data-month="Aug" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Aug</div>
        <div class="card month-card" data-month="Sep" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Sep</div>
        <div class="card month-card" data-month="Oct" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Oct</div>
        <div class="card month-card" data-month="Nov" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Nov</div>
        <div class="card month-card" data-month="Dec" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Dec</div>
    </div>
    <div class="table-buttons" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: -40px; margin-bottom: 10px;">
        <form class="search-container" onsubmit="event.preventDefault(); searchTableData();">
            <input type="text" id="search-input" class="search-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...">
            <button type="button" id="search-button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
            </button>
        </form>
        <button id="reset-filter-button" title="‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 3h18v18H3z"></path>
                <path d="M21 3l-9 9M3 21l9-9"></path>
            </svg>
            ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á
        </button>
        <button id="refresh-button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"/>
            </svg>
            ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        </button>
        <button id="show-main-table-button" title="‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 3h18v18H3z"></path>
                <path d="M3 9h18M9 3v18"></path>
            </svg>
            ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å
        </button>
        <button id="download-button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
            ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
        </button>
    </div>
    
    <!-- Pagination Top -->
    <div class="pagination-container" id="pagination-container-top" style="display: flex;">
        <div class="pagination-controls">
            <button id="prev-button-top" class="pagination-button" disabled>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
            <div class="pagination-pages" id="pagination-pages-top">
                <!-- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢ JavaScript -->
            </div>
            <div class="pagination-info" id="pagination-info-top">‡∏´‡∏ô‡πâ‡∏≤ 1 ‡∏à‡∏≤‡∏Å 10</div>
            <button id="next-button-top" class="pagination-button">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
        </div>
        <div class="page-size-selector">
            <label for="page-size-top">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤:</label>
            <select id="page-size-top">
                <option value="50">50</option>
                <option value="100">100</option>
                <option value="200">200</option>
            </select>
        </div>
    </div>
    
    <table id="data-table">
        <thead>
            <tr>
                <th>
                    <div class="th-content">
                        <span>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 0)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="0">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 1)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="1">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 2)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="2">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>week</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 3)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="3">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 4)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="4">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡∏ä‡∏∑‡πà‡∏≠ ‡∏ö‡∏à‡∏Å./‡∏´‡∏à‡∏Å/‡∏£‡πâ‡∏≤‡∏ô (‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô)</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 5)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="5">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 6)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="6">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 7)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="7">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô (‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á)</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 8)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="8">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 9)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="9">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 10)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="10">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 11)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="11">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 12)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="12">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>SLA</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 13)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="13">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="th-content">
                        <span>‡∏õ‡∏µ</span>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilter(this, 14)" title="Filter">‚ñº</button>
                            <div class="filter-menu" data-column="14">
                                <div class="filter-search">
                                    <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="filterSearch(this)">
                                </div>
                                <div class="filter-options">
                                    <label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </th>
            </tr>
        </thead>
        <tbody id="data-body"></tbody>
    </table>



    <!-- Problem Details Table -->
    <div style="background-color: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin: 20px 0; border-left: 4px solid #dc3545;">
        <div class="table-header-container">
            <h3 style="color: #003366; margin: 0;">üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h3>
            <div class="table-buttons" style="display: flex; gap: 10px; justify-content: flex-end;">
                <form class="search-container" onsubmit="event.preventDefault(); searchProblemsTable();">
                    <input type="text" id="problems-search-input" class="search-input" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤...">
                    <button type="button" id="problems-search-button">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                        ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                    </button>
                </form>
                <button id="problems-reset-filter-button" title="‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 3h18v18H3z"></path>
                        <path d="M21 3l-9 9M3 21l9-9"></path>
                    </svg>
                    ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á
                </button>
                <button id="problems-refresh-button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"/>
                    </svg>
                    ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
                <button id="problems-download-button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
                </button>
            </div>
        </div>
        <div style="overflow-x: auto; margin-top: 20px;">
            <table id="daily-problems-table" style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background-color: #003366; color: white;">
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: left;">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô</th>
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</th>
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤</th>
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î</th>
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">SLA (‡∏ß‡∏±‡∏ô)</th>
                    </tr>
                </thead>
                <tbody id="daily-problems-body">
                    <tr>
                        <td colspan="6" style="padding: 20px; text-align: center; color: #666;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <!-- End Training Status Section -->
    </div>
    </div> <!-- End main-page -->

    <!-- Daily Report Page Section -->
    <div id="daily-report-page" style="display: none; max-width: 1400px; margin: 0 auto; padding: 20px;">
        
        <!-- Performance Indicators -->
        <div style="display: flex; gap: 20px; margin-bottom: 30px; flex-wrap: wrap;">
            <div style="background: white; padding: 15px 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #28a745; flex: 1; min-width: 200px; display: flex; align-items: center; gap: 15px;">
                <div style="font-size: 36px; color: #28a745;">üìà</div>
                <div>
                    <div style="color: #666; font-size: 14px;">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
                    <div style="font-size: 24px; font-weight: bold; color: #28a745;" id="daily-success-rate">-%</div>
                </div>
            </div>
            <div style="background: white; padding: 15px 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #17a2b8; flex: 1; min-width: 200px; display: flex; align-items: center; gap: 15px;">
                <div style="font-size: 36px; color: #17a2b8;">‚è±Ô∏è</div>
                <div>
                    <div style="color: #666; font-size: 14px;">SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                    <div style="font-size: 24px; font-weight: bold; color: #17a2b8;" id="daily-avg-sla">- ‡∏ß‡∏±‡∏ô</div>
                </div>
            </div>
            <div style="background: white; padding: 15px 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 4px solid #ffc107; flex: 1; min-width: 200px; display: flex; align-items: center; gap: 15px;">
                <div style="font-size: 36px; color: #ffc107;">‚ö°</div>
                <div>
                    <div style="color: #666; font-size: 14px;">‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</div>
                    <div style="font-size: 24px; font-weight: bold; color: #ffc107;" id="daily-efficiency">-</div>
                </div>
            </div>
        </div>

        <!-- Status Breakdown Section -->
        <div style="background: white; border-radius: 12px; padding: 25px; margin-bottom: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            <h3 style="color: #003366; margin-bottom: 20px; font-size: 20px;">üìä ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ - ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
            
            <!-- Status Cards Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;" id="daily-status-cards">
                <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
            </div>

            <!-- Charts Section -->
            <div style="display: grid; grid-template-columns: 60% 40%; gap: 25px; margin-top: 25px;">
                <!-- Comparison Chart (‡πÅ‡∏£‡∏Å) -->
                <div style="background: #f8f9fa; padding: 8px; border-radius: 8px;">
                    <h4 style="text-align: center; color: #003366; margin-bottom: 8px;">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h4>
                    <div style="position: relative; height: 450px; display: flex; align-items: center; justify-content: center;">
                        <canvas id="daily-trend-chart" width="700" height="450"></canvas>
                    </div>
                </div>

                <!-- Pie Chart (‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á) -->
                <div style="background: #f8f9fa; padding: 10px; border-radius: 8px;">
                    <h4 style="text-align: center; color: #003366; margin-bottom: 8px;">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h4>
                    <div style="position: relative; height: 420px; display: flex; align-items: center; justify-content: center;">
                        <canvas id="daily-pie-chart" width="450" height="420"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Table Section -->
        <div style="background: white; border-radius: 12px; padding: 25px; margin-bottom: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            <!-- Header with Search -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="color: #003366; margin: 0; font-size: 20px;" id="daily-table-title">üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                <input type="text" id="daily-search-input" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." style="
                    padding: 8px 12px;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    font-size: 14px;
                    width: 300px;
                    max-width: 400px;
                ">
            </div>

            <!-- Table Container -->
            <div style="overflow-x: auto; border: 1px solid #e9ecef; border-radius: 6px;">
                <table id="daily-detail-table" style="width: 100%; border-collapse: collapse; background: white; font-size: 12px;">
                    <thead>
                        <tr style="background: #003366; color: white;">
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">#</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: left; font-weight: 600; font-size: 11px;">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">week</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: left; font-weight: 600; font-size: 11px;">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: left; font-weight: 600; font-size: 11px;">‡∏ä‡∏∑‡πà‡∏≠ ‡∏ö‡∏à‡∏Å./‡∏´‡∏à‡∏Å/‡∏£‡πâ‡∏≤‡∏ô</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">SLA</th>
                            <th style="padding: 8px; border-bottom: 2px solid #dee2e6; text-align: center; font-weight: 600; font-size: 11px;">‡∏õ‡∏µ</th>
                        </tr>
                    </thead>
                    <tbody id="daily-detail-tbody">
                        <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Table Summary -->
            <div style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 6px; font-size: 14px; color: #6c757d;">
                ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• <span id="daily-table-count">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span id="daily-table-total">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
            </div>
        </div>



        <!-- Navigation Buttons -->
        <div style="text-align: center; margin-top: 30px;">
            <button onclick="showHomePage()" style="
                background: linear-gradient(135deg, #6c757d, #495057);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 8px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                display: inline-flex;
                align-items: center;
                gap: 10px;
                margin-right: 15px;
                transition: all 0.3s ease;
            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(108,117,125,0.3)'" 
               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                üè† ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </button>
            <button onclick="printDailyReport()" style="
                background: linear-gradient(135deg, #17a2b8, #138496);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 8px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                display: inline-flex;
                align-items: center;
                gap: 10px;
                transition: all 0.3s ease;
            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(23,162,184,0.3)'" 
               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
            </button>
        </div>
    </div>

    <script>
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢
        function updateCurrentDateTime() {
            const currentDateElement = document.getElementById('current-date');
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long', hour: 'numeric', minute: 'numeric', second: 'numeric' };
            const thaiYear = now.getFullYear() + 543;
            const thaiDate = now.toLocaleDateString('th-TH', options).replace(now.getFullYear(), thaiYear);
            currentDateElement.textContent = `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${thaiDate}`;
        }

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        updateCurrentDateTime();
        setInterval(updateCurrentDateTime, 1000);

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ô navbar
        function updateNavbarStatus(message, isSuccess = true) {
            const statusElement = document.getElementById('navbar-status');
            if (statusElement) {
                statusElement.textContent = message;
                statusElement.style.color = isSuccess ? '#00ff88' : '#ff6b6b';
            }
        }
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ navbar ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
        function updateNavbarOnDataLoad() {
            updateNavbarStatus('‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î', true);
        }
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ navbar ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
        function updateNavbarOnError() {
            updateNavbarStatus('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', false);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
        function updateDailyTableTitle() {
            const titleElement = document.getElementById('daily-table-title');
            if (titleElement) {
                const now = new Date();
                const day = now.getDate().toString().padStart(2, '0');
                const monthNames = [
                    '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                    '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
                ];
                const month = monthNames[now.getMonth()];
                const year = now.getFullYear();
                
                const formattedDate = `${day}-${month}-${year}`;
                titleElement.textContent = `üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (${formattedDate})`;
            }
        }



        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        function showHomePage() {
            document.getElementById('main-page').style.display = 'block';
            document.getElementById('daily-report-page').style.display = 'none';
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï active state ‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏ô‡∏π
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            document.querySelector('.nav-item[onclick*="showHomePage"]').classList.add('active');
            
            // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
        function showDailyReport() {
            document.getElementById('main-page').style.display = 'none';
            document.getElementById('daily-report-page').style.display = 'block';
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï active state ‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏ô‡∏π
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            document.querySelector('.nav-item[onclick*="showDailyReport"]').classList.add('active');
            
            // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
            loadDailyReportData();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
        function loadDailyReportData() {
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ navbar
            updateNavbarStatus('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô...', true);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• filteredData2025 ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (!filteredData2025 || filteredData2025.length === 0) {
                console.log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• filteredData2025, ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà...');
                fetchDataAndUpdateTable().then(() => {
                    processDailyReportData();
                }).catch(error => {
                    console.error('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
                    updateNavbarStatus('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ', false);
                });
            } else {
                processDailyReportData();
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
        function processDailyReportData() {
            console.log('üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô...');
            console.log('üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• filteredData2025:', filteredData2025 ? filteredData2025.length : '‡πÑ‡∏°‡πà‡∏°‡∏µ', '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            updateDailyTableTitle();
            
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            const todayData = getTodayData();
            console.log('üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:', todayData.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
            
            if (todayData.length > 0) {
                console.log('üîç ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 3 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å:');
                todayData.slice(0, 3).forEach((row, index) => {
                    console.log(`  ${index + 1}. ‡∏ä‡∏∑‡πà‡∏≠: ${row[0]}, ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${row[34]}, ‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î: ${row[36]}`);
                });
            }
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å - ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏≠‡∏≠‡∏Å‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏•‡πâ‡∏ß
            // updateDailySummaryCards(todayData);
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
            updateDailyPerformanceIndicators(todayData);
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
            updateDailyStatusCards(todayData);
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü
            updateDailyCharts(todayData);
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            updateDailyTable(todayData);
            

            

            
            console.log('‚úÖ ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå');
            updateNavbarStatus('‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß', true);
        }



        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function getTodayData() {
            if (!filteredData2025 || filteredData2025.length === 0) {
                return [];
            }
            
            // ‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå AK (36) "‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î"
            const latestDate = getLatestEndDate();
            
            if (!latestDate) {
                console.log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                return [];
            }
            
            console.log('üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏û‡∏ö:', latestDate);
            
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const latestData = filteredData2025.filter(row => {
                // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö row.c[36].v ‡πÅ‡∏•‡∏∞ row[36]
                let endDate;
                if (row.c && row.c[36]) {
                    endDate = row.c[36].v; // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Google Sheets
                } else {
                    endDate = row[36]; // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö array
                }
                return endDate && endDate.toString().trim() === latestDate;
            });
            
            // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö array ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const convertedData = latestData.map(row => {
                if (row.c) {
                    // ‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≤‡∏Å { c: [...] } ‡πÄ‡∏õ‡πá‡∏ô array
                    return row.c.map(cell => cell ? cell.v : '');
                } else {
                    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô array ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
                    return row;
                }
            });
            
            console.log('üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:', convertedData.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
            return convertedData;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function getLatestEndDate() {
            if (!filteredData2025 || filteredData2025.length === 0) {
                return null;
            }
            
            // ‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö row.c[36].v ‡πÅ‡∏•‡∏∞ row[36]
            const dates = filteredData2025
                .map(row => {
                    // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö row.c[36].v ‡πÅ‡∏•‡∏∞ row[36]
                    if (row.c && row.c[36]) {
                        return row.c[36].v; // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Google Sheets
                    } else {
                        return row[36]; // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö array
                    }
                })
                .filter(date => date && date.toString().trim() !== '' && date.toString().trim() !== '-')
                .map(date => date.toString().trim());
            
            console.log('üîç ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏û‡∏ö:', dates.slice(0, 10)); // ‡πÅ‡∏™‡∏î‡∏á 10 ‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å
            
            if (dates.length === 0) {
                return null;
            }
            
            // ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô Date object ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö
            const dateObjects = dates.map(dateStr => {
                try {
                    // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: d/m/yyyy ‡∏´‡∏£‡∏∑‡∏≠ dd/mm/yyyy
                    const parts = dateStr.split('/');
                    if (parts.length === 3) {
                        const day = parseInt(parts[0]);
                        const month = parseInt(parts[1]) - 1; // JavaScript ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 0
                        const year = parseInt(parts[2]);
                        
                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                        if (isNaN(day) || isNaN(month) || isNaN(year) || 
                            day < 1 || day > 31 || month < 0 || month > 11 || year < 2020) {
                            console.warn('‚ö†Ô∏è ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:', dateStr);
                            return null;
                        }
                        
                        return {
                            original: dateStr,
                            date: new Date(year, month, day)
                        };
                    }
                } catch (e) {
                    console.warn('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:', dateStr, e);
                }
                return null;
            }).filter(item => item !== null && !isNaN(item.date.getTime()));
            
            console.log('üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏î‡πâ:', dateObjects.length, '‡∏à‡∏≤‡∏Å', dates.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
            
            if (dateObjects.length === 0) {
                console.warn('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏î‡πâ');
                return null;
            }
            
            // ‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            const latestDateObj = dateObjects.reduce((latest, current) => {
                return current.date > latest.date ? current : latest;
            });
            
            console.log('üéØ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:', latestDateObj.original, '(', latestDateObj.date, ')');
            
            return latestDateObj.original;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å - ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏≠‡∏≠‡∏Å‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏•‡πâ‡∏ß
        /*
        function updateDailySummaryCards(todayData) {
            const statusCounts = getStatusCounts(todayData);
            
            // ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
            const successCount = statusCounts['‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'] || 0;
            updateElement('daily-success-count', successCount);
            
            // ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°
            const pendingStatuses = ['‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô', '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°', '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', 
                                    '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥', '‡∏™‡πà‡∏á Gen ID', 'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£', '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô', 
                                    '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User', '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á', '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á'];
            const pendingCount = pendingStatuses.reduce((sum, status) => sum + (statusCounts[status] || 0), 0);
            updateElement('daily-pending-count', pendingCount);
            
            // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°
            const closedStatuses = ['‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å', '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°', '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°', '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°'];
            const closedCount = closedStatuses.reduce((sum, status) => sum + (statusCounts[status] || 0), 0);
            updateElement('daily-closed-count', closedCount);
            
            // ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            const totalCount = todayData.length;
            updateElement('daily-total-count', totalCount);
            

        }
        */

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
        function updateDailyPerformanceIndicators(todayData) {
            if (todayData.length === 0) {
                updateElement('daily-success-rate', '0%');
                updateElement('daily-avg-sla', '0 ‡∏ß‡∏±‡∏ô');
                updateElement('daily-efficiency', '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                return;
            }
            
            const statusCounts = getStatusCounts(todayData);
            const successCount = statusCounts['‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'] || 0;
            const successRate = ((successCount / todayData.length) * 100).toFixed(1);
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
            const slaValues = todayData.map(row => parseFloat(row[37])).filter(val => !isNaN(val));
            const avgSla = slaValues.length > 0 ? Math.floor(slaValues.reduce((sum, val) => sum + val, 0) / slaValues.length) : 0;
            
            // ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
            let efficiency = '‡∏ï‡πà‡∏≥';
            if (successRate >= 70) efficiency = '‡∏™‡∏π‡∏á';
            else if (successRate >= 50) efficiency = '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á';
            
            updateElement('daily-success-rate', `${successRate}%`);
            updateElement('daily-avg-sla', `${avgSla} ‡∏ß‡∏±‡∏ô`);
            updateElement('daily-efficiency', efficiency);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        function updateDailyStatusCards(todayData) {
            const statusCounts = getStatusCounts(todayData);
            const container = document.getElementById('daily-status-cards');
            
            if (!container) return;
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
            const statusColors = {
                '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢': '#006400',
                '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å': '#FF6B00',
                '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô': '#FF1493',
                '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°': '#4169E1',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°': '#90EE90',
                '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö': '#008080',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥': '#4CA64C',
                '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°': '#DC143C',
                '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°': '#FF69B4',
                '‡∏™‡πà‡∏á Gen ID': '#9932CC',
                'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£': '#FF8C00',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô': '#32CD32',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User': '#FF4500',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á': '#00CED1',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á': '#1E90FF'
            };
            
            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏â‡∏û‡∏≤‡∏∞
            function calculateStatusAvgSLA(data, targetStatus) {
                const statusData = data.filter(row => row[34] === targetStatus);
                if (statusData.length === 0) return 0;
                
                const slaValues = statusData
                    .map(row => parseFloat(row[37]))
                    .filter(val => !isNaN(val) && val > 0);
                
                if (slaValues.length === 0) return 0;
                
                const avgSLA = slaValues.reduce((sum, val) => sum + val, 0) / slaValues.length;
                return Math.round(avgSLA);
            }
            
            container.innerHTML = '';
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î (‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á SLA)
            const totalCard = document.createElement('div');
            totalCard.style.cssText = `
                background: linear-gradient(135deg, #003366, #004080);
                color: white;
                padding: 15px;
                border-radius: 8px;
                text-align: center;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                cursor: pointer;
                transition: transform 0.2s;
                position: relative;
                overflow: hidden;
                height: 90px;
                display: flex;
                flex-direction: column;
                justify-content: center;
            `;
            totalCard.innerHTML = `
                <div style="font-size: 32px; margin-bottom: 5px;">üìä</div>
                <div style="font-size: 28px; font-weight: bold; margin-bottom: 8px;">${todayData.length}</div>
                <div style="font-size: 14px; opacity: 0.9;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                <div style="position: absolute; top: -20px; right: -20px; font-size: 80px; opacity: 0.1;">Œ£</div>
            `;
            totalCard.onmouseover = () => totalCard.style.transform = 'translateY(-3px)';
            totalCard.onmouseout = () => totalCard.style.transform = 'translateY(0)';
            container.appendChild(totalCard);
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ - ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢
            const sortedStatuses = Object.entries(statusCounts)
                .filter(([status, count]) => count > 0)
                .sort(([, a], [, b]) => b - a); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢
            
            sortedStatuses.forEach(([status, count]) => {
                const color = statusColors[status] || '#6c757d';
                const avgSLA = calculateStatusAvgSLA(todayData, status);
                const slaText = avgSLA > 0 ? ` (${avgSLA} ‡∏ß‡∏±‡∏ô)` : '';
                
                const card = document.createElement('div');
                card.style.cssText = `
                    background: ${color};
                    color: white;
                    padding: 15px;
                    border-radius: 8px;
                    text-align: center;
                    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                    cursor: pointer;
                    transition: transform 0.2s;
                    height: 90px;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                `;
                card.innerHTML = `
                    <div style="font-size: 24px; font-weight: bold; margin-bottom: 8px;">${count}${slaText}</div>
                    <div style="font-size: 12px; opacity: 0.9; line-height: 1.3;">${status}</div>
                `;
                card.onmouseover = () => card.style.transform = 'translateY(-3px)';
                card.onmouseout = () => card.style.transform = 'translateY(0)';
                container.appendChild(card);
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü
        function updateDailyCharts(todayData) {
            // Pie Chart
            updateDailyPieChart(todayData);
            
            // Trend Chart
            updateDailyTrendChart();
        }

        // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á
        let dailyTableOriginalData = [];
        let dailyTableFilteredData = [];

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function updateDailyTable(todayData) {
            const tbody = document.getElementById('daily-detail-tbody');
            if (!tbody) return;
            
            // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö
            dailyTableOriginalData = todayData;
            dailyTableFilteredData = todayData;
            
            renderDailyTableRows(todayData);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ñ‡∏ß‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function renderDailyTableRows(data) {
            const tbody = document.getElementById('daily-detail-tbody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (data.length === 0) {
                const latestDate = getLatestEndDate();
                const message = latestDate ? 
                    `‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (${latestDate})` : 
                    '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î';
                tbody.innerHTML = `<tr><td colspan="16" style="text-align: center; padding: 20px; color: #666;">${message}</td></tr>`;
                updateElement('daily-table-count', '0');
                updateElement('daily-table-total', dailyTableOriginalData.length);
                return;
            }
            
            data.forEach((row, index) => {
                const tr = document.createElement('tr');
                tr.style.cssText = 'border-bottom: 1px solid #dee2e6; font-size: 11px;';
                
                // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                const area = row[26] || '-';           // ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
                const roundDate = row[27] || '-';      // ‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
                const trainingMonth = row[28] || '-';  // ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°
                const week = row[39] || '-';           // week
                const name = row[3] || '-';            // ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå D)
                const company = row[6] || '-';         // ‡∏ä‡∏∑‡πà‡∏≠ ‡∏ö‡∏à‡∏Å./‡∏´‡∏à‡∏Å/‡∏£‡πâ‡∏≤‡∏ô
                const agentCode = row[7] || '-';       // ‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô
                const province = row[8] || '-';        // ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
                const workStatus = row[13] || '-';     // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô
                const registerResult = row[33] || '-'; // ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                const latestStatus = row[34] || '-';   // Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                const startDate = row[35] || '-';      // ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                const endDate = row[36] || '-';        // ‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î
                const sla = row[37] || '-';            // SLA
                const year = row[41] || '-';           // ‡∏õ‡∏µ
                
                tr.innerHTML = `
                    <td style="padding: 6px; text-align: center;">${index + 1}</td>
                    <td style="padding: 6px;">${area}</td>
                    <td style="padding: 6px; text-align: center;">${roundDate}</td>
                    <td style="padding: 6px; text-align: center;">${trainingMonth}</td>
                    <td style="padding: 6px; text-align: center;">${week}</td>
                    <td style="padding: 6px;">${name}</td>
                    <td style="padding: 6px;">${company}</td>
                    <td style="padding: 6px; text-align: center;">${agentCode}</td>
                    <td style="padding: 6px; text-align: center;">${province}</td>
                    <td style="padding: 6px; text-align: center;">${workStatus}</td>
                    <td style="padding: 6px; text-align: center;">${registerResult}</td>
                    <td style="padding: 6px; text-align: center;">
                        <span style="background: #f8f9fa; padding: 2px 6px; border-radius: 3px; font-size: 10px;">${latestStatus}</span>
                    </td>
                    <td style="padding: 6px; text-align: center;">${startDate}</td>
                    <td style="padding: 6px; text-align: center;">${endDate}</td>
                    <td style="padding: 6px; text-align: center;">${sla}</td>
                    <td style="padding: 6px; text-align: center;">${year}</td>
                `;
                tbody.appendChild(tr);
            });
            
            updateElement('daily-table-count', data.length);
            updateElement('daily-table-total', dailyTableOriginalData.length);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
        function searchDailyTable() {
            const searchTerm = document.getElementById('daily-search-input').value.toLowerCase().trim();
            
            let filteredData = dailyTableOriginalData;
            
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
            if (searchTerm) {
                filteredData = filteredData.filter(row => {
                    // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
                    return row.some(cell => {
                        if (cell === null || cell === undefined) return false;
                        return cell.toString().toLowerCase().includes(searchTerm);
                    });
                });
            }
            
            dailyTableFilteredData = filteredData;
            renderDailyTableRows(filteredData);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
        function resetDailyTableFilter() {
            document.getElementById('daily-search-input').value = '';
            dailyTableFilteredData = dailyTableOriginalData;
            renderDailyTableRows(dailyTableOriginalData);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå






        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå
        function printDailyReport() {
            window.print();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠
        function updateElement(id, value) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = value;
            }
        }

        function getStatusCounts(data) {
            const counts = {};
            data.forEach(row => {
                const status = row[34];
                counts[status] = (counts[status] || 0) + 1;
            });
            return counts;
        }

        function getAssessmentColor(assessment) {
            switch(assessment) {
                case '‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏ï‡∏≤‡∏° SLA': return '#28a745';
                case '‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°': return '#ffc107';
                case '‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°': return '#6c757d';
                default: return '#6c757d';
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü Pie Chart
        function updateDailyPieChart(todayData) {
            const canvas = document.getElementById('daily-pie-chart');
            if (!canvas) return;
            
            // ‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏Å‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
            if (window.dailyPieChart) {
                window.dailyPieChart.destroy();
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (!todayData || todayData.length === 0) {
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillStyle = '#666';
                ctx.fillText('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', canvas.width/2, canvas.height/2);
                return;
            }
            
            // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 34)
            const statusCounts = {};
            todayData.forEach(row => {
                const status = row[34] || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'; // Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå AI)
                statusCounts[status] = (statusCounts[status] || 0) + 1;
            });
            
            console.log('üìä Status counts ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö pie chart:', statusCounts);
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢
            const sortedStatuses = Object.entries(statusCounts)
                .sort(([, a], [, b]) => b - a);
            
            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü
            const labels = sortedStatuses.map(([status]) => status);
            const data = sortedStatuses.map(([, count]) => count);
            const total = todayData.length;
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ status (‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏∏)
            const statusColors = {
                '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢': '#006400',
                '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô': '#FF1493',
                '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å': '#FF6B00',
                '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°': '#4169E1',
                '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°': '#DC143C',
                '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°': '#FF69B4',
                '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö': '#008080',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥': '#4CA64C',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°': '#90EE90',
                '‡∏™‡πà‡∏á Gen ID': '#9932CC',
                'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£': '#FF8C00',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô': '#32CD32',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User': '#FF4500',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á': '#00CED1',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á': '#1E90FF',
                '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏': '#6c757d'
            };
            
            const backgroundColors = labels.map(label => statusColors[label] || '#6c757d');
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á labels ‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞ %
            const formattedLabels = labels.map(label => {
                const count = statusCounts[label];
                const percentage = ((count / total) * 100).toFixed(1);
                return `${count} (${percentage}%)`;
            });
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á pie chart
            const ctx = canvas.getContext('2d');
            window.dailyPieChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: formattedLabels,
                    datasets: [{
                        data: data,
                        backgroundColor: backgroundColors,
                        borderColor: '#fff',
                        borderWidth: 2,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: false
                        },
                        legend: {
                            position: 'right',
                            labels: {
                                font: {
                                    size: 11
                                },
                                color: '#000000',
                                padding: 8,
                                usePointStyle: true,
                                pointStyle: 'circle',
                                generateLabels: function(chart) {
                                    const data = chart.data;
                                    return data.labels.map((label, index) => {
                                        const count = data.datasets[0].data[index];
                                        const percentage = ((count / total) * 100).toFixed(1);
                                        const statusName = labels[index];
                                        return {
                                            text: `${statusName}: ${count} (${percentage}%)`,
                                            fillStyle: data.datasets[0].backgroundColor[index],
                                            strokeStyle: data.datasets[0].borderColor,
                                            lineWidth: data.datasets[0].borderWidth,
                                            fontColor: '#000000',
                                            color: '#000000',
                                            hidden: false,
                                            index: index
                                        };
                                    });
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = labels[context.dataIndex];
                                    const count = data[context.dataIndex];
                                    const percentage = ((count / total) * 100).toFixed(1);
                                    return `${label}: ${count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (${percentage}%)`;
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart',
                        onComplete: function(animation) {
                            // ‡∏ß‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÉ‡∏ô pie chart
                            const ctx = animation.chart.ctx;
                            const chart = animation.chart;
                            
                            chart.data.datasets[0].data.forEach((value, index) => {
                                const percentage = ((value / total) * 100).toFixed(1);
                                
                                // ‡∏Ç‡πâ‡∏≤‡∏°‡∏ä‡∏¥‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πá‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ
                                if (percentage < 5) return;
                                
                                const meta = chart.getDatasetMeta(0);
                                const element = meta.data[index];
                                
                                // ‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏ä‡∏¥‡πâ‡∏ô
                                const centroid = element.getCenterPoint();
                                
                                // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                                ctx.fillStyle = 'white';
                                ctx.font = 'bold 12px Arial';
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'middle';
                                
                                // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå
                                const label = `${value}\n(${percentage}%)`;
                                const lines = label.split('\n');
                                
                                lines.forEach((line, lineIndex) => {
                                    const y = centroid.y + (lineIndex - 0.5) * 16;
                                    ctx.fillText(line, centroid.x, y);
                                });
                            });
                        }
                    }
                }
            });
            
            console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á Daily Pie Chart ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü Trend Chart
        function updateDailyTrendChart() {
            const canvas = document.getElementById('daily-trend-chart');
            if (!canvas) return;
            
            // ‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏Å‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
            if (window.dailyTrendChart) {
                window.dailyTrendChart.destroy();
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (!filteredData2025 || filteredData2025.length === 0) {
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillStyle = '#666';
                ctx.fillText('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', canvas.width/2, canvas.height/2);
                return;
            }
            
            // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            const last7DaysData = getLast7DaysData();
            
            if (last7DaysData.length === 0) {
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillStyle = '#666';
                ctx.fillText('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î', canvas.width/2, canvas.height/2);
                return;
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü
            const ctx = canvas.getContext('2d');
            window.dailyTrendChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: last7DaysData.map(item => item.date),
                    datasets: [{
                        label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£',
                        data: last7DaysData.map(item => item.total),
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB', 
                            '#FFCE56',
                            '#4BC0C0',
                            '#9966FF',
                            '#FF9F40',
                            '#FF6384'
                        ],
                        borderColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56', 
                            '#4BC0C0',
                            '#9966FF',
                            '#FF9F40',
                            '#FF6384'
                        ],
                        borderWidth: 2,
                        borderRadius: 8,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    layout: {
                        padding: {
                            top: 20,
                            bottom: 20,
                            left: 10,
                            right: 150  // ‡πÄ‡∏û‡∏¥‡πà‡∏° padding ‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                        }
                    },
                    plugins: {
                        title: {
                            display: false
                        },
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            borderColor: '#666',
                            borderWidth: 1,
                            padding: 12,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 12
                            },
                            callbacks: {
                                title: function(context) {
                                    return `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${context[0].label}`;
                                },
                                label: function(context) {
                                    const dayData = last7DaysData[context.dataIndex];
                                    const statusCounts = dayData.statusCounts || {};
                                    
                                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢
                                    const statusLines = Object.entries(statusCounts)
                                        .filter(([status, count]) => count > 0)
                                        .sort(([,a], [,b]) => b - a)
                                        .map(([status, count]) => `${status}: ${count} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
                                    
                                    // return array ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î
                                    return [`‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${dayData.total} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, ''].concat(statusLines);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1,
                                color: '#666'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#666',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 1500,
                        easing: 'easeInOutQuart',
                        onComplete: function(animation) {
                                                            // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ö‡∏ô‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü
                            const ctx = animation.chart.ctx;
                            const chart = animation.chart;
                            
                            chart.data.datasets[0].data.forEach((value, index) => {
                                const meta = chart.getDatasetMeta(0);
                                const element = meta.data[index];
                                const position = element.tooltipPosition();
                                
                                // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô
                                const dayData = last7DaysData[index];
                                const statusCounts = dayData.statusCounts || {};
                                
                                // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0 ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢
                                const sortedStatuses = Object.entries(statusCounts)
                                    .filter(([status, count]) => count > 0)
                                    .sort(([,a], [,b]) => b - a);
                                
                                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡∏ñ‡πâ‡∏≤‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 50 ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏ü, ‡∏ñ‡πâ‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 50 ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü
                                if (value < 50) {
                                    // --- ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü ---
                                    
                                    // 1. ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°‡∏Å‡πà‡∏≠‡∏ô (‡πÉ‡∏Å‡∏•‡πâ‡∏Å‡∏±‡∏ö‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü)
                                    ctx.fillStyle = '#003366';
                                    ctx.font = 'bold 11px Arial';
                                    ctx.textAlign = 'center';
                                    ctx.textBaseline = 'bottom';
                                    ctx.fillText(dayData.total, position.x, position.y - 8);
                                    
                                    // 2. ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°
                                    ctx.font = '8px Arial';
                                    ctx.fillStyle = '#333';
                                    ctx.textAlign = 'center';
                                    ctx.textBaseline = 'bottom';
                                    
                                    const lineHeight = 10;
                                    const statusStartY = position.y - 25; // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà -25 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°
                                    
                                    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏•‡∏á‡∏°‡∏≤
                                    sortedStatuses.forEach(([status, count], statusIndex) => {
                                        // ‡∏ï‡∏±‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏´‡πâ‡∏™‡∏±‡πâ‡∏ô‡∏•‡∏á
                                        let shortStatus = status;
                                        if (status.length > 12) {
                                            shortStatus = status.substring(0, 9) + '...';
                                        }
                                        
                                        const yPosition = statusStartY - (statusIndex * lineHeight);
                                        ctx.fillText(`${shortStatus}: ${count}`, position.x, yPosition);
                                    });
                                    
                                } else {
                                    // --- ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü (‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢) ---
                                    
                                    // Debug: ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ
                                    console.log(`‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${dayData.date}: ‡∏£‡∏ß‡∏° ${dayData.total}, ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:`, statusCounts);
                                    console.log('sortedStatuses:', sortedStatuses);
                                    
                                    // 1. ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°‡∏Å‡πà‡∏≠‡∏ô (‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü)
                                    ctx.fillStyle = '#003366';
                                    ctx.font = 'bold 11px Arial';
                                    ctx.textAlign = 'center';
                                    ctx.textBaseline = 'bottom';
                                    ctx.fillText(dayData.total, position.x, position.y - 8);
                                    
                                    // 2. ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)
                                    if (sortedStatuses.length > 0) {
                                        ctx.fillStyle = '#333333';
                                        ctx.font = '9px Arial';
                                        
                                        const lineHeight = 12;
                                        
                                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                                        const isLastDay = index === last7DaysData.length - 1;
                                        
                                        console.log(`Debug: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${dayData.date}, index: ${index}, isLastDay: ${isLastDay}, total bars: ${last7DaysData.length}`);
                                        
                                        if (isLastDay) {
                                            // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ï‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°
                                            ctx.fillStyle = '#333333';
                                            ctx.font = '9px Arial';
                                            ctx.textAlign = 'left';
                                            ctx.textBaseline = 'top';
                                            
                                            const lineHeight = 12;
                                            const startY = position.y + 5; // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ï‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°
                                            
                                            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á X ‡πÉ‡∏´‡πâ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
                                            const barWidth = element.width || 40;
                                            const leftAlignX = position.x - (barWidth / 2) + 5; // ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü + padding 5px
                                            
                                            console.log(`Debug: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î - ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ï‡πâ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°`);
                                            console.log(`Debug: leftAlignX: ${leftAlignX}, startY: ${startY}`);
                                            
                                            sortedStatuses.forEach(([status, count], statusIndex) => {
                                                const yPosition = startY + (statusIndex * lineHeight);
                                                ctx.fillText(`${status}: ${count}`, leftAlignX, yPosition);
                                                console.log(`Debug: ‡πÅ‡∏™‡∏î‡∏á "${status}: ${count}" ‡∏ó‡∏µ‡πà (${leftAlignX}, ${yPosition})`);
                                            });
                                        } else {
                                            // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°
                                            ctx.font = '9px Arial';
                                            ctx.fillStyle = '#333333';
                                            ctx.textAlign = 'center';
                                            ctx.textBaseline = 'bottom';
                                            
                                            const lineHeight = 10;
                                            const startY = position.y - 25; // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°
                                            
                                            sortedStatuses.forEach(([status, count], statusIndex) => {
                                                const yPosition = startY - (statusIndex * lineHeight);
                                                ctx.fillText(`${status}: ${count}`, position.x, yPosition);
                                            });
                                        }
                                    } else {
                                        console.log('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ');
                                    }
                                }
                            });
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
            
            console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á Daily Trend Chart ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü Area Status Stack Column Chart
        function createAreaStatusChart() {
            console.log('üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á Area Status Chart...');
            
            const canvas = document.getElementById('areaStatusChart');
            if (!canvas) {
                console.log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö canvas element');
                return;
            }

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            if (!filteredData2025 || filteredData2025.length === 0) {
                console.log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillStyle = '#666';
                ctx.fillText('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á', canvas.width/2, canvas.height/2);
                return;
            }

            // ‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏Å‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
            if (window.areaStatusChart && typeof window.areaStatusChart.destroy === 'function') {
                try {
                    window.areaStatusChart.destroy();
                } catch (error) {
                    console.warn('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏Å‡πà‡∏≤:', error);
                }
            }

            // ‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const latestDate = getLatestEndDate();
            
            if (!latestDate) {
                console.log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillStyle = '#666';
                ctx.fillText('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î', canvas.width/2, canvas.height/2);
                return;
            }

            console.log('üìÖ ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:', latestDate);

            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            const todayData = filteredData2025.filter(row => {
                let endDate;
                if (row.c) {
                    endDate = row.c[36]?.v; // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Google Sheets
                } else {
                    endDate = row[36]; // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Array
                }
                return endDate && endDate.toString().trim() === latestDate;
            });

            console.log('üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:', todayData.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏£‡∏≤‡∏ü‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
            const titleElement = document.getElementById('area-chart-title');
            if (titleElement) {
                titleElement.textContent = `üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ä‡πà‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${latestDate} (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${todayData.length} ‡∏Ñ‡∏ô)`;
            }

            if (todayData.length === 0) {
                console.log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillStyle = '#666';
                ctx.fillText(`‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${latestDate}`, canvas.width/2, canvas.height/2);
                return;
            }

            // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ - ‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            const areaStatusData = {};
            const allAreas = new Set();
            const allStatuses = new Set();

            // ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Google Sheets ‡πÅ‡∏•‡∏∞ Array
            todayData.forEach(row => {
                let area, status;
                
                if (row.c) {
                    // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Google Sheets
                    area = row.c[26]?.v || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà';  // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå AA (index 26)
                    status = row.c[34]?.v || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'; // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                } else {
                    // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Array
                    area = row[26] || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà';  // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå AA (index 26)
                    status = row[34] || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'; // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                }

                allAreas.add(area);
                allStatuses.add(status);

                if (!areaStatusData[area]) {
                    areaStatusData[area] = {};
                }
                
                if (!areaStatusData[area][status]) {
                    areaStatusData[area][status] = 0;
                }
                
                areaStatusData[area][status]++;
            });

            console.log('üìä ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:', filteredData2025.length);
            console.log('üìä ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:', Array.from(allAreas));
            console.log('üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:', Array.from(allStatuses));
            console.log('üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:', areaStatusData);

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (allAreas.size === 0) {
                console.log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà');
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillStyle = '#666';
                ctx.fillText('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà', canvas.width/2, canvas.height/2);
                return;
            }

            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
            const sortedAreas = Array.from(allAreas).sort();
            
            // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ (‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏∏)
            const statusConfig = {
                '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢': '#006400',
                '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô': '#FF1493',
                '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å': '#FF6B00',
                '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°': '#4169E1',
                '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°': '#DC143C',
                '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°': '#FF69B4',
                '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö': '#008080',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥': '#4CA64C',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°': '#90EE90',
                '‡∏™‡πà‡∏á Gen ID': '#9932CC',
                'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£': '#FF8C00',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô': '#32CD32',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User': '#FF4500',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á': '#00CED1',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á': '#1E90FF'
            };

            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° datasets ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü
            const datasets = [];
            const statusesInData = Array.from(allStatuses).filter(status => status !== '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞');
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏∏)
            const statusOrder = [
                '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô',
                '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å',
                '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°',
                '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°',
                '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°',
                '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°',
                '‡∏™‡πà‡∏á Gen ID',
                'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á'
            ];

            const sortedStatuses = statusOrder.filter(status => statusesInData.includes(status));

            sortedStatuses.forEach(status => {
                const data = sortedAreas.map(area => {
                    return areaStatusData[area] && areaStatusData[area][status] 
                        ? areaStatusData[area][status] 
                        : 0;
                });

                datasets.push({
                    label: status,
                    data: data,
                    backgroundColor: statusConfig[status] || '#6c757d',
                    borderColor: statusConfig[status] || '#6c757d',
                    borderWidth: 1
                });
            });

            console.log('üìä Datasets data preview:', datasets.map(d => ({ label: d.label, data: d.data })));

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü
            const ctx = canvas.getContext('2d');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ ChartDataLabels plugin ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            const pluginsToUse = [];
            const hasDataLabels = false; // ‡∏õ‡∏¥‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö manual drawing
            
            // if (hasDataLabels) {
            //     pluginsToUse.push(ChartDataLabels);
            //     console.log('‚úÖ ChartDataLabels plugin ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
            // } else {
                console.log('‚ö†Ô∏è ‡πÉ‡∏ä‡πâ manual drawing ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô - ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç 0');
            // }
            
            window.areaStatusChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedAreas,
                    datasets: datasets
                },
                plugins: pluginsToUse,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    devicePixelRatio: 2, // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏°‡∏ä‡∏±‡∏î
                    layout: {
                        padding: {
                            top: 35, // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏£‡∏ß‡∏°
                            bottom: 60, // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
                            left: 15,
                            right: 15
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            categoryPercentage: 0.9, // ‡πÉ‡∏ä‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà 90% ‡∏Ç‡∏≠‡∏á‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
                            barPercentage: 0.95, // ‡πÉ‡∏ä‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà 95% ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü
                            ticks: {
                                color: '#333',
                                maxRotation: 0, // ‡πÑ‡∏°‡πà‡∏´‡∏°‡∏∏‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                                minRotation: 0,
                                font: {
                                    size: 9 // ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ
                                },
                                padding: 8,
                                autoSkip: false, // ‡πÑ‡∏°‡πà‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                                maxTicksLimit: false, // ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ticks
                                callback: function(value, index, values) {
                                    // ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß
                                    const label = this.getLabelForValue(value);
                                    return label;
                                }
                            },
                            grid: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà',
                                color: '#333',
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                },
                                padding: 10
                            }
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            ticks: {
                                color: '#333',
                                stepSize: 1,
                                font: {
                                    size: 10
                                },
                                padding: 5
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            title: {
                                display: true,
                                text: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏Ñ‡∏ô)',
                                color: '#333',
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                },
                                padding: 10
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: false
                        },
                        legend: {
                            display: false // ‡∏õ‡∏¥‡∏î legend ‡∏Ç‡∏≠‡∏á Chart.js ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ legend ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á
                        },
                        tooltip: {
                            titleFont: {
                                size: 12
                            },
                            bodyFont: {
                                size: 11
                            },
                            callbacks: {
                                title: function(context) {
                                    return `‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${context[0].label}`;
                                },
                                label: function(context) {
                                    const status = context.dataset.label;
                                    const count = context.parsed.y;
                                    return `${status}: ${count} ‡∏Ñ‡∏ô`;
                                }
                            }
                        },
                        ...(typeof ChartDataLabels !== 'undefined' ? {
                            datalabels: [{
                                // ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ stack (‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß)
                                display: function(context) {
                                    try {
                                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0
                                        if (!context || !context.parsed) return false;
                                        
                                        const rawValue = context.dataset.data[context.dataIndex];
                                        const parsedValue = context.parsed.y;
                                        const numValue = Number(rawValue);
                                        const numParsed = Number(parsedValue);
                                        const stringRaw = String(rawValue);
                                        const stringParsed = String(parsedValue);
                                        
                                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î - ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô 0 ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö
                                        return numValue > 0 && numParsed > 0 && 
                                               rawValue !== 0 && rawValue !== '0' && stringRaw !== '0' && stringRaw !== '0.0' &&
                                               parsedValue !== 0 && parsedValue !== '0' && stringParsed !== '0' && stringParsed !== '0.0' &&
                                               rawValue !== null && rawValue !== undefined &&
                                               parsedValue !== null && parsedValue !== undefined &&
                                               !isNaN(numValue) && isFinite(numValue) &&
                                               !isNaN(numParsed) && isFinite(numParsed);
                                    } catch (error) {
                                        return false;
                                    }
                                },
                                color: function(context) {
                                    return '#ffffff'; // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß
                                },
                                font: {
                                    weight: 'bold',
                                    size: 11
                                },
                                anchor: 'center',
                                align: 'center',
                                formatter: function(value, context) {
                                    try {
                                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ parsed ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏î‡∏¥‡∏ö
                                        const rawValue = context.dataset.data[context.dataIndex];
                                        const parsedValue = context.parsed ? context.parsed.y : value;
                                        const numValue = Number(rawValue);
                                        const numParsed = Number(parsedValue);
                                        const stringRaw = String(rawValue);
                                        const stringParsed = String(parsedValue);
                                        
                                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤ 0 (debug ‡∏õ‡∏¥‡∏î‡πÑ‡∏ß‡πâ)
                                        // if (numValue === 0 || numParsed === 0) {
                                        //     console.log('üö´ Found zero value:', {
                                        //         rawValue, parsedValue, numValue, numParsed, 
                                        //         stringRaw, stringParsed, 
                                        //         dataset: context.dataset.label,
                                        //         dataIndex: context.dataIndex
                                        //     });
                                        // }
                                        
                                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î - ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô 0 ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö
                                        if (numValue > 0 && numParsed > 0 && 
                                            rawValue !== 0 && rawValue !== '0' && stringRaw !== '0' && stringRaw !== '0.0' &&
                                            parsedValue !== 0 && parsedValue !== '0' && stringParsed !== '0' && stringParsed !== '0.0' &&
                                            rawValue !== null && rawValue !== undefined &&
                                            parsedValue !== null && parsedValue !== undefined &&
                                            !isNaN(numValue) && isFinite(numValue) &&
                                            !isNaN(numParsed) && isFinite(numParsed)) {
                                            return numValue.toString();
                                        }
                                        return ''; // ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô 0 ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤
                                    } catch (error) {
                                        return '';
                                    }
                                },
                                textStrokeColor: '#000',
                                textStrokeWidth: 2
                            }, {
                                // ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏£‡∏ß‡∏°‡∏ö‡∏ô‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü (‡∏™‡∏µ‡∏î‡∏≥)
                                display: function(context) {
                                    // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡πÅ‡∏ó‡πà‡∏á‡∏ö‡∏ô‡∏™‡∏∏‡∏î (dataset ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
                                    try {
                                        if (!context || !context.parsed || context.parsed.y <= 0) return false;
                                        
                                        const chart = context.chart;
                                        const dataIndex = context.dataIndex;
                                        
                                        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                                        let total = 0;
                                        chart.data.datasets.forEach((dataset, i) => {
                                            const meta = chart.getDatasetMeta(i);
                                            if (!meta.hidden) {
                                                const rawValue = dataset.data[dataIndex];
                                                const numValue = Number(rawValue);
                                                if (numValue > 0 && rawValue !== 0 && rawValue !== '0' && rawValue !== null && rawValue !== undefined) {
                                                    total += numValue;
                                                }
                                            }
                                        });
                                        
                                        // ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ñ‡πâ‡∏≤‡∏ú‡∏•‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô 0
                                        if (total === 0) return false;
                                        
                                        // ‡∏´‡∏≤‡∏ß‡πà‡∏≤ dataset ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô dataset ‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                                        for (let i = chart.data.datasets.length - 1; i >= 0; i--) {
                                            const meta = chart.getDatasetMeta(i);
                                            if (!meta.hidden) {
                                                const rawValue = chart.data.datasets[i].data[dataIndex];
                                                const numValue = Number(rawValue);
                                                if (numValue > 0 && rawValue !== 0 && rawValue !== '0' && rawValue !== null && rawValue !== undefined) {
                                                    return i === context.datasetIndex;
                                                }
                                            }
                                        }
                                        return false;
                                    } catch (error) {
                                        return false;
                                    }
                                },
                                color: '#000', // ‡∏™‡∏µ‡∏î‡∏≥
                                backgroundColor: 'rgba(255, 255, 255, 0.8)',
                                borderColor: '#fff',
                                borderWidth: 2,
                                font: {
                                    weight: 'bold',
                                    size: 12
                                },
                                anchor: 'end',
                                align: 'top',
                                offset: 8,
                                formatter: function(value, context) {
                                    try {
                                        // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á‡∏ô‡∏µ‡πâ
                                        const chart = context.chart;
                                        const dataIndex = context.dataIndex;
                                        let total = 0;
                                        
                                        chart.data.datasets.forEach((dataset, i) => {
                                            const meta = chart.getDatasetMeta(i);
                                            if (!meta.hidden) {
                                                const rawValue = dataset.data[dataIndex];
                                                const numValue = Number(rawValue);
                                                if (numValue > 0 && rawValue !== 0 && rawValue !== '0' && rawValue !== null && rawValue !== undefined) {
                                                    total += numValue;
                                                }
                                            }
                                        });
                                        
                                        // ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ñ‡πâ‡∏≤‡∏ú‡∏•‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô 0
                                        if (total > 0) {
                                            return total.toString();
                                        }
                                        return '';
                                    } catch (error) {
                                        return '';
                                    }
                                },
                                padding: 4,
                                borderRadius: 4
                            }]
                        } : {})
                    },
                    animation: {
                        duration: 800,
                        easing: 'easeInOutQuart',
                        onComplete: function(animation) {
                            const chart = animation.chart;
                            const ctx = chart.ctx;
                            
                            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü
                            const totalsPerBar = [];
                            for (let i = 0; i < chart.data.labels.length; i++) {
                                let total = 0;
                                chart.data.datasets.forEach((dataset, datasetIndex) => {
                                    const meta = chart.getDatasetMeta(datasetIndex);
                                    if (!meta.hidden) {
                                        const rawValue = dataset.data[i];
                                        const numValue = Number(rawValue);
                                        if (numValue > 0 && rawValue !== 0 && rawValue !== '0' && rawValue !== null && rawValue !== undefined) {
                                            total += numValue;
                                        }
                                    }
                                });
                                totalsPerBar[i] = total;
                            }
                            
                            ctx.save();
                            
                            // ‡∏ß‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ stack (‡∏´‡∏≤‡∏Å ChartDataLabels plugin ‡πÑ‡∏°‡πà‡∏°‡∏µ) - ‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß
                            if (!hasDataLabels) {
                                ctx.font = 'bold 11px Arial';
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'middle';
                                ctx.fillStyle = '#ffffff'; // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß
                                ctx.strokeStyle = '#000000';
                                ctx.lineWidth = 2;
                                
                                chart.data.datasets.forEach((dataset, datasetIndex) => {
                                    const meta = chart.getDatasetMeta(datasetIndex);
                                    if (!meta.hidden) {
                                        dataset.data.forEach((value, index) => {
                                            // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0
                                            const numValue = Number(value);
                                            const stringValue = String(value);
                                            
                                            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤ 0 (debug ‡∏õ‡∏¥‡∏î‡πÑ‡∏ß‡πâ)
                                            // if (numValue === 0 || value === 0 || value === '0' || stringValue === '0') {
                                            //     console.log('üö´ Manual draw - Found zero:', {
                                            //         value, numValue, stringValue, 
                                            //         dataset: dataset.label, index,
                                            //         type: typeof value
                                            //     });
                                            // }
                                            
                                            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î - ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤ 0 ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö
                                            if (numValue > 0 && 
                                                value !== 0 && value !== '0' && 
                                                stringValue !== '0' && stringValue !== '0.0' &&
                                                value !== null && value !== undefined && value !== '' &&
                                                !isNaN(numValue) && isFinite(numValue)) {
                                                const element = meta.data[index];
                                                if (element) {
                                                    const x = element.x;
                                                    
                                                    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á‡∏¢‡πà‡∏≠‡∏¢ (stack segment)
                                                    let y;
                                                    if (element.base !== undefined && element.y !== undefined) {
                                                        // ‡∏´‡∏≤‡∏à‡∏∏‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á base (‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á) ‡πÅ‡∏•‡∏∞ y (‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô)
                                                        y = (element.base + element.y) / 2;
                                                    } else {
                                                        // ‡πÉ‡∏ä‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ base
                                                        y = element.y;
                                                    }
                                                    
                                                    // console.log('‚úÖ Manual draw - Drawing value:', numValue, 'at x:', x, 'y:', y, 'element:', {
                                                    //     top: element.y, 
                                                    //     base: element.base, 
                                                    //     calculated: y
                                                    // });
                                                    
                                                    // ‡∏ß‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≠‡∏ö‡∏î‡∏≥ ‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á
                                                    ctx.strokeText(numValue.toString(), x, y);
                                                    ctx.fillText(numValue.toString(), x, y);
                                                }
                                            }
                                        });
                                    }
                                });
                            }
                            
                            // ‡∏ß‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏£‡∏ß‡∏°‡∏ö‡∏ô‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü (‡∏™‡∏µ‡∏î‡∏≥)
                            ctx.font = 'bold 12px Arial';
                            ctx.textAlign = 'center';
                            ctx.textBaseline = 'bottom';
                            ctx.fillStyle = '#000'; // ‡∏™‡∏µ‡∏î‡∏≥
                            ctx.strokeStyle = '#fff';
                            ctx.lineWidth = 2;
                            
                            // ‡∏´‡∏≤‡∏à‡∏∏‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü
                            const barTops = [];
                            for (let i = 0; i < chart.data.labels.length; i++) {
                                let minY = chart.chartArea.bottom;
                                chart.data.datasets.forEach((dataset, datasetIndex) => {
                                    const meta = chart.getDatasetMeta(datasetIndex);
                                    if (!meta.hidden) {
                                        const rawValue = dataset.data[i];
                                        const numValue = Number(rawValue);
                                        if (numValue > 0 && rawValue !== 0 && rawValue !== '0' && rawValue !== null && rawValue !== undefined) {
                                            const element = meta.data[i];
                                            if (element && element.y < minY) {
                                                minY = element.y;
                                            }
                                        }
                                    }
                                });
                                barTops[i] = { x: null, y: minY };
                            }
                            
                            // ‡∏´‡∏≤ x position ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ó‡πà‡∏á
                            chart.data.datasets.forEach((dataset, datasetIndex) => {
                                const meta = chart.getDatasetMeta(datasetIndex);
                                if (!meta.hidden) {
                                    dataset.data.forEach((value, index) => {
                                        const rawValue = value;
                                        const numValue = Number(rawValue);
                                        if (numValue > 0 && rawValue !== 0 && rawValue !== '0' && rawValue !== null && rawValue !== undefined && barTops[index].x === null) {
                                            const element = meta.data[index];
                                            if (element) {
                                                barTops[index].x = element.x;
                                            }
                                        }
                                    });
                                }
                            });
                            
                            // ‡∏ß‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ó‡πà‡∏á
                            barTops.forEach((barTop, index) => {
                                // ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô 0 ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
                                if (barTop.x !== null && totalsPerBar[index] > 0) {
                                    const x = barTop.x;
                                    const y = barTop.y - 8; // ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü 8px
                                    
                                    // ‡∏ß‡∏≤‡∏î‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≤‡∏ß‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î (‡∏™‡∏µ‡∏î‡∏≥)
                                    ctx.strokeText(totalsPerBar[index].toString(), x, y);
                                    ctx.fillText(totalsPerBar[index].toString(), x, y);
                                }
                            });
                            
                            ctx.restore();
                        }
                    }
                }
            });

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á custom legend
            createAreaStatusLegend(sortedStatuses, statusConfig);

            // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
            const chartContainer = canvas.parentElement; // div ‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏≠‡∏ö canvas
            
            // ‡∏•‡∏ö event listener ‡πÄ‡∏Å‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
            if (chartContainer._areaChartClickHandler) {
                chartContainer.removeEventListener('click', chartContainer._areaChartClickHandler);
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á event handler ‡πÉ‡∏´‡∏°‡πà
            chartContainer._areaChartClickHandler = function(e) {
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠ canvas (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà legend)
                const legendContainer = document.getElementById('area-status-legend');
                const isLegendClick = legendContainer && legendContainer.contains(e.target);
                
                if (!isLegendClick) {
                    if (window.areaStatusChart) {
                        showAllStatuses(window.areaStatusChart);
                        updateLegendVisuals(window.areaStatusChart);
                        console.log('üîÑ ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á');
                    }
                }
            };
            
            chartContainer.addEventListener('click', chartContainer._areaChartClickHandler);

            console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á Area Status Chart ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á Legend ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü Area Status
        function createAreaStatusLegend(statuses, statusConfig) {
            const legendContainer = document.getElementById('area-status-legend');
            if (!legendContainer) return;

            legendContainer.innerHTML = '';

            statuses.forEach(status => {
                const legendItem = document.createElement('div');
                legendItem.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    padding: 5px 10px;
                    border-radius: 4px;
                    cursor: pointer;
                    transition: background-color 0.2s;
                    font-size: 13px;
                `;

                legendItem.innerHTML = `
                    <div style="
                        width: 16px;
                        height: 16px;
                        background-color: ${statusConfig[status] || '#6c757d'};
                        border-radius: 3px;
                    "></div>
                    <span style="color: #333;">${status}</span>
                `;

                // ‡πÄ‡∏û‡∏¥‡πà‡∏° hover effect
                legendItem.addEventListener('mouseenter', () => {
                    legendItem.style.backgroundColor = '#e9ecef';
                });

                legendItem.addEventListener('mouseleave', () => {
                    legendItem.style.backgroundColor = 'transparent';
                });

                // ‡πÄ‡∏û‡∏¥‡πà‡∏° click handler ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                legendItem.addEventListener('click', (e) => {
                    e.stopPropagation(); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ trigger chart click
                    
                    if (window.areaStatusChart) {
                        const chart = window.areaStatusChart;
                        const clickedDatasetIndex = chart.data.datasets.findIndex(ds => ds.label === status);
                        
                        if (clickedDatasetIndex !== -1) {
                            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô - ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏¢‡∏π‡πà
                            let visibleCount = 0;
                            let isClickedVisible = false;
                            
                            chart.data.datasets.forEach((dataset, index) => {
                                const meta = chart.getDatasetMeta(index);
                                if (!meta.hidden) {
                                    visibleCount++;
                                    if (index === clickedDatasetIndex) {
                                        isClickedVisible = true;
                                    }
                                }
                            });
                            
                            // Logic ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô
                            if (visibleCount === 1 && isClickedVisible) {
                                // ‡∏ñ‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏Ñ‡πà‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß => ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                                showAllStatuses(chart);
                            } else {
                                // ‡∏ñ‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å => ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å
                                showOnlyStatus(chart, clickedDatasetIndex);
                            }
                            
                            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï visual ‡∏Ç‡∏≠‡∏á legend ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                            updateLegendVisuals(chart);
                        }
                    }
                });

                legendContainer.appendChild(legendItem);
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        function showAllStatuses(chart) {
            chart.data.datasets.forEach((dataset, index) => {
                const meta = chart.getDatasetMeta(index);
                meta.hidden = false;
            });
            chart.update();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
        function showOnlyStatus(chart, targetIndex) {
            chart.data.datasets.forEach((dataset, index) => {
                const meta = chart.getDatasetMeta(index);
                meta.hidden = (index !== targetIndex);
            });
            chart.update();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï visual ‡∏Ç‡∏≠‡∏á legend ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function updateLegendVisuals(chart) {
            const legendContainer = document.getElementById('area-status-legend');
            if (!legendContainer) return;

            chart.data.datasets.forEach((dataset, index) => {
                const meta = chart.getDatasetMeta(index);
                
                // ‡∏´‡∏≤ legend item ‡∏à‡∏≤‡∏Å label
                const legendItems = Array.from(legendContainer.children);
                const legendItem = legendItems.find(item => {
                    const textSpan = item.querySelector('span');
                    return textSpan && textSpan.textContent === dataset.label;
                });
                
                if (legendItem) {
                    const colorBox = legendItem.querySelector('div');
                    const textSpan = legendItem.querySelector('span');
                    
                    if (meta.hidden) {
                        colorBox.style.opacity = '0.3';
                        textSpan.style.color = '#999';
                        legendItem.style.fontWeight = 'normal';
                        legendItem.style.background = 'rgba(0,0,0,0.05)';
                    } else {
                        colorBox.style.opacity = '1';
                        textSpan.style.color = '#333';
                        legendItem.style.fontWeight = 'bold';
                        legendItem.style.background = 'rgba(0,123,255,0.1)';
                    }
                }
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
        function getLast7DaysData() {
            if (!filteredData2025 || filteredData2025.length === 0) {
                return [];
            }
            
            // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô "‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î"
            const allDates = new Set();
            filteredData2025.forEach(row => {
                let endDate;
                if (row.c && row.c[36]) {
                    endDate = row.c[36].v;
                } else {
                    endDate = row[36];
                }
                
                if (endDate && endDate.toString().trim() !== '' && endDate.toString().trim() !== '-') {
                    allDates.add(endDate.toString().trim());
                }
            });
            
            // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô array ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö
            const sortedDates = Array.from(allDates).sort((a, b) => {
                const dateA = parseThaiDate(a);
                const dateB = parseThaiDate(b);
                return dateB - dateA; // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏õ‡πÄ‡∏Å‡πà‡∏≤
            });
            
            // ‡πÄ‡∏≠‡∏≤‡πÅ‡∏Ñ‡πà 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            const last7Dates = sortedDates.slice(0, 7);
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô
            const result = last7Dates.map(dateStr => {
                const dayData = filteredData2025.filter(row => {
                    let endDate;
                    if (row.c && row.c[36]) {
                        endDate = row.c[36].v;
                    } else {
                        endDate = row[36];
                    }
                    return endDate && endDate.toString().trim() === dateStr;
                });
                
                // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö array
                const convertedData = dayData.map(row => {
                    if (row.c) {
                        return row.c.map(cell => cell ? cell.v : '');
                    } else {
                        return row;
                    }
                });
                
                // ‡∏ô‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
                const statusCounts = getStatusCounts(convertedData);
                
                const success = statusCounts['‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'] || 0;
                const closed = (['‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å', '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°', '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°', '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°']
                    .reduce((sum, status) => sum + (statusCounts[status] || 0), 0));
                const pending = convertedData.length - success - closed;
                
                                 return {
                     date: formatDateForDisplay(dateStr),
                     total: convertedData.length,
                     success: success,
                     pending: pending,
                     closed: closed,
                     statusCounts: statusCounts // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏£‡∏¥‡∏á
                 };
            });
            
            return result.reverse(); // ‡∏Å‡∏•‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏õ‡πÉ‡∏´‡∏°‡πà
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
        function formatDateForDisplay(dateStr) {
            try {
                const parts = dateStr.split('/');
                if (parts.length === 3) {
                    const day = parts[0].padStart(2, '0');
                    const month = parts[1].padStart(2, '0');
                    return `${day}/${month}`;
                }
            } catch (e) {
                console.warn('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:', dateStr);
            }
            return dateStr;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ó‡∏¢‡πÄ‡∏õ‡πá‡∏ô Date object
        function parseThaiDate(dateStr) {
            try {
                const parts = dateStr.split('/');
                if (parts.length === 3) {
                    const day = parseInt(parts[0]);
                    const month = parseInt(parts[1]) - 1; // JavaScript month starts from 0
                    const year = parseInt(parts[2]);
                    return new Date(year, month, day);
                }
            } catch (e) {
                console.warn('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:', dateStr);
            }
            return new Date(0);
        }

        // URL for Google Sheets
        const sheetUrl = "https://docs.google.com/spreadsheets/d/1hsaIWrQmhwGJkR5IlCvCKoR2RTyC3jWhRoyEXqWZQs8/export?format=csv&gid=377151035";

        let chart;
        let originalData;
        let filteredData2025;

        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
        let currentPage = 1;
        let pageSize = 50;
        let totalPages = 1;

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function fetchDataAndUpdateTable() {
            console.log('=== ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ===');
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ navbar ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î
            updateNavbarStatus('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...', true);
            
            return fetch(sheetUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.text();
                })
                .then(csvText => {
                    console.log('‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    
                    const rows = parseCsvData(csvText);
                    originalData = rows;
                    filteredData2025 = filterDataByYear(rows, 2025);
                    
                    console.log('üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:', rows.length, '‡πÅ‡∏ñ‡∏ß');
                    console.log('üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ 2025:', filteredData2025.length, '‡πÅ‡∏ñ‡∏ß');
                    
                    // ‡πÅ‡∏¢‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞ pivot table
                    updateChartAndTables(filteredData2025);
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    updateMainTable(filteredData2025);
                    
                    // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    const allButton = document.querySelector('.month-card[data-month="all"]');
                    if (allButton) {
                        // ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏õ‡∏∏‡πà‡∏° All
                        document.querySelectorAll('.month-card').forEach(card => {
                            card.style.backgroundColor = '#f0f0f0';
                            card.style.color = 'black';
                        });
                        allButton.style.backgroundColor = '#003366';
                        allButton.style.color = 'white';
                    }
                    
                    // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏≠‡∏Å
                    const existingInfo = document.getElementById('data-count-info');
                    if (existingInfo) {
                        existingInfo.remove();
                    }
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
                    const paginationContainerTop = document.getElementById('pagination-container-top');
                    if (paginationContainerTop) {
                        paginationContainerTop.style.display = 'flex';
                    }
                    
                    console.log('‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    
                    // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
                    loadDailyReportData();
                    
                    // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error ‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
                    const existingError = document.querySelector('.error-message');
                    if (existingError) {
                        existingError.remove();
                    }
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ navbar ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                    updateNavbarOnDataLoad();
                    
                    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô filter system
                    initializeTableFilters();
                    
                    return filteredData2025; // return ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ caller ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
                })
                .catch(error => {
                    console.error("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:", error);
                    
                    // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error ‡πÄ‡∏î‡∏¥‡∏°
                    const existingError = document.querySelector('.error-message');
                    if (existingError) {
                        existingError.remove();
                    }
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error ‡πÉ‡∏´‡∏°‡πà
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'error-message';
                    messageDiv.style.cssText = `
                        padding: 15px; 
                        margin: 20px 0; 
                        background-color: #f8d7da; 
                        border: 2px solid #f5c6cb; 
                        border-radius: 8px; 
                        color: #721c24;
                        text-align: center;
                        font-weight: bold;
                    `;
                    messageDiv.innerHTML = `
                        ‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•<br>
                        <small style="font-weight: normal;">
                            ${error.message}<br>
                            ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                        </small><br>
                        <button onclick="fetchDataAndUpdateTable()" style="
                            margin-top: 10px; 
                            padding: 8px 15px; 
                            background-color: #721c24; 
                            color: white; 
                            border: none; 
                            border-radius: 4px; 
                            cursor: pointer;
                        ">‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
                    `;
                    
                    // ‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏ó‡∏£‡∏Å error message
                    const headerContainer = document.querySelector('.header-container');
                    if (headerContainer) {
                        headerContainer.insertAdjacentElement('afterend', messageDiv);
                    }
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ navbar ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
                    updateNavbarOnError();
                    
                    throw error; // re-throw ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ caller ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ
                });
        }
        
        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤
        let originalProblemsData = [];
        let filteredProblemsData = [];

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤
        function searchProblemsTable() {
            const searchTerm = document.getElementById('problems-search-input').value.toLowerCase().trim();
            
            if (!searchTerm) {
                renderProblemsTable(originalProblemsData);
                return;
            }

            const filteredData = originalProblemsData.filter(item => {
                return item.name.toLowerCase().includes(searchTerm) ||
                       item.agent.toLowerCase().includes(searchTerm) ||
                       item.area.toLowerCase().includes(searchTerm) ||
                       item.status.toLowerCase().includes(searchTerm) ||
                       item.missingDocs.some(doc => doc.toLowerCase().includes(searchTerm));
            });

            renderProblemsTable(filteredData);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤
        function resetProblemsTable() {
            document.getElementById('problems-search-input').value = '';
            renderProblemsTable(originalProblemsData);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤
        function refreshProblemsTable() {
            loadDailyReportData();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞ pagination ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
        function showMainTable() {
            const paginationContainerTop = document.getElementById('pagination-container-top');
            if (paginationContainerTop) {
                paginationContainerTop.style.display = 'flex';
                console.log('üîç ‡πÅ‡∏™‡∏î‡∏á pagination-container-top ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å');
                console.log('üîç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ display ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:', paginationContainerTop.style.display);
            } else {
                console.error('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö pagination-container-top');
            }
            
            if (window.tableData && window.tableData.length > 0) {
                renderTableData(window.tableData);
            } else {
                // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö filter
                loadSampleData();
                
                // ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
                setTimeout(() => {
                    fetchDataAndUpdateTable().catch(error => {
                        console.warn('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ, ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ó‡∏ô');
                    });
                }, 2000);
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô debug ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ pagination
        function debugPaginationStatus() {
            const paginationContainerTop = document.getElementById('pagination-container-top');
            console.log('=== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Pagination Debug ===');
            console.log('1. ‡∏û‡∏ö pagination-container-top:', !!paginationContainerTop);
            if (paginationContainerTop) {
                console.log('2. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ display:', paginationContainerTop.style.display);
                console.log('3. Computed style display:', window.getComputedStyle(paginationContainerTop).display);
                console.log('4. Visible (offsetHeight > 0):', paginationContainerTop.offsetHeight > 0);
            }
            console.log('5. ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ window.tableData:', !!window.tableData);
            console.log('6. ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', window.tableData ? window.tableData.length : 0);
        }

        // =============== Table Filter Functions ===============
        
        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö filter
        let tableFilters = {};
        let originalTableData = [];
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î filter dropdown
        function toggleFilter(button, columnIndex) {
            console.log('üîß toggleFilter called:', columnIndex);
            
            // ‡∏õ‡∏¥‡∏î filter ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏Å‡πà‡∏≠‡∏ô
            document.querySelectorAll('.filter-menu').forEach(menu => {
                if (menu.dataset.column != columnIndex) {
                    menu.classList.remove('show');
                }
            });
            
            const filterMenu = button.nextElementSibling;
            console.log('üîß filterMenu found:', !!filterMenu);
            
            if (filterMenu.classList.contains('show')) {
                filterMenu.classList.remove('show');
                console.log('üîß Filter menu closed');
            } else {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ filter options ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
                populateFilterOptions(columnIndex);
                filterMenu.classList.add('show');
                console.log('üîß Filter menu opened');
            }
            
            // ‡∏õ‡∏¥‡∏î filter ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô
            setTimeout(() => {
                function closeFilter(e) {
                    if (!button.closest('.filter-dropdown').contains(e.target)) {
                        filterMenu.classList.remove('show');
                        document.removeEventListener('click', closeFilter);
                        console.log('üîß Filter menu closed by outside click');
                    }
                }
                document.addEventListener('click', closeFilter);
            }, 100);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ options ‡πÉ‡∏ô filter
        function populateFilterOptions(columnIndex) {
            console.log('üîß populateFilterOptions called for column:', columnIndex);
            
            const filterMenu = document.querySelector(`.filter-menu[data-column="${columnIndex}"]`);
            if (!filterMenu) {
                console.error('üö´ Filter menu not found for column:', columnIndex);
                return;
            }
            
            const filterOptions = filterMenu.querySelector('.filter-options');
            if (!filterOptions) {
                console.error('üö´ Filter options container not found');
                return;
            }
            
            // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const tableBody = document.getElementById('data-body');
            if (!tableBody) {
                console.error('üö´ Table body not found');
                return;
            }
            
            const rows = Array.from(tableBody.querySelectorAll('tr:not(.filtered-out)'));
            console.log('üîß Found rows:', rows.length);
            
            // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ô‡∏µ‡πâ
            const uniqueValues = new Set();
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('td');
                if (cells[columnIndex]) {
                    const value = cells[columnIndex].textContent.trim();
                    if (value && value !== '') {
                        uniqueValues.add(value);
                    }
                }
            });
            
            console.log('üîß Unique values found:', uniqueValues.size);
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡πà‡∏≤
            const sortedValues = Array.from(uniqueValues).sort();
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö options
            let optionsHTML = '<label><input type="checkbox" value="all" checked onchange="toggleAllFilters(this)"> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>';
            
            sortedValues.forEach(value => {
                const escapedValue = value.replace(/"/g, '&quot;');
                const isChecked = !tableFilters[columnIndex] || tableFilters[columnIndex].includes(value);
                optionsHTML += `<label><input type="checkbox" value="${escapedValue}" ${isChecked ? 'checked' : ''} onchange="applyFilter(${columnIndex})"> ${value}</label>`;
            });
            
            filterOptions.innerHTML = optionsHTML;
            console.log('üîß Filter options populated');
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô filter options
        function filterSearchInDropdown(input) {
            const searchTerm = input.value.toLowerCase();
            const filterOptions = input.closest('.filter-menu').querySelector('.filter-options');
            const labels = filterOptions.querySelectorAll('label');
            
            labels.forEach(label => {
                const text = label.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    label.style.display = 'flex';
                } else {
                    label.style.display = 'none';
                }
            });
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function toggleAllFilters(allCheckbox) {
            const filterMenu = allCheckbox.closest('.filter-menu');
            const columnIndex = parseInt(filterMenu.dataset.column);
            const checkboxes = filterMenu.querySelectorAll('input[type="checkbox"]:not([value="all"])');
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = allCheckbox.checked;
            });
            
            if (allCheckbox.checked) {
                delete tableFilters[columnIndex];
            }
            
            applyFilter(columnIndex);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå filter
        function applyFilter(columnIndex) {
            console.log('üîß applyFilter called for column:', columnIndex);
            
            const filterMenu = document.querySelector(`.filter-menu[data-column="${columnIndex}"]`);
            if (!filterMenu) {
                console.error('üö´ Filter menu not found');
                return;
            }
            
            const checkedBoxes = filterMenu.querySelectorAll('input[type="checkbox"]:not([value="all"]):checked');
            const allCheckbox = filterMenu.querySelector('input[value="all"]');
            
            console.log('üîß Checked boxes:', checkedBoxes.length);
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"
            const totalCheckboxes = filterMenu.querySelectorAll('input[type="checkbox"]:not([value="all"])').length;
            const checkedCount = checkedBoxes.length;
            
            console.log('üîß Total checkboxes:', totalCheckboxes, 'Checked count:', checkedCount);
            
            if (checkedCount === 0) {
                allCheckbox.checked = false;
                allCheckbox.indeterminate = false;
                tableFilters[columnIndex] = []; // Empty array means hide all
                console.log('üîß No items selected - hiding all');
            } else if (checkedCount === totalCheckboxes) {
                allCheckbox.checked = true;
                allCheckbox.indeterminate = false;
                delete tableFilters[columnIndex]; // Show all
                console.log('üîß All items selected - showing all');
            } else {
                allCheckbox.checked = false;
                allCheckbox.indeterminate = true;
                
                // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ
                const selectedValues = Array.from(checkedBoxes).map(cb => cb.value.replace(/&quot;/g, '"'));
                tableFilters[columnIndex] = selectedValues;
                console.log('üîß Partial selection:', selectedValues);
            }
            
            // ‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            applyAllFilters();
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå filter ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function applyAllFilters() {
            const tableBody = document.getElementById('data-body');
            const rows = Array.from(tableBody.querySelectorAll('tr'));
            
            rows.forEach(row => {
                let showRow = true;
                const cells = row.querySelectorAll('td');
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ filter
                for (let columnIndex in tableFilters) {
                    const allowedValues = tableFilters[columnIndex];
                    const cellValue = cells[columnIndex] ? cells[columnIndex].textContent.trim() : '';
                    
                    if (allowedValues && allowedValues.length > 0 && !allowedValues.includes(cellValue)) {
                        showRow = false;
                        break;
                    }
                }
                
                if (showRow) {
                    row.classList.remove('filtered-out');
                } else {
                    row.classList.add('filtered-out');
                }
            });
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á
            updateFilteredRowCount();
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á
        function updateFilteredRowCount() {
            const tableBody = document.getElementById('data-body');
            const allRows = tableBody.querySelectorAll('tr');
            const visibleRows = tableBody.querySelectorAll('tr:not(.filtered-out)');
            
            // ‡∏´‡∏≤ element ‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
            let countElement = document.querySelector('.table-row-count');
            if (!countElement) {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á element ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡∏°‡πà
                const tableContainer = document.getElementById('data-table').parentElement;
                countElement = document.createElement('div');
                countElement.className = 'table-row-count';
                countElement.style.cssText = 'margin-top: 10px; font-size: 12px; color: #666; text-align: right;';
                tableContainer.appendChild(countElement);
            }
            
            countElement.textContent = `‡πÅ‡∏™‡∏î‡∏á ${visibleRows.length} ‡∏à‡∏≤‡∏Å ${allRows.length} ‡πÅ‡∏ñ‡∏ß`;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ filter
            updateFilterStatus();
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ filter
        function updateFilterStatus() {
            const statusElement = document.getElementById('filter-status');
            if (!statusElement) return;
            
            const activeFilters = Object.keys(tableFilters).length;
            
            if (activeFilters > 0) {
                statusElement.textContent = `üîç ‡∏°‡∏µ Filter ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà ${activeFilters} ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå`;
                statusElement.style.color = '#007bff';
            } else {
                statusElement.textContent = '';
            }
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï filter ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function resetAllFilters() {
            tableFilters = {};
            const tableBody = document.getElementById('data-body');
            const rows = Array.from(tableBody.querySelectorAll('tr'));
            
            rows.forEach(row => {
                row.classList.remove('filtered-out');
            });
            
            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï dropdown ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            document.querySelectorAll('.filter-menu').forEach(menu => {
                const allCheckbox = menu.querySelector('input[value="all"]');
                const otherCheckboxes = menu.querySelectorAll('input[type="checkbox"]:not([value="all"])');
                
                if (allCheckbox) allCheckbox.checked = true;
                otherCheckboxes.forEach(cb => cb.checked = true);
            });
            
            updateFilteredRowCount();
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô filter system
        function initializeTableFilters() {
            console.log('üîß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô filter system...');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const tbody = document.getElementById('data-body');
            const rows = tbody ? tbody.querySelectorAll('tr') : [];
            
            console.log('üîß ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:', rows.length, '‡πÅ‡∏ñ‡∏ß');
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß
            setTimeout(() => {
                updateFilteredRowCount();
                console.log('‚úÖ Filter system ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ filter ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß
                const statusElement = document.getElementById('filter-status');
                if (statusElement && rows.length > 0) {
                    statusElement.textContent = '‚úÖ Filter ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô - ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° ‚ñº ‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå';
                    statusElement.style.color = '#28a745';
                }
            }, 500);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö filter
        function loadSampleData() {
            console.log('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á...');
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö object ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö updateMainTable
            const sampleDataObjects = [
                { area: 'RSM1_BMA-West', roundDate: '22-24/01/2025', trainingMonth: 'Jan25', week: '4', name: '‡∏õ‡∏£‡∏µ‡∏¢‡∏á‡∏Ñ‡πå ‡∏£‡∏∞‡∏ß‡∏¥‡πÇ‡∏°‡∏ó‡∏¢‡πå', company: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏™‡∏¢‡∏≤‡∏°‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î', agentCode: 'WW-BM-0012', province: '‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ', workStatus: '‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á', registerResult: '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å', latestStatus: '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å', startDate: '11/01/2025', endDate: '28/2/2025', sla: '48', year: '2025' },
                { area: 'RSM1_BMA-West', roundDate: '22-24/01/2025', trainingMonth: 'Jan25', week: '4', name: '‡∏Å‡∏£‡∏ß‡∏µ‡∏¢‡πå ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå‡∏ò‡∏≤‡∏£‡∏≤', company: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÅ‡∏≠‡∏• ‡∏ó‡∏µ ‡∏≠‡∏µ ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏≠‡∏¥‡∏á‡∏Ñ‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î', agentCode: 'WW-CR-1510', province: '‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ', workStatus: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤', registerResult: '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', latestStatus: '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', startDate: '15/01/2025', endDate: '31/5/2025', sla: '136', year: '2025' },
                { area: 'RSM1_BMA-West', roundDate: '08-10/01/2025', trainingMonth: 'Jan25', week: '2', name: '‡∏™‡∏∏‡∏ß‡∏¥‡∏ó‡∏¢‡πå ‡∏û‡∏£‡∏´‡∏°‡∏ö‡∏π‡∏£‡πÄ‡∏ô‡∏ï‡∏£', company: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ß‡∏¥‡∏ô‡∏î‡∏≠‡∏° ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏ô‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏ô‡∏• ‡∏à‡∏≥‡∏Å‡∏±‡∏î', agentCode: 'WW-BM-0088', province: '‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', workStatus: '‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á', registerResult: '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', latestStatus: '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', startDate: '28/12/2024', endDate: '1/5/2025', sla: '124', year: '2025' },
                { area: 'RSM2_BMA-East', roundDate: '22-24/01/2025', trainingMonth: 'Jan25', week: '4', name: '‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡∏Ñ‡∏≥‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥', company: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏õ‡∏µ‡πà‡∏ô‡πÅ‡∏Å‡πâ‡∏ß‡πÅ‡∏°‡∏ô‡πÅ‡∏ü‡∏Ñ‡πÄ‡∏à‡∏≠‡∏£‡∏¥‡πà‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î', agentCode: 'WW-BM-0124', province: '‡∏£‡∏∞‡∏¢‡∏≠‡∏á', workStatus: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤', registerResult: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°', latestStatus: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°', startDate: '14/01/2025', endDate: '22/4/2025', sla: '98', year: '2025' },
                { area: 'RSM3_Central', roundDate: '15-17/01/2025', trainingMonth: 'Jan25', week: '3', name: '‡∏ô‡∏û‡∏î‡∏• ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏™‡∏∏‡∏Ç', company: '‡∏´‡∏à‡∏Å. ‡πÄ‡∏ã‡πá‡∏ô‡∏ó‡∏£‡∏±‡∏•‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ß‡∏¥‡∏™', agentCode: 'WW-CT-2301', province: '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', workStatus: '‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á', registerResult: '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', latestStatus: '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', startDate: '20/01/2025', endDate: '', sla: '15', year: '2025' },
                { area: 'RSM1_BMA-West', roundDate: '15-17/01/2025', trainingMonth: 'Jan25', week: '3', name: '‡∏ß‡∏¥‡∏£‡∏±‡∏ä ‡∏ô‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå', company: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÇ‡∏ã‡∏ü‡∏≤‡∏£‡πå ‡∏≠‡∏¥‡∏ô‡∏î‡∏±‡∏™‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏• ‡∏à‡∏≥‡∏Å‡∏±‡∏î', agentCode: 'WW-BM-0245', province: '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£', workStatus: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤', registerResult: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ', latestStatus: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ', startDate: '16/01/2025', endDate: '', sla: '12', year: '2025' },
                { area: 'RSM4_North', roundDate: '29-31/01/2025', trainingMonth: 'Jan25', week: '5', name: '‡∏™‡∏∏‡∏£‡πÄ‡∏î‡∏ä ‡∏ß‡∏á‡∏Ñ‡πå‡πÇ‡∏ä‡∏ï‡∏¥', company: '‡∏´‡∏à‡∏Å. ‡∏ô‡∏≠‡∏£‡πå‡∏ó‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ', agentCode: 'WW-NT-1890', province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', workStatus: '‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á', registerResult: '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°', latestStatus: '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°', startDate: '30/01/2025', endDate: '', sla: '5', year: '2025' },
                { area: 'RSM5_Northeast', roundDate: '12-14/01/2025', trainingMonth: 'Jan25', week: '2', name: '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ ‡∏û‡∏π‡∏•‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå', company: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏µ‡∏™‡∏≤‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ß‡∏¥‡∏™ ‡∏à‡∏≥‡∏Å‡∏±‡∏î', agentCode: 'WW-NE-0567', province: '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô', workStatus: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤', registerResult: '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°', latestStatus: '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°', startDate: '13/01/2025', endDate: '', sla: '25', year: '2025' },
                { area: 'RSM2_BMA-East', roundDate: '08-10/01/2025', trainingMonth: 'Jan25', week: '2', name: '‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡πÉ‡∏à‡∏î‡∏µ', company: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏µ‡∏™‡∏ï‡πå‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î', agentCode: 'WW-ET-3456', province: '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', workStatus: '‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á', registerResult: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User', latestStatus: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User', startDate: '10/01/2025', endDate: '', sla: '28', year: '2025' },
                { area: 'RSM3_Central', roundDate: '22-24/01/2025', trainingMonth: 'Jan25', week: '4', name: '‡∏ß‡∏¥‡∏ä‡∏±‡∏¢ ‡∏™‡∏∏‡∏Ç‡πÄ‡∏à‡∏£‡∏¥‡∏ç', company: '‡∏´‡∏à‡∏Å. ‡πÄ‡∏ã‡πá‡∏ô‡∏ó‡∏£‡∏±‡∏•‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå', agentCode: 'WW-CC-7789', province: '‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', workStatus: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤', registerResult: 'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£', latestStatus: 'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£', startDate: '25/01/2025', endDate: '', sla: '8', year: '2025' },
                { area: 'RSM4_North', roundDate: '15-17/01/2025', trainingMonth: 'Jan25', week: '3', name: '‡∏≠‡∏ô‡∏∏‡∏ä‡∏≤ ‡∏õ‡∏£‡∏∞‡∏ó‡∏∏‡∏°‡∏ä‡∏≤‡∏ï‡∏¥', company: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ô‡∏≠‡∏£‡πå‡∏ó‡πÄ‡∏ó‡∏Ñ ‡∏à‡∏≥‡∏Å‡∏±‡∏î', agentCode: 'WW-NT-5566', province: '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢', workStatus: '‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á', registerResult: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô', latestStatus: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô', startDate: '17/01/2025', endDate: '', sla: '18', year: '2025' },
                { area: 'RSM5_Northeast', roundDate: '22-24/01/2025', trainingMonth: 'Jan25', week: '4', name: '‡∏ö‡∏±‡∏ç‡∏ä‡∏≤ ‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡∏®‡∏£‡∏µ', company: '‡∏´‡∏à‡∏Å. ‡∏≠‡∏µ‡∏™‡∏≤‡∏ô‡πÑ‡∏≠‡∏ó‡∏µ', agentCode: 'WW-NE-8899', province: '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', workStatus: '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤', registerResult: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏ñ', latestStatus: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏ñ', startDate: '24/01/2025', endDate: '', sla: '10', year: '2025' }
            ];

            // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ global
            window.tableData = sampleDataObjects;
            window.originalTableData = [...sampleDataObjects];

            // ‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô renderTableData ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
            renderTableData(sampleDataObjects);
            
            console.log('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô:', sampleDataObjects.length, '‡πÅ‡∏ñ‡∏ß');
            
            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô filter system
            initializeTableFilters();
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô filter
            showFilterInstructions();
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ navbar
            updateNavbarStatus('‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß - ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ Filter ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß!', true);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô filter
        function showFilterInstructions() {
            // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
            const existingInfo = document.querySelector('.filter-instructions');
            if (existingInfo) {
                existingInfo.remove();
            }

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
            const instructionsDiv = document.createElement('div');
            instructionsDiv.className = 'filter-instructions';
            instructionsDiv.style.cssText = `
                background-color: #e7f3ff;
                border: 1px solid #b3d9ff;
                border-radius: 6px;
                padding: 12px;
                margin: 10px 0;
                font-size: 14px;
                color: #0066cc;
            `;
            instructionsDiv.innerHTML = `
                <strong>üí° ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ Filter:</strong><br>
                ‚Ä¢ ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° <strong>‚ñº</strong> ‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå <strong>"‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà"</strong> ‡∏´‡∏£‡∏∑‡∏≠ <strong>"‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô"</strong><br>
                ‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á<br>
                ‚Ä¢ ‡πÉ‡∏ä‡πâ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞<br>
                ‚Ä¢ ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï Filter" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            `;

            // ‡πÅ‡∏ó‡∏£‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const tableHeaderContainer = document.querySelector('.table-header-container');
            if (tableHeaderContainer) {
                tableHeaderContainer.parentNode.insertBefore(instructionsDiv, tableHeaderContainer.nextSibling);
            }
                 }

        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£ sort
        let sortColumn = null;
        let sortDirection = 'asc';

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô handleSort
        function handleSort(columnKey) {
            console.log('üîß ‡∏Å‡∏≥‡∏•‡∏±‡∏á sort ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå:', columnKey);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (sortColumn === columnKey) {
                // ‡∏™‡∏•‡∏±‡∏ö‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ asc
                sortColumn = columnKey;
                sortDirection = 'asc';
            }
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï sort icons
            updateSortIcons(columnKey, sortDirection);
            
            // sort ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            if (window.tableData && window.tableData.length > 0) {
                const sortedData = [...window.tableData].sort((a, b) => {
                    const aValue = a[columnKey] || '';
                    const bValue = b[columnKey] || '';
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    const aNum = parseFloat(aValue);
                    const bNum = parseFloat(bValue);
                    
                    if (!isNaN(aNum) && !isNaN(bNum)) {
                        // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
                        return sortDirection === 'asc' ? aNum - bNum : bNum - aNum;
                    } else {
                        // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                        return sortDirection === 'asc' 
                            ? aValue.toString().localeCompare(bValue.toString(), 'th')
                            : bValue.toString().localeCompare(aValue.toString(), 'th');
                    }
                });
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà sort ‡πÅ‡∏•‡πâ‡∏ß
                renderTableData(sortedData);
                
                console.log('‚úÖ Sort ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô:', columnKey, sortDirection);
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï sort icons
        function updateSortIcons(activeColumn, direction) {
            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï sort icons ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            document.querySelectorAll('.sort-icon').forEach(icon => {
                icon.innerHTML = '‚ÜïÔ∏è';
                icon.style.opacity = '0.7';
            });
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï active sort icon
            const activeIcon = document.querySelector(`.sort-icon[data-column="${activeColumn}"]`);
            if (activeIcon) {
                activeIcon.innerHTML = direction === 'asc' ? '‚¨ÜÔ∏è' : '‚¨áÔ∏è';
                activeIcon.style.opacity = '1';
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö filter
        function testFilter() {
            console.log('üß™ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö Filter system...');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const tbody = document.getElementById('data-body');
            if (!tbody) {
                alert('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }
            
            const rows = tbody.querySelectorAll('tr');
            console.log('üîß ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á:', rows.length, '‡πÅ‡∏ñ‡∏ß');
            
            if (rows.length === 0) {
                alert('‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö filter dropdown ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà" (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 0)
            const areaFilterButton = document.querySelector('[onclick="toggleFilter(this, 0)"]');
            const agentFilterButton = document.querySelector('[onclick="toggleFilter(this, 6)"]');
            
            console.log('üîß ‡∏û‡∏ö‡∏õ‡∏∏‡πà‡∏° filter ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà:', !!areaFilterButton);
            console.log('üîß ‡∏û‡∏ö‡∏õ‡∏∏‡πà‡∏° filter ‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô:', !!agentFilterButton);
            
            // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏õ‡∏¥‡∏î filter dropdown ‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
            if (areaFilterButton) {
                console.log('üß™ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö filter ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà...');
                toggleFilter(areaFilterButton, 0);
                
                setTimeout(() => {
                    const filterMenu = document.querySelector('.filter-menu[data-column="0"]');
                    const isOpen = filterMenu && filterMenu.classList.contains('show');
                    console.log('üîß ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ filter menu ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà:', isOpen ? '‡πÄ‡∏õ‡∏¥‡∏î' : '‡∏õ‡∏¥‡∏î');
                    
                    if (isOpen) {
                        // ‡∏õ‡∏¥‡∏î filter menu
                        filterMenu.classList.remove('show');
                        alert('‚úÖ Filter system ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥!\n\n‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ:\n‚Ä¢ ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° ‚ñº ‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô"\n‚Ä¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á\n‚Ä¢ ‡πÉ‡∏ä‡πâ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞');
                    } else {
                        alert('‚ö†Ô∏è Filter system ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà');
                    }
                }, 100);
                
            } else {
                alert('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏∏‡πà‡∏° filter ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤
        function downloadProblemsTable() {
            if (!window.XLSX) {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î Excel library ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
                return;
            }

            if (originalProblemsData.length === 0) {
                alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î');
                return;
            }

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Excel
            const excelData = originalProblemsData.map(item => ({
                '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•': item.name,
                '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô': item.agent,
                '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': item.area,
                '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤': item.status,
                '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î': item.missingDocs.join(', ') || '‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô',
                'SLA (‡∏ß‡∏±‡∏ô)': item.sla !== '-' ? item.sla : '-'
            }));

            try {
                const worksheet = XLSX.utils.json_to_sheet(excelData);
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, "‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤");
                
                const now = new Date();
                const datePart = now.toLocaleDateString('th-TH', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                }).replace(/\//g, '-');
                
                const filename = `‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤_${datePart}.xlsx`;
                XLSX.writeFile(workbook, filename);
            } catch (error) {
                console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå Excel:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤
        function renderProblemsTable(data) {
            const tbody = document.getElementById('daily-problems-body');
            if (!tbody) return;

            tbody.innerHTML = '';

            // ‡∏ã‡πà‡∏≠‡∏ô pagination ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤
            const paginationContainerTop = document.getElementById('pagination-container-top');
            if (paginationContainerTop) {
                paginationContainerTop.style.display = 'none';
                console.log('üîç ‡∏ã‡πà‡∏≠‡∏ô pagination-container-top ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤');
            }

            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="padding: 20px; text-align: center; color: #28a745;">üéâ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö" ‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</td></tr>';
                return;
            }

            data.forEach(item => {
                // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
                let statusColor = '#20c997';

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î
                let missingDocsHtml = '';
                if (item.missingDocs.length > 0) {
                    missingDocsHtml = item.missingDocs.map(doc => 
                        `<span style="background-color: #ffc107; color: #212529; padding: 2px 6px; border-radius: 3px; font-size: 11px; margin: 1px; display: inline-block;">${doc}</span>`
                    ).join(' ');
                } else {
                    missingDocsHtml = '<span style="color: #28a745;">‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</span>';
                }

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="padding: 8px; border: 1px solid #ddd;">${item.name}</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">${item.agent}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${item.area}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">
                        <span style="background-color: ${statusColor}; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px;">
                            ${item.status}
                        </span>
                    </td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">
                        ${missingDocsHtml}
                    </td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">
                        ${item.sla !== '-' ? item.sla + ' ‡∏ß‡∏±‡∏ô' : '-'}
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å
        function updateMainTable(rows) {
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏µ 2025
            window.tableData = rows.filter(row => row.c[41]?.v === '2025').map(row => ({
                area: row.c[26]?.v || '',
                roundDate: row.c[27]?.v || '',
                trainingMonth: row.c[28]?.v || '',
                week: row.c[39]?.v || '',
                name: row.c[3]?.v || '',
                company: row.c[6]?.v || '',
                agentCode: row.c[7]?.v || '',
                province: row.c[8]?.v || '',
                workStatus: row.c[13]?.v || '',
                registerResult: row.c[33]?.v || '',
                latestStatus: row.c[34]?.v || '',
                startDate: row.c[35]?.v || '',
                endDate: row.c[36]?.v || '',
                sla: row.c[37]?.v || '',
                year: row.c[41]?.v || ''
            }));
            
            // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡πÑ‡∏ß‡πâ
            window.originalTableData = [...window.tableData];

            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
            const dataTable = document.getElementById('data-table');
            const thead = dataTable.getElementsByTagName('thead')[0];
            thead.innerHTML = '';

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß
            const headerRow = thead.insertRow();
            const columnHeaders = [
                { text: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà", key: "area" },
                { text: "‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà", key: "roundDate" },
                { text: "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°", key: "trainingMonth" },
                { text: "week", key: "week" },
                { text: "‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•", key: "name" },
                { text: "‡∏ä‡∏∑‡πà‡∏≠ ‡∏ö‡∏à‡∏Å./‡∏´‡∏à‡∏Å/‡∏£‡πâ‡∏≤‡∏ô (‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô)", key: "company" },
                { text: "‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô", key: "agentCode" },
                { text: "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô", key: "province" },
                { text: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô (‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á)", key: "workStatus" },
                { text: "‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô", key: "registerResult" },
                { text: "Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î", key: "latestStatus" },
                { text: "‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô", key: "startDate" },
                { text: "‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î", key: "endDate" },
                { text: "SLA", key: "sla" },
                { text: "‡∏õ‡∏µ", key: "year" }
            ];

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏±‡∏ß‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏û‡∏£‡πâ‡∏≠‡∏° event listener ‡πÅ‡∏•‡∏∞ filter dropdown
            columnHeaders.forEach((header, index) => {
                const th = document.createElement('th');
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á div container ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö header content
                const thContent = document.createElement('div');
                thContent.className = 'th-content';
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏° sort icon ‡∏î‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤
                const sortIcon = document.createElement('span');
                sortIcon.className = 'sort-icon';
                sortIcon.innerHTML = '‚ÜïÔ∏è';
                sortIcon.dataset.column = header.key;
                thContent.appendChild(sortIcon);
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á span ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
                const span = document.createElement('span');
                span.textContent = header.text;
                thContent.appendChild(span);
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏° filter dropdown ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà" (index 0) ‡πÅ‡∏•‡∏∞ "‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô" (index 6)
                if (index === 0 || index === 6) {
                    const filterDropdown = document.createElement('div');
                    filterDropdown.className = 'filter-dropdown';
                    
                    const filterBtn = document.createElement('button');
                    filterBtn.className = 'filter-btn';
                    filterBtn.textContent = '‚ñº';
                    filterBtn.title = 'Filter';
                    filterBtn.onclick = function() { toggleFilter(this, index); };
                    
                    const filterMenu = document.createElement('div');
                    filterMenu.className = 'filter-menu';
                    filterMenu.setAttribute('data-column', index);
                    
                    const filterSearch = document.createElement('div');
                    filterSearch.className = 'filter-search';
                    const searchInput = document.createElement('input');
                    searchInput.type = 'text';
                    searchInput.placeholder = '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...';
                    searchInput.onkeyup = function() { filterSearchInDropdown(this); };
                    filterSearch.appendChild(searchInput);
                    
                    const filterOptions = document.createElement('div');
                    filterOptions.className = 'filter-options';
                    const allLabel = document.createElement('label');
                    const allCheckbox = document.createElement('input');
                    allCheckbox.type = 'checkbox';
                    allCheckbox.value = 'all';
                    allCheckbox.checked = true;
                    allCheckbox.onchange = function() { toggleAllFilters(this); };
                    allLabel.appendChild(allCheckbox);
                    allLabel.appendChild(document.createTextNode(' ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î'));
                    filterOptions.appendChild(allLabel);
                    
                    filterMenu.appendChild(filterSearch);
                    filterMenu.appendChild(filterOptions);
                    filterDropdown.appendChild(filterBtn);
                    filterDropdown.appendChild(filterMenu);
                    thContent.appendChild(filterDropdown);
                }
                
                th.appendChild(thContent);
                th.dataset.key = header.key;
                // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö sort icon
                sortIcon.addEventListener('click', (e) => {
                    e.stopPropagation();
                    handleSort(header.key);
                });
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
                span.addEventListener('click', (e) => {
                    if (!e.target.closest('.filter-dropdown')) {
                        handleSort(header.key);
                    }
                });
                
                th.addEventListener('click', (e) => {
                    // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ sort ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà filter ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
                    if (!e.target.closest('.filter-dropdown')) {
                        handleSort(header.key);
                    }
                });
                headerRow.appendChild(th);
            });

            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            renderTableData(window.tableData);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV
        function parseCsvData(csvText) {
            const rows = [];
            const lines = csvText.split('\n');
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (line) {
                    let currentChar = 0;
                    let inQuotes = false;
                    let currentValue = '';
                    const values = [];
                    
                    while (currentChar < line.length) {
                        const char = line[currentChar];
                        
                        if (char === '"' && line[currentChar - 1] !== '\\') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            values.push(currentValue.replace(/^"|"$/g, '').trim());
                            currentValue = '';
                        } else {
                            currentValue += char;
                        }
                        
                        currentChar++;
                    }
                    
                    values.push(currentValue.replace(/^"|"$/g, '').trim());
                    rows.push({
                        c: values.map(value => ({ v: value }))
                    });
                }
            }
            
            return rows;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏õ‡∏µ
        function filterDataByYear(data, year) {
            return data.filter(row => {
                const yearValue = row.c[41]?.v;
                return yearValue === year.toString();
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°" ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function getMonthFromTrainingMonth(trainingMonth) {
            if (!trainingMonth || trainingMonth === '-') return null;
            
            // ‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô
            const monthMap = {
                'Jan25': 'Jan25', 'January': 'Jan25', 'Jan': 'Jan25', '1': 'Jan25',
                'Feb25': 'Feb25', 'February': 'Feb25', 'Feb': 'Feb25', '2': 'Feb25',
                'Mar25': 'Mar25', 'March': 'Mar25', 'Mar': 'Mar25', '3': 'Mar25',
                'Apr25': 'Apr25', 'April': 'Apr25', 'Apr': 'Apr25', '4': 'Apr25',
                'May25': 'May25', 'May': 'May25', '5': 'May25',
                'Jun25': 'Jun25', 'June': 'Jun25', 'Jun': 'Jun25', '6': 'Jun25',
                'Jul25': 'Jul25', 'July': 'Jul25', 'Jul': 'Jul25', '7': 'Jul25',
                'Aug25': 'Aug25', 'August': 'Aug25', 'Aug': 'Aug25', '8': 'Aug25',
                'Sep25': 'Sep25', 'September': 'Sep25', 'Sep': 'Sep25', '9': 'Sep25',
                'Oct25': 'Oct25', 'October': 'Oct25', 'Oct': 'Oct25', '10': 'Oct25',
                'Nov25': 'Nov25', 'November': 'Nov25', 'Nov': 'Nov25', '11': 'Nov25',
                'Dec25': 'Dec25', 'December': 'Dec25', 'Dec': 'Dec25', '12': 'Dec25'
            };
            
            return monthMap[trainingMonth] || null;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
        function getMonthFromEndDate(dateString) {
            if (!dateString || dateString === '-') return null;
            
            // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö dd/mm/yyyy ‡∏´‡∏£‡∏∑‡∏≠ dd/m/yyyy
            const dateMatch = dateString.match(/\d{1,2}\/(\d{1,2})\/(\d{4})/);
            if (!dateMatch) return null;
            
            const month = parseInt(dateMatch[1]);
            const year = parseInt(dateMatch[2]);
            
            // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö MonthYY ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü
            const monthNames = ['', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const yearShort = year.toString().slice(-2);
            
            if (month >= 1 && month <= 12) {
                return monthNames[month] + yearShort;
            }
            
            return null;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô
        function formatDateForChart(dateString) {
            if (!dateString || dateString === '-') return null;
            
            // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö dd/mm/yyyy ‡∏´‡∏£‡∏∑‡∏≠ dd/m/yyyy
            const dateMatch = dateString.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);
            if (!dateMatch) return null;
            
            const day = parseInt(dateMatch[1]);
            const month = parseInt(dateMatch[2]);
            const year = parseInt(dateMatch[3]);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
            if (day >= 1 && day <= 31 && month >= 1 && month <= 12 && year >= 2020) {
                // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö dd/mm/yyyy
                const dayFormatted = day.toString().padStart(2, '0');
                const monthFormatted = month.toString().padStart(2, '0');
                return `${dayFormatted}/${monthFormatted}/${year}`;
            }
            
            return null;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function updateChartAndTables(rows, selectedMonth = null, selectedStatus = null) {
            const allMonthOrder = ['Jan25', 'Feb25', 'Mar25', 'Apr25', 'May25', 'Jun25', 'Jul25', 'Aug25', 'Sep25', 'Oct25', 'Nov25', 'Dec25'];
            const allMonthLabels = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            const statusList = ["‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢", "‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô", "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å", "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°", "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°", "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°", "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö", "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥", "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°", "‡∏™‡πà‡∏á Gen ID", "Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£", "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô", "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User", "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á", "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á"];
            const colors = ['#006400', '#FF1493', '#FF6B00', '#4169E1', '#DC143C', '#FF69B4', '#008080', '#4CA64C', '#90EE90', '#9932CC', '#FF8C00', '#32CD32', '#FF4500', '#00CED1', '#1E90FF'];

            let filteredRows = rows;
            if (selectedMonth) {
                // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 28 ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 36 (‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î)
                filteredRows = filteredRows.filter(row => {
                    const endDateMonth = getMonthFromEndDate(row.c[36]?.v);
                    return endDateMonth === selectedMonth;
                });
            }
            if (selectedStatus) {
                filteredRows = filteredRows.filter(row => row.c[34]?.v === selectedStatus);
            }

            // ‡∏´‡∏≤‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
            const monthLabels = [];
            const monthOrder = [];

            allMonthOrder.forEach((month, index) => {
                const monthData = filteredRows.filter(row => {
                    const endDateMonth = getMonthFromEndDate(row.c[36]?.v);
                    return endDateMonth === month;
                });
                
                if (monthData.length > 0) {
                    monthOrder.push(month);
                    monthLabels.push(allMonthLabels[index]);
                }
            });
            


            // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏•‡∏¢ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
            if (monthOrder.length === 0) {
                monthOrder.push('Jan25');
                monthLabels.push('January');
            }

            const chartData = {
                labels: monthLabels,
                datasets: statusList.map((status, index) => ({
                    label: status,
                    data: monthOrder.map(month => {
                        // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 28 ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 36 (‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î)
                        return filteredRows.filter(row => {
                            const endDateMonth = getMonthFromEndDate(row.c[36]?.v);
                            return endDateMonth === month && row.c[34]?.v === status;
                        }).length;
                    }),
                    backgroundColor: colors[index],
                    hidden: false // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏ã‡πà‡∏≠‡∏ô ‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ legend ‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á
                }))
            };

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ max ‡πÅ‡∏ö‡∏ö dynamic ‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
            const maxDataValue = Math.max(...monthOrder.map(month => {
                return chartData.datasets.reduce((sum, dataset) => {
                    const monthIndex = monthOrder.indexOf(month);
                    return sum + (dataset.data[monthIndex] || 0);
                }, 0);
            }), 1); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            
            // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î max ‡∏Ç‡∏≠‡∏á‡πÅ‡∏Å‡∏ô Y ‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 15-20% ‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ 20 ‡∏•‡∏á‡∏ï‡∏±‡∏ß
            const dynamicMax = Math.max(100, Math.ceil(maxDataValue * 1.2 / 20) * 20);

            const chartCanvas = document.getElementById('myChart').getContext('2d');
            if (chart) {
                chart.destroy();
            }
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö mixed chart
            const mixedChartData = {
                labels: monthLabels,
                datasets: [
                    // Stack column dataset ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏° (‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°" ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ)
                    {
                        type: 'bar',
                        label: '‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°',
                        data: monthOrder.map(month => {
                            // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°" ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ
                            return filteredRows.filter(row => {
                                const trainingMonth = getMonthFromTrainingMonth(row.c[28]?.v);
                                return trainingMonth === month;
                            }).length;
                        }),
                        backgroundColor: '#203864',
                        stack: 'stack1',
                        hidden: false
                    },
                    // Line dataset ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ (‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢" ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ)
                    {
                        type: 'line',
                        label: '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                        data: monthOrder.map(month => {
                            // ‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ: ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å monthData ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ endDateMonth
                            const monthData = filteredRows.filter(row => {
                                const endDateMonth = getMonthFromEndDate(row.c[36]?.v);
                                return endDateMonth === month;
                            });
                            
                            return monthData.filter(row => row.c[34]?.v === '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢').length;
                        }),
                        borderColor: '#0EAD69',
                        backgroundColor: 'rgba(14, 173, 105, 0.1)',
                        borderWidth: 4,
                        fill: false,
                        tension: 0.4,
                        pointBackgroundColor: '#FFFFFF',
                        pointBorderColor: '#0EAD69',
                        pointRadius: 8,
                        pointHoverRadius: 10,
                        pointBorderWidth: 2,
                        yAxisID: 'y1', // ‡πÉ‡∏ä‡πâ‡πÅ‡∏Å‡∏ô Y ‡πÅ‡∏¢‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å
                        datalabels: {
                            display: true,
                            color: '#0EAD69',
                            anchor: 'end',
                            align: 'top',
                            formatter: function(value, context) {
                                // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏™‡∏∞‡∏™‡∏°
                                return value;
                            },
                            font: {
                                weight: 'bold',
                                size: 14
                            }
                        }
                    }
                ]
            };

            chart = new Chart(chartCanvas, {
                type: 'bar',
                data: mixedChartData,
                options: {
                    maintainAspectRatio: false,
                    layout: {
                        padding: {
                            top: 30
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        datalabels: {
                            color: 'white',
                            anchor: 'center',
                            align: 'center',
                            formatter: function(value, context) {
                                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö bar chart ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
                                if (context.dataset.type === 'line') {
                                    return '';
                                }
                                return value > 0 ? value : '';
                            },
                            font: {
                                weight: 'bold',
                                size: 12
                            }
                        },
                        tooltip: {
                            callbacks: {
                                footer: (tooltipItems) => {
                                    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö bar chart ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
                                    let sum = 0;
                                    tooltipItems.forEach(function(tooltipItem) {
                                        if (tooltipItem.dataset.type === 'bar') {
                                            sum += tooltipItem.parsed.y;
                                        }
                                    });
                                    return sum > 0 ? '‡∏£‡∏ß‡∏°: ' + sum : '';
                                }
                            }
                        }
                    },
                    responsive: true,
                    scales: {
                        x: {
                            stacked: true,
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            max: dynamicMax,
                            ticks: {
                                stepSize: Math.max(10, Math.ceil(dynamicMax / 20))
                            },
                            grid: {
                                color: '#e0e0e0'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            beginAtZero: true,
                            max: dynamicMax * 1.2, // ‡πÉ‡∏´‡πâ‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡∏•‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡πÅ‡∏ó‡πà‡∏á
                            ticks: {
                                display: false // ‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ö‡∏ô‡πÅ‡∏Å‡∏ô Y ‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤
                            },
                            grid: {
                                drawOnChartArea: false, // ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á grid lines ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡∏ô Y1
                            }
                        }
                    },
                    onClick: (event, elements) => {
                        if (elements.length > 0) {
                            const datasetIndex = elements[0].datasetIndex;
                            const index = elements[0].index;
                            const clickedStatus = chart.data.datasets[datasetIndex].label;
                            const clickedMonthCode = monthOrder[index]; // ‡πÉ‡∏ä‡πâ monthOrder ‡πÅ‡∏ó‡∏ô labels
                            updateChartAndTables(filteredData2025, clickedMonthCode, clickedStatus);
                        } else {
                            updateChartAndTables(filteredData2025);
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á Pivot ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å
                        updatePivotTable(filteredRows);
                        
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ
            updateSummaryTable(filteredRows, monthOrder, monthLabels);

            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Legend
            initializeLegendHandlers();

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (!filteredData2025 || filteredData2025.length === 0) {
                console.log('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• filteredData2025 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î');
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î
                document.getElementById('total-technician-count').textContent = '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                document.getElementById('new-technician-count').textContent = '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                document.getElementById('in-training-count').textContent = '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                document.getElementById('not-attended-count').textContent = '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                document.getElementById('attended-count').textContent = '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                document.getElementById('passed-training-count').textContent = '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                document.getElementById('failed-training-count').textContent = '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                return;
            }

            console.log('üìä ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•... ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', filteredData2025.length);

            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const totalTechnicianCount = countTotalTechnicians(filteredData2025);
            document.getElementById('total-technician-count').textContent = totalTechnicianCount + ' ‡∏Ñ‡∏ô';

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°" - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°"+"‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å"+"‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°"
            const notAttendedCount = filteredData2025.filter(row => {
                const status = row.c[34]?.v;
                return status === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°' || status === '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å' || status === '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°';
            }).length;
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì % ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏ï‡∏£ (‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏° √∑ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°) √ó 100
            const totalRegistration = filteredData2025.length; // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            const notAttendPercentage = totalRegistration > 0 ? ((notAttendedCount / totalRegistration) * 100).toFixed(1) : 0;
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô + % ‡πÉ‡∏ô‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö (‡πÄ‡∏ä‡πà‡∏ô 100 ‡∏Ñ‡∏ô (12.3%))
            document.getElementById('not-attended-count').textContent = `${notAttendedCount} ‡∏Ñ‡∏ô (${notAttendPercentage}%)`;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î "‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°" - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏° - ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°
            const attendedCount = totalRegistration - notAttendedCount;
            const attendedPercentage = totalRegistration > 0 ? ((attendedCount / totalRegistration) * 100).toFixed(1) : 0;
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô + % ‡πÉ‡∏ô‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö (‡πÄ‡∏ä‡πà‡∏ô 900 ‡∏Ñ‡∏ô (87.7%))
            document.getElementById('attended-count').textContent = `${attendedCount} ‡∏Ñ‡∏ô (${attendedPercentage}%)`;

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢" - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì % ‡∏à‡∏≤‡∏Å ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°
            const newTechnicianCount = countNewTechnicians(filteredData2025);
            const newTechPercentage = attendedCount > 0 ? ((newTechnicianCount / attendedCount) * 100).toFixed(2) : 0;
            document.getElementById('new-technician-count').textContent = `${newTechnicianCount} ‡∏Ñ‡∏ô (${newTechPercentage}%)`;

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÉ‡∏´‡∏°‡πà
            const inTrainingCount = countInTraining(filteredData2025);
            document.getElementById('in-training-count').textContent = inTrainingCount + ' ‡∏Ñ‡∏ô';
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î "‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°" - ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå P (15) "‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏° OntheJob" ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏ú‡πà‡∏≤‡∏ô"
            console.log('üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°...');
            console.log('üìä ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ 2025:', filteredData2025.length);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå P (15) ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ 2025
            console.log('üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 10 ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å:');
            filteredData2025.slice(0, 10).forEach((row, index) => {
                const colP = row.c[15]?.v;
                console.log(`  ‡πÅ‡∏ñ‡∏ß ${index + 1}: ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå P = "${colP}" (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß: ${colP ? colP.length : 0})`);
            });
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå P
            const allColPValues = {};
            filteredData2025.forEach(row => {
                const value = row.c[15]?.v;
                if (value) {
                    allColPValues[value] = (allColPValues[value] || 0) + 1;
                }
            });
            
            console.log('üìä ‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå P (15) ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:');
            Object.keys(allColPValues).forEach(key => {
                console.log(`  "${key}": ${allColPValues[key]} ‡∏Ñ‡∏ô`);
            });
            
            // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏ú‡πà‡∏≤‡∏ô" ‡πÅ‡∏ö‡∏ö‡∏ï‡πà‡∏≤‡∏á‡πÜ
            let passedCount1 = 0; // ‡∏ô‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö "‡∏ú‡πà‡∏≤‡∏ô" ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
            let passedCount2 = 0; // ‡∏ô‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏ú‡πà‡∏≤‡∏ô" ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
            
            filteredData2025.forEach(row => {
                const ontheJobResult = row.c[15]?.v;
                if (ontheJobResult) {
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏ï‡∏£‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    if (ontheJobResult === '‡∏ú‡πà‡∏≤‡∏ô') {
                        passedCount1++;
                    }
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏ú‡πà‡∏≤‡∏ô" ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                    if (ontheJobResult.includes('‡∏ú‡πà‡∏≤‡∏ô')) {
                        passedCount2++;
                    }
                }
            });
            
            console.log('üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö:');
            console.log(`  - ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏ú‡πà‡∏≤‡∏ô" ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô: ${passedCount1} ‡∏Ñ‡∏ô`);
            console.log(`  - ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏ú‡πà‡∏≤‡∏ô" ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: ${passedCount2} ‡∏Ñ‡∏ô`);
            
            // ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏ú‡πà‡∏≤‡∏ô" ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
            const passedTrainingCount = passedCount1;
            
            console.log('üéØ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏° OntheJob (‡∏õ‡∏µ 2025):', passedTrainingCount);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á %)
            document.getElementById('passed-training-count').textContent = passedTrainingCount + ' ‡∏Ñ‡∏ô';
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°" - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å ‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏° - ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏° - ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°
            const failedTrainingCount = attendedCount - passedTrainingCount - inTrainingCount;
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á %)
            document.getElementById('failed-training-count').textContent = failedTrainingCount + ' ‡∏Ñ‡∏ô';
            
            console.log('üìä ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≤‡∏£‡πå‡∏î "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°":');
            console.log(`  ‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°: ${attendedCount} ‡∏Ñ‡∏ô`);
            console.log(`  ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°: ${passedTrainingCount} ‡∏Ñ‡∏ô`);
            console.log(`  ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°: ${inTrainingCount} ‡∏Ñ‡∏ô`);
            console.log(`  ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°: ${attendedCount} - ${passedTrainingCount} - ${inTrainingCount} = ${failedTrainingCount} ‡∏Ñ‡∏ô`);
            
            console.log('‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô');
            console.log('üìä ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°:', totalRegistration, '‡∏Ñ‡∏ô');
            console.log('üìä ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏° (‡∏£‡∏ß‡∏° 3 ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞):', notAttendedCount, '‡∏Ñ‡∏ô (', notAttendPercentage + '%)');
            console.log('üìä ‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°:', attendedCount, '‡∏Ñ‡∏ô (', attendedPercentage + '%)');
            console.log('üìä ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°:', passedTrainingCount, '‡∏Ñ‡∏ô');

            const averageSLA = calculateAverageSLA(filteredData2025);
            document.getElementById('sla-value').textContent = averageSLA + ' ‡∏ß‡∏±‡∏ô';

            
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ï‡∏≤‡∏£‡∏≤‡∏á "‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤" ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 6 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
            const juneRelatedData = filteredData2025.filter(row => {
                const endDate = row.c[36]?.v || '';
                const startDate = row.c[35]?.v || '';
                const trainingMonth = row.c[28]?.v || '';
                
                return (endDate.includes('/6/2025') || endDate.includes('/06/2025')) ||
                       (startDate.includes('/6/2025') || startDate.includes('/06/2025')) ||
                       trainingMonth === 'Jun25';
            });
            
            // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ
            const problemStatuses = [
                '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö'
            ];
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤
            createProblemsTable(juneRelatedData, problemStatuses);
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü Area Status Chart
            createAreaStatusChart();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ SLA
        function calculateAverageSLA(rows) {
            let count = 0;
            let totalSLA = 0;
            
            // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ SLA ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"
            rows.forEach(row => {
                if (row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢") {
                    const sla = parseFloat(row.c[37]?.v) || 0;
                    if (sla > 0) {
                        totalSLA += sla;
                        count++;
                    }
                }
            });
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ ‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°
            return count > 0 ? Math.ceil(totalSLA / count) : '-';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ SLA ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏â‡∏û‡∏≤‡∏∞
        function calculateStatusSLA(rows, status) {
            let count = 0;
            let totalSLA = 0;
            
            // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ SLA ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏
            rows.forEach(row => {
                if (row.c[34]?.v === status) {
                    const sla = parseFloat(row.c[37]?.v) || 0;
                    count++; // ‡∏ô‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ SLA ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    if (sla > 0) {
                        totalSLA += sla;
                    }
                }
            });
            
            return {
                average: count > 0 && totalSLA > 0 ? Math.ceil(totalSLA / count) : '-',
                count: count
            };
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
        function countNewTechnicians(rows) {
            let count = 0;
            rows.forEach(row => {
                if (row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢") {
                    count++;
                }
            });
            return count;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°‡πÅ‡∏•‡πâ‡∏ß
        function countPassedTraining(rows) {
            let count = 0;
            rows.forEach(row => {
                const status = row.c[34]?.v;
                if (status === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢") {
                    count++;
                }
            });
            return count;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°
        function countInTraining(rows) {
            let count = 0;
            const inTrainingStatuses = [
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°"
            ];
            rows.forEach(row => {
                const status = row.c[34]?.v;
                if (inTrainingStatuses.includes(status)) {
                    count++;
                }
            });
            return count;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô
        function countFailedTraining(rows) {
            let count = 0;
            const failedStatuses = [
                "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°",
                "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°",
                "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å",
                "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°"
            ];
            rows.forEach(row => {
                const status = row.c[34]?.v;
                if (failedStatuses.includes(status)) {
                    count++;
                }
            });
            return count;
        }

        // Function to search table data
        function searchTableData() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
            
            if (!searchTerm) {
                currentPage = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
                renderTableData(window.tableData);
                return;
            }

            const filteredData = window.tableData.filter(row => {
                return Object.values(row).some(value => {
                    if (value === null || value === undefined) return false;
                    return value.toString().toLowerCase().includes(searchTerm);
                });
            });

            currentPage = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            renderTableData(filteredData);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
        function filterTableByMonth(monthName) {
            if (!window.originalTableData) {
                // ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
                window.originalTableData = window.tableData ? [...window.tableData] : [];
            }
            
            if (monthName === 'all') {
                // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
                resetTableData();
                return;
            }
            
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            const filteredData = window.originalTableData.filter(row => {
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°
                // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 'Jan25', 'Feb25', ‡∏Ø‡∏•‡∏Ø
                // ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏ï‡∏£‡∏¥‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                return row.trainingMonth && row.trainingMonth.startsWith(monthName);
            });
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            renderAllMonthData(filteredData);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
        function renderAllMonthData(data) {
            const tbody = document.querySelector('#data-table tbody');
            tbody.innerHTML = '';
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            data.forEach(row => {
                const tr = document.createElement('tr');
                Object.values(row).forEach(value => {
                    const td = document.createElement('td');
                    td.textContent = value;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
            
            // ‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            const paginationContainerTop = document.getElementById('pagination-container-top');
            if (paginationContainerTop) {
                paginationContainerTop.style.display = 'none';
            }
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏≠‡∏Å
            const dataCountInfo = document.createElement('div');
            dataCountInfo.id = 'data-count-info';
            dataCountInfo.style.textAlign = 'right';
            dataCountInfo.style.marginTop = '10px';
            dataCountInfo.style.fontSize = '14px';
            dataCountInfo.style.color = '#666';
            dataCountInfo.textContent = `‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
            
            // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
            const existingInfo = document.getElementById('data-count-info');
            if (existingInfo) {
                existingInfo.remove();
            }
            
            // ‡πÅ‡∏ó‡∏£‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const dataTable = document.getElementById('data-table');
            dataTable.parentNode.insertBefore(dataCountInfo, dataTable.nextSibling);
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
            setTimeout(() => {
                fetchDataAndUpdateTable().then(() => {
                    console.log('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô');
                }).catch(error => {
                    console.error('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
                });
            }, 1000); // ‡∏£‡∏≠ 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
            
            // ‡∏•‡∏ö event listeners ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
            const searchButton = document.getElementById('search-button');
            const searchInput = document.getElementById('search-input');
            const searchForm = document.querySelector('.search-container');

            // ‡∏•‡∏ö event listener ‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
            if (searchButton) {
                searchButton.replaceWith(searchButton.cloneNode(true));
                const newSearchButton = document.getElementById('search-button');
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡πÉ‡∏´‡∏°‡πà
                newSearchButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    searchTableData();
                });
            }

            if (searchForm) {
                searchForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    searchTableData();
                });
            }
            
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        searchTableData();
                    }
                });
            }

            const resetButton = document.getElementById('reset-filter-button');
            if (resetButton) {
                resetButton.addEventListener('click', function() {
                    resetTableData();
                });
            }

            const refreshButton = document.getElementById('refresh-button');
            if (refreshButton) {
                refreshButton.addEventListener('click', function() {
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≤‡∏ü
                    fetchDataAndUpdateTable();
                });
            }
            
            const showMainTableButton = document.getElementById('show-main-table-button');
            if (showMainTableButton) {
                showMainTableButton.addEventListener('click', function() {
                    showMainTable();
                });
            }
            
            const downloadButton = document.getElementById('download-button');
            if (downloadButton) {
                downloadButton.addEventListener('click', downloadTableAsExcel);
            }
            

            
            // Event Listeners ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤ (Top)
            const prevButtonTop = document.getElementById('prev-button-top');
            if (prevButtonTop) {
                prevButtonTop.addEventListener('click', function() {
                    if (currentPage > 1) {
                        goToPage(currentPage - 1);
                    }
                });
            }
            
            const nextButtonTop = document.getElementById('next-button-top');
            if (nextButtonTop) {
                nextButtonTop.addEventListener('click', function() {
                    if (currentPage < totalPages) {
                        goToPage(currentPage + 1);
                    }
                });
            }
            
            // Event Listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤ (Top ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)
            const pageSizeSelectTop = document.getElementById('page-size-top');
            if (pageSizeSelectTop) {
                pageSizeSelectTop.addEventListener('change', function() {
                    pageSize = parseInt(this.value);
                    currentPage = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
                    
                    renderTableData(window.tableData);
                });
            }
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° Event Listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
            const monthCards = document.querySelectorAll('.month-card');
            monthCards.forEach(card => {
                card.addEventListener('click', function() {
                    const selectedMonth = this.getAttribute('data-month');
                    filterTableByMonth(selectedMonth);
                    
                    // ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                    monthCards.forEach(c => {
                        c.style.backgroundColor = '#f0f0f0';
                        c.style.color = 'black';
                    });
                    this.style.backgroundColor = '#003366';
                    this.style.color = 'white';
                });
            });

            // Event Listeners ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤
            const problemsSearchButton = document.getElementById('problems-search-button');
            const problemsSearchInput = document.getElementById('problems-search-input');
            const problemsResetButton = document.getElementById('problems-reset-filter-button');
            const problemsRefreshButton = document.getElementById('problems-refresh-button');
            const problemsDownloadButton = document.getElementById('problems-download-button');

            if (problemsSearchButton) {
                problemsSearchButton.addEventListener('click', searchProblemsTable);
            }

            if (problemsSearchInput) {
                problemsSearchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        searchProblemsTable();
                    }
                });
            }

            if (problemsResetButton) {
                problemsResetButton.addEventListener('click', resetProblemsTable);
            }

            if (problemsRefreshButton) {
                problemsRefreshButton.addEventListener('click', refreshProblemsTable);
            }

            if (problemsDownloadButton) {
                problemsDownloadButton.addEventListener('click', downloadProblemsTable);
            }

            // Event Listeners ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
            const dailySearchInput = document.getElementById('daily-search-input');
            
            if (dailySearchInput) {
                // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå
                dailySearchInput.addEventListener('input', function() {
                    searchDailyTable();
                });
                
                // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î Enter
                dailySearchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        searchDailyTable();
                    }
                });
            }

            
            // Initialize pagination display
            const paginationContainerTop = document.getElementById('pagination-container-top');
            if (paginationContainerTop) {
                paginationContainerTop.style.display = 'flex';
            }
            
            fetchDataAndUpdateTable();
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö debug
            console.log('üîç ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Debug ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ:');
            console.log('  - debugPaginationStatus() : ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ pagination');
            console.log('  - showMainTable() : ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞ pagination ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤');
        });

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        updateCurrentDateTime();
        setInterval(updateCurrentDateTime, 1000);

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function countTotalTechnicians(rows) {
            return rows.length;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function getAllUniqueStatuses(rows) {
            const statuses = new Set();
            rows.forEach(row => {
                const status = row.c[34]?.v; // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"
                if (status && status.trim()) {
                    statuses.add(status.trim());
                }
            });
            return Array.from(statuses).sort();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ñ‡∏£‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        function validateStatusCards(rows) {
            const allStatuses = getAllUniqueStatuses(rows);
            const cardStatuses = [
                '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
                '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°',
                '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°',
                '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å',
                '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô',
                '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°'
            ];
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢‡πÑ‡∏õ
            const missingStatuses = allStatuses.filter(status => !cardStatuses.includes(status));
            
            if (missingStatuses.length > 0) {
                console.warn('‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î:', missingStatuses);
            } else {
                console.log('‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
            }
            
            console.log('‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', allStatuses);
            return { allStatuses, missingStatuses };
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡πà‡∏≤‡∏á‡πÜ
        function updateStatusCards(rows) {
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
            validateStatusCards(rows);
            
            // Debug ‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å"
            const resignedCount = debugStatusCount(rows, '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å');
            console.log('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å" ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ:', resignedCount);
            
            const statuses = [
                { id: 'sla-incomplete-docs', status: '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö' },
                { id: 'sla-not-attend', status: '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°' },
                { id: 'sla-failed-training', status: '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°' },
                { id: 'sla-resigned', status: '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å' },
                { id: 'sla-not-submitted', status: '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô' },
                { id: 'sla-criminal-record', status: '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°' },
                { id: 'sla-theory-training', status: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥' },
                { id: 'sla-practical-training', status: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°' },
                { id: 'sla-gen-id', status: '‡∏™‡πà‡∏á Gen ID' },
                { id: 'sla-print-card', status: 'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£' },
                { id: 'sla-inspection', status: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô' },
                { id: 'sla-user-request', status: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User' },
                { id: 'sla-dflow-register', status: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á' },
                { id: 'sla-dflow-qualification', status: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á' }
            ];

            statuses.forEach(item => {
                const result = calculateStatusSLA(rows, item.status);
                const element = document.getElementById(item.id);
                if (element) {
                    // Debug ‡∏Å‡∏≤‡∏£‡πå‡∏î "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å"
                    if (item.status === '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å') {
                        console.log('‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å":', result);
                    }
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÅ‡∏•‡∏∞ SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
                    if (result.count > 0 && result.average !== '-') {
                        element.textContent = `${result.count} ‡∏Ñ‡∏ô (${result.average} ‡∏ß‡∏±‡∏ô)`;
                    } else if (result.count > 0) {
                        element.textContent = `${result.count} ‡∏Ñ‡∏ô`;
                    } else {
                        element.textContent = '0 ‡∏Ñ‡∏ô';
                    }
                }
            });
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï SLA Analysis
            updateSLAAnalysis(rows);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå SLA ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
        function updateSLAAnalysis(rows) {
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
            const successRows = rows.filter(row => row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
            let successSLATotal = 0;
            let successCount = 0;
            
            successRows.forEach(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                if (sla > 0) {
                    successSLATotal += sla;
                    successCount++;
                }
            });
            
            const avgSuccessSLA = successCount > 0 ? Math.ceil(successSLATotal / successCount) : 0;
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            let totalSLA = 0;
            let totalCount = 0;
            
            rows.forEach(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                if (sla > 0) {
                    totalSLA += sla;
                    totalCount++;
                }
            });
            
            const avgTotalSLA = totalCount > 0 ? Math.ceil(totalSLA / totalCount) : 0;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î SLA
            document.getElementById('sla-success-avg').textContent = avgSuccessSLA > 0 ? `${avgSuccessSLA} ‡∏ß‡∏±‡∏ô` : '-';
            document.getElementById('sla-overall-avg').textContent = avgTotalSLA > 0 ? `${avgTotalSLA} ‡∏ß‡∏±‡∏ô` : '-';
            
            // ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ SLA
            let slaStatus = '';
            let slaStatusColor = '';
            if (avgSuccessSLA <= 30) {
                slaStatus = '‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°';
                slaStatusColor = '#28a745';
            } else if (avgSuccessSLA <= 45) {
                slaStatus = '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á';
                slaStatusColor = '#ffc107';
            } else {
                slaStatus = '‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á';
                slaStatusColor = '#dc3545';
            }
            
            const slaStatusElement = document.getElementById('sla-status');
            if (slaStatusElement) {
                slaStatusElement.textContent = slaStatus;
                slaStatusElement.parentElement.parentElement.style.backgroundColor = slaStatusColor;
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á SLA Analysis
            createSLAAnalysisTable(rows);
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
            updateSLAPerformanceIndicators(rows);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á SLA Analysis
        function createSLAAnalysisTable(rows) {
            // ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•: "‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏ï‡∏≤‡∏° SLA" ‡∏Å‡πà‡∏≠‡∏ô, ‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢ "‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°", ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ "‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°"
            const statusList = [
                // ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏ï‡∏≤‡∏° SLA
                "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢",
                // ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏• "‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°"
                "‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°",
                "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥",
                "‡∏™‡πà‡∏á Gen ID",
                "Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á",
                // ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏• "‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°"
                "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å",
                "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°", 
                "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°",
                "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°"
            ];
            
            const tbody = document.getElementById('sla-analysis-body');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            statusList.forEach(status => {
                const statusRows = rows.filter(row => row.c[34]?.v === status);
                
                if (statusRows.length > 0) {
                    // ‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô calculateStatusSLA ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î
                    const result = calculateStatusSLA(rows, status);
                    const slaValues = statusRows.map(row => parseFloat(row.c[37]?.v) || 0).filter(sla => sla > 0);
                    
                    const maxSLA = slaValues.length > 0 ? Math.max(...slaValues) : 0;
                    const minSLA = slaValues.length > 0 ? Math.min(...slaValues) : 0;
                    
                    let assessment = '';
                    let assessmentColor = '';
                    
                    if (status === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢") {
                        const avgSLANum = result.average !== '-' ? parseInt(result.average) : 0;
                        if (avgSLANum > 0 && avgSLANum <= 30) {
                            assessment = '‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°';
                            assessmentColor = '#28a745';
                        } else if (avgSLANum > 30 && avgSLANum <= 45) {
                            assessment = '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á';
                            assessmentColor = '#ffc107';
                        } else if (avgSLANum > 45) {
                            assessment = '‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á';
                            assessmentColor = '#dc3545';
                        } else {
                            assessment = '‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°';
                            assessmentColor = '#6c757d';
                        }
                    } else if (status === "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å" || status === "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°" || status === "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°" || status === "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°") {
                        assessment = '‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°';
                        assessmentColor = '#495057';
                    } else {
                        assessment = '‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°';
                        assessmentColor = '#dc3545';
                    }
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td style="padding: 8px; border: 1px solid #ddd;">${status}</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${result.count}</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${result.average}</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${maxSLA > 0 ? Math.ceil(maxSLA) : '-'}</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${minSLA > 0 ? Math.ceil(minSLA) : '-'}</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center; background-color: ${assessmentColor}; color: white; font-weight: bold;">${assessment}</td>
                    `;
                    
                    tbody.appendChild(row);
                }
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û SLA
        function updateSLAPerformanceIndicators(rows) {
            const successRows = rows.filter(row => row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
            const totalRows = rows.filter(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                return sla > 0;
            });
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (SLA <= 30 ‡∏ß‡∏±‡∏ô)
            const onTimeCount = successRows.filter(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                return sla > 0 && sla <= 30;
            }).length;
            
            const onTimePercentage = successRows.length > 0 ? ((onTimeCount / successRows.length) * 100).toFixed(1) : 0;
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î SLA (SLA > 30 ‡∏ß‡∏±‡∏ô)
            const overdueCount = totalRows.filter(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                return sla > 30;
            }).length;
            
            const overduePercentage = totalRows.length > 0 ? ((overdueCount / totalRows.length) * 100).toFixed(1) : 0;
            
            // ‡∏ô‡∏±‡∏ö‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà "‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°"
            const followUpCount = rows.filter(row => {
                const status = row.c[34]?.v;
                return status && status !== "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢" && 
                       status !== "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å" && 
                       status !== "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°" && 
                       status !== "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°" &&
                       status !== "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°";
            }).length;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î
            document.getElementById('sla-ontime-percentage').textContent = `${onTimePercentage}%`;
            document.getElementById('sla-overdue-percentage').textContent = `${overduePercentage}%`;
            document.getElementById('sla-followup-count').textContent = `${followUpCount} ‡∏Ñ‡∏ô`;
        }



        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Legend ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü Month ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
        function initializeLegendHandlers() {
            // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞ legend items ‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏ü Month ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏° Daily)
            const legendItems = document.querySelectorAll('#chart-container .chart-wrapper:first-child .legend-item');
            if (!chart || !chart.data || legendItems.length === 0) {
                return; // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏£‡∏≤‡∏ü‡∏´‡∏£‡∏∑‡∏≠ legend items ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ
            }
            
            const datasets = chart.data.datasets;
            // ‡πÉ‡∏ä‡πâ namespace ‡πÅ‡∏¢‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü Month ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
            let selectedItems = window.monthChartSelectedItems || new Set();
            window.monthChartSelectedItems = selectedItems;
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á - ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏≤‡∏ü Month
            document.addEventListener('click', (event) => {
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà legend-item ‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏ü Month ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                const clickedLegend = event.target.closest('#chart-container .chart-wrapper:first-child .legend-item');
                const clickedChart = event.target.closest('#myChart');
                const clickedDailyArea = event.target.closest('#chart-container .chart-wrapper:last-child');
                
                // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏ü Daily ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•
                if (clickedDailyArea) {
                    return;
                }
                
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà legend-item ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≤‡∏ü Month ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                if (!clickedLegend && !clickedChart) {
                    selectedItems.clear();
                    legendItems.forEach((item, i) => {
                        item.classList.remove('selected');
                        if (datasets[i]) datasets[i].hidden = false;
                    });
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü Month (chart)
                    if (chart) {
                        chart.update('none');
                    }
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ú‡∏ô‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á pivot ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å
                    updatePivotTable(filteredData2025);
                }
            });

            // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà Legend items ‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏ü Month ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
            legendItems.forEach((item, index) => {
                item.addEventListener('click', (event) => {
                    event.stopPropagation();
                    event.preventDefault();
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô legend ‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏ü Month ‡∏à‡∏£‡∏¥‡∏á‡πÜ
                    if (!event.target.closest('#chart-container .chart-wrapper:first-child')) {
                        return; // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•
                    }
                    if (event.ctrlKey || event.metaKey) {
                        if (selectedItems.has(index)) {
                            selectedItems.delete(index);
                            item.classList.remove('selected');
                        } else {
                            selectedItems.add(index);
                            item.classList.add('selected');
                        }
                    } else {
                        selectedItems.clear();
                        selectedItems.add(index);
                        legendItems.forEach((otherItem, i) => {
                            if (i === index) {
                                otherItem.classList.add('selected');
                            } else {
                                otherItem.classList.remove('selected');
                            }
                        });
                    }
                    window.monthChartSelectedItems = selectedItems;
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏£‡∏≤‡∏ü
                    datasets.forEach((dataset, i) => {
                        if (selectedItems.size === 0) {
                            // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                            dataset.hidden = false;
                        } else {
                            // ‡∏ã‡πà‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                            dataset.hidden = !selectedItems.has(i);
                        }
                    });

                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü Month (chart)
                    if (chart) {
                        chart.update('none');
                    }
                    
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á pivot ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å
                    const selectedStatuses = Array.from(selectedItems).map(i => datasets[i].label);
                    const filteredRows = filteredData2025.filter(row => {
                        if (selectedItems.size === 0) {
                            return true; // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                        } else {
                            return selectedStatuses.includes(row.c[34]?.v);
                        }
                    });
                    
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á pivot ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å updateTables
                    updatePivotTable(filteredRows);
                });
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function updateSummaryTable(filteredRows, monthOrder, monthLabels) {
            const tbody = document.getElementById('summary-table-body');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            monthOrder.forEach((month, index) => {
                const monthLabel = monthLabels[index];
                
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ
                const monthData = filteredRows.filter(row => {
                    const endDateMonth = getMonthFromEndDate(row.c[36]?.v);
                    return endDateMonth === month;
                });
                
                // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°" ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ
                const registrationCount = filteredRows.filter(row => {
                    const trainingMonth = getMonthFromTrainingMonth(row.c[28]?.v);
                    return trainingMonth === month;
                }).length;
                
                // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"
                const registeredCount = monthData.filter(row => row.c[34]?.v === '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢').length;
                const notSubmittedCount = monthData.filter(row => row.c[34]?.v === '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô').length;
                const resignedCount = monthData.filter(row => row.c[34]?.v === '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å').length;
                const criminalRecordCount = monthData.filter(row => row.c[34]?.v === '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°').length;
                const notAttendCount = monthData.filter(row => row.c[34]?.v === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°').length;
                const failedTrainingCount = monthData.filter(row => row.c[34]?.v === '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°').length;
                const incompleteDocsCount = monthData.filter(row => row.c[34]?.v === '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö').length;
                const theoryTrainingCount = monthData.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥').length;
                const ojtTrainingCount = monthData.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°').length;
                const sendGenIdCount = monthData.filter(row => row.c[34]?.v === '‡∏™‡πà‡∏á Gen ID').length;
                const printCardCount = monthData.filter(row => row.c[34]?.v === 'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£').length;
                const inspectionCount = monthData.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô').length;
                const userRequestCount = monthData.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User').length;
                const dflowRegistrationCount = monthData.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á').length;
                const dflowQualificationCount = monthData.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á').length;
                
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                const totalCount = registeredCount + notSubmittedCount + resignedCount + criminalRecordCount + 
                                 notAttendCount + failedTrainingCount + incompleteDocsCount + theoryTrainingCount + 
                                 ojtTrainingCount + sendGenIdCount + printCardCount + inspectionCount + 
                                 userRequestCount + dflowRegistrationCount + dflowQualificationCount;
                
                const row = document.createElement('tr');
                row.style.borderBottom = '1px solid #dee2e6';
                
                // ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏ñ‡∏ß
                if (index % 2 === 0) {
                    row.style.backgroundColor = '#f8f9fa';
                }
                
                row.innerHTML = `
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold;">${monthLabel}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #006400; font-weight: bold;">${registrationCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center;">${totalCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #006400; font-weight: bold;">${registeredCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #4CA64C; font-weight: bold;">${theoryTrainingCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #90EE90; font-weight: bold;">${ojtTrainingCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #FF1493; font-weight: bold;">${notSubmittedCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #FF69B4; font-weight: bold;">${failedTrainingCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #DC143C; font-weight: bold;">${notAttendCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #FF6B00; font-weight: bold;">${resignedCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #4169E1; font-weight: bold;">${criminalRecordCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #20c997; font-weight: bold;">${incompleteDocsCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #9932CC; font-weight: bold;">${sendGenIdCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #FF8C00; font-weight: bold;">${printCardCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #32CD32; font-weight: bold;">${inspectionCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #FF4500; font-weight: bold;">${userRequestCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #00CED1; font-weight: bold;">${dflowRegistrationCount}</td>
                    <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; color: #8A2BE2; font-weight: bold;">${dflowQualificationCount}</td>
                `;
                
                tbody.appendChild(row);
            });
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏ß‡∏°
            const totalAll = filteredRows.length;
            const totalRegistration = filteredRows.length; // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            const totalRegistered = filteredRows.filter(row => row.c[34]?.v === '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢').length;
            const totalTheoryTraining = filteredRows.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥').length;
            const totalOjtTraining = filteredRows.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°').length;
            const totalNotSubmitted = filteredRows.filter(row => row.c[34]?.v === '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô').length;
            const totalFailedTraining = filteredRows.filter(row => row.c[34]?.v === '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°').length;
            const totalNotAttend = filteredRows.filter(row => row.c[34]?.v === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°').length;
            const totalResigned = filteredRows.filter(row => row.c[34]?.v === '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å').length;
            const totalCriminalRecord = filteredRows.filter(row => row.c[34]?.v === '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°').length;
            const totalIncompleteDocs = filteredRows.filter(row => row.c[34]?.v === '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö').length;
            const totalSendGenId = filteredRows.filter(row => row.c[34]?.v === '‡∏™‡πà‡∏á Gen ID').length;
            const totalPrintCard = filteredRows.filter(row => row.c[34]?.v === 'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£').length;
            const totalInspection = filteredRows.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô').length;
            const totalUserRequest = filteredRows.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User').length;
            const totalDflowRegistration = filteredRows.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á').length;
            const totalDflowQualification = filteredRows.filter(row => row.c[34]?.v === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á').length;
            
            const summaryRow = document.createElement('tr');
            summaryRow.style.backgroundColor = '#e9ecef';
            summaryRow.style.borderTop = '2px solid #006400';
            summaryRow.innerHTML = `
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalRegistration}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalAll}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalRegistered}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalTheoryTraining}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalOjtTraining}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalNotSubmitted}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalFailedTraining}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalNotAttend}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalResigned}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalCriminalRecord}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalIncompleteDocs}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalSendGenId}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalPrintCard}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalInspection}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalUserRequest}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalDflowRegistration}</td>
                <td style="border: 1px solid #dee2e6; padding: 6px; text-align: center; font-weight: bold; color: #006400;">${totalDflowQualification}</td>
            `;
            
            tbody.appendChild(summaryRow);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô Excel
        function downloadTableAsExcel() {
            if (!window.XLSX) {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î Excel library ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
                return;
            }

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á HTML ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            const tempTable = document.createElement('table');
            
            // ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const headerRow = document.createElement('tr');
            const headers = document.querySelectorAll('#data-table th');
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header.textContent;
                headerRow.appendChild(th);
            });
            
            const thead = document.createElement('thead');
            thead.appendChild(headerRow);
            tempTable.appendChild(thead);
            
            const tbody = document.createElement('tbody');
            
            if (window.tableData) {
                window.tableData.forEach(row => {
                    const tr = document.createElement('tr');
                    Object.values(row).forEach(value => {
                        const td = document.createElement('td');
                        td.textContent = value;
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
            }
            
            tempTable.appendChild(tbody);
            
            try {
                const workbook = XLSX.utils.table_to_book(tempTable, { sheet: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á" });
                const now = new Date();
                const datePart = now.toLocaleDateString('th-TH', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                }).replace(/\//g, '-');
                
                const filename = `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á_${datePart}.xlsx`;
                XLSX.writeFile(workbook, filename);
            } catch (error) {
                console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå Excel:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function renderTableData(data) {
            if (!data || data.length === 0) {
                console.warn("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á");
                return;
            }
            
            const tbody = document.querySelector('#data-table tbody');
            tbody.innerHTML = '';
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            totalPages = Math.ceil(data.length / pageSize);
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, data.length);
            const currentPageData = data.slice(startIndex, endIndex);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            currentPageData.forEach(row => {
                const tr = document.createElement('tr');
                Object.values(row).forEach(value => {
                    const td = document.createElement('td');
                    td.textContent = value;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            const paginationContainerTop = document.getElementById('pagination-container-top');
            if (paginationContainerTop) {
                paginationContainerTop.style.display = 'flex';
            }
            
            // ‡πÅ‡∏™‡∏î‡∏á message ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            console.log('üîç ‡πÅ‡∏™‡∏î‡∏á pagination-container-top ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å');
            
            // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏≠‡∏Å
            const existingInfo = document.getElementById('data-count-info');
            if (existingInfo) {
                existingInfo.remove();
            }
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            updatePagination(data.length);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
        function updatePagination(totalItems) {
            if (!totalItems || totalItems === 0) {
                console.warn("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤");
                return;
            }
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            totalPages = Math.max(1, Math.ceil(totalItems / pageSize));
            
            // ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            if (currentPage > totalPages) {
                currentPage = totalPages;
            }
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï pagination container ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
            const paginationInfoTop = document.getElementById('pagination-info-top');
            const prevButtonTop = document.getElementById('prev-button-top');
            const nextButtonTop = document.getElementById('next-button-top');
            const paginationPagesTop = document.getElementById('pagination-pages-top');
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πâ‡∏≤ (Top ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)
            if (paginationInfoTop) {
                paginationInfoTop.textContent = `‡∏´‡∏ô‡πâ‡∏≤ ${currentPage} ‡∏à‡∏≤‡∏Å ${totalPages} (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${totalItems})`;
            }
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏° (Top ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)
            if (prevButtonTop) {
                prevButtonTop.disabled = currentPage === 1;
            }
            if (nextButtonTop) {
                nextButtonTop.disabled = currentPage === totalPages;
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤ (Top ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)
            if (paginationPagesTop) {
                paginationPagesTop.innerHTML = '';
            }
            
            // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á
            const maxPageButtons = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxPageButtons / 2));
            let endPage = Math.min(totalPages, startPage + maxPageButtons - 1);
            
            // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ startPage ‡πÄ‡∏°‡∏∑‡πà‡∏≠ endPage ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
            if (endPage === totalPages) {
                startPage = Math.max(1, endPage - maxPageButtons + 1);
            }
            
            // Function to create page buttons for both containers
            function createPageButtonsForContainer(container) {
                if (!container) return;
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
                if (startPage > 1) {
                    const firstPageButton = createPageButton(1);
                    container.appendChild(firstPageButton);
                    
                    if (startPage > 2) {
                        const ellipsis = document.createElement('div');
                        ellipsis.textContent = '...';
                        ellipsis.className = 'page-ellipsis';
                        container.appendChild(ellipsis);
                    }
                }
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤
                for (let i = startPage; i <= endPage; i++) {
                    const pageButton = createPageButton(i);
                    container.appendChild(pageButton);
                }
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
                if (endPage < totalPages) {
                    if (endPage < totalPages - 1) {
                        const ellipsis = document.createElement('div');
                        ellipsis.textContent = '...';
                        ellipsis.className = 'page-ellipsis';
                        container.appendChild(ellipsis);
                    }
                    
                    const lastPageButton = createPageButton(totalPages);
                    container.appendChild(lastPageButton);
                }
            }
            
            // Create page buttons for Top container only
            createPageButtonsForContainer(paginationPagesTop);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤
        function createPageButton(pageNumber) {
            const pageButton = document.createElement('div');
            pageButton.className = 'page-number' + (pageNumber === currentPage ? ' active' : '');
            pageButton.textContent = pageNumber;
            pageButton.addEventListener('click', () => goToPage(pageNumber));
            return pageButton;
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤
        function goToPage(page) {
            currentPage = page;
            renderTableData(window.tableData);
        }

        // ‡∏•‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ currentSort ‡πÅ‡∏ö‡∏ö‡πÄ‡∏Å‡πà‡∏≤ - ‡πÉ‡∏ä‡πâ sortColumn ‡πÅ‡∏•‡∏∞ sortDirection ‡πÅ‡∏•‡πâ‡∏ß

        // ‡∏•‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô handleSort ‡πÅ‡∏ö‡∏ö‡πÄ‡∏Å‡πà‡∏≤ - ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß

        // ‡∏•‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô sort ‡πÅ‡∏ö‡∏ö‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î - ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á Pivot
        function updatePivotTable(rows) {
            const pivotHeader = document.getElementById('pivot-header');
            const pivotBody = document.getElementById('pivot-body');
            
            // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå (‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏∏)
            const columns = [
                "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢",
                "‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô",
                "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å",
                "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°",
                "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°",
                "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°",
                "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°",
                "‡∏™‡πà‡∏á Gen ID",
                "Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á",
                "Grand Total"
            ];

            // ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (Oct25)
            const currentMonth = 'Oct25';
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            document.getElementById('pivot-table-title').textContent = `‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà October 2025`;
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            pivotHeader.innerHTML = `
                <th>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</th>
                ${columns.map(col => `<th>${col}</th>`).join('')}
            `;

            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const areas = [
                "RSM1_BMA-West", "RSM2_BMA-East", "RSM3_UPC-East", "RSM4_UPC-NOR",
                "RSM5_UPC-NOE1", "RSM6_UPC-NOE2", "RSM7_UPC-CEW", "RSM8_UPC-SOU"
            ];

            let tableHTML = '';
            let finalGrandTotal = new Array(columns.length).fill(0);

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            areas.forEach(area => {
                const areaData = rows.filter(row => {
                    const endDateMonth = getMonthFromEndDate(row.c[36]?.v);
                    return row.c[26]?.v === area && endDateMonth === currentMonth;
                });

                if (areaData.length > 0) {
                    const rowData = [
                        areaData.filter(row => row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°").length,
                        areaData.filter(row => row.c[34]?.v === "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°").length,
                        areaData.filter(row => row.c[34]?.v === "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°").length,
                        areaData.filter(row => row.c[34]?.v === "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ/‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏™‡πà‡∏á Gen ID").length,
                        areaData.filter(row => row.c[34]?.v === "Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥Dflow ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á").length
                    ];

                    const areaTotal = rowData.reduce((a, b) => a + b, 0);
                    rowData.push(areaTotal);

                    tableHTML += `
                        <tr>
                            <td>${area}</td>
                            ${rowData.map(val => `<td>${val || ''}</td>`).join('')}
                        </tr>
                    `;

                    rowData.forEach((val, idx) => {
                        finalGrandTotal[idx] += val;
                    });
                }
            });

            tableHTML += `
                <tr class="grand-total">
                    <td>Grand Total</td>
                    ${finalGrandTotal.map(val => `<td>${val || ''}</td>`).join('')}
                </tr>
            `;

            pivotBody.innerHTML = tableHTML;
        }

        function resetTableData() {
            if (!window.originalTableData) return;
            
            window.tableData = [...window.originalTableData];
            currentPage = 1;
            
            // ‡πÅ‡∏™‡∏î‡∏á pagination ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
            const paginationContainerTop = document.getElementById('pagination-container-top');
            if (paginationContainerTop) {
                paginationContainerTop.style.display = 'flex';
                console.log('üîç ‡πÅ‡∏™‡∏î‡∏á pagination-container-top ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï');
            }
            
            const existingInfo = document.getElementById('data-count-info');
            if (existingInfo) {
                existingInfo.remove();
            }
            
            const monthCards = document.querySelectorAll('.month-card');
            monthCards.forEach(card => {
                card.style.backgroundColor = '#f0f0f0';
                card.style.color = 'black';
            });
            
            const allButton = document.querySelector('.month-card[data-month="all"]');
            if (allButton) {
                allButton.style.backgroundColor = '#003366';
                allButton.style.color = 'white';
            }
            
            renderTableData(window.originalTableData);
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô debug ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function debugStatusCount(rows, targetStatus) {
            console.log(`=== Debug ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${targetStatus} ===`);
            console.log('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:', rows.length, '‡πÅ‡∏ñ‡∏ß');
            
            const matchedRows = rows.filter(row => row.c[34]?.v === targetStatus);
            console.log(`‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "${targetStatus}":`, matchedRows.length);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 5 ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å
            matchedRows.slice(0, 5).forEach((row, index) => {
                console.log(`‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà ${index + 1}:`, {
                    name: row.c[3]?.v,
                    status: row.c[34]?.v,
                    sla: row.c[37]?.v,
                    month: row.c[28]?.v
                });
            });
            
            return matchedRows.length;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö
        function validateAllStatusCounts(rows) {
            console.log('\n=== ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ===');
            
            const statuses = [
                '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
                '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°',
                '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°',
                '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å',
                '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô',
                '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT/‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°',
                '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                '‡∏™‡πà‡∏á Gen ID',
                'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏ñ'
            ];

            const validationResults = {};
            
            statuses.forEach(status => {
                // ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
                const actualCount = rows.filter(row => row.c[34]?.v === status).length;
                
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å calculateStatusSLA
                const calculatedResult = calculateStatusSLA(rows, status);
                
                validationResults[status] = {
                    actualCount: actualCount,
                    calculatedCount: calculatedResult.count,
                    match: actualCount === calculatedResult.count,
                    slaAverage: calculatedResult.average
                };
                
                console.log(`${status}:`);
                console.log(`  - ‡∏ô‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á: ${actualCount} ‡∏Ñ‡∏ô`);
                console.log(`  - ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: ${calculatedResult.count} ‡∏Ñ‡∏ô`);
                console.log(`  - SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ${calculatedResult.average}`);
                console.log(`  - ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô: ${actualCount === calculatedResult.count ? '‚úì' : '‚úó'}`);
                console.log('');
            });

            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ
            const mismatches = Object.entries(validationResults)
                .filter(([_, result]) => !result.match);
            
            if (mismatches.length === 0) {
                console.log('‚úÖ ‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!');
            } else {
                console.warn('‚ùå ‡∏û‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô:');
                mismatches.forEach(([status, result]) => {
                    console.warn(`  - ${status}: ‡∏à‡∏£‡∏¥‡∏á ${result.actualCount} vs ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ${result.calculatedCount}`);
                });
            }

            return validationResults;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function showStatusCardsSummary() {
            if (!filteredData2025) {
                alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
                return;
            }

            const validation = validateAllStatusCounts(filteredData2025);
            
            let summaryText = '‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:\n\n';
            
            const cardElements = [
                { id: 'sla-incomplete-docs', name: '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö' },
                { id: 'sla-not-attend', name: '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°' },
                { id: 'sla-failed-training', name: '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°' },
                { id: 'sla-resigned', name: '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å' },
                { id: 'sla-not-submitted', name: '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô' },
                { id: 'sla-criminal-record', name: '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°' },
                { id: 'sla-theory-training', name: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ' },
                { id: 'sla-practical-training', name: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏áOJT(‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°)' },
                { id: 'sla-gen-id', name: '‡∏™‡πà‡∏á Gen ID' },
                { id: 'sla-print-card', name: 'Print/‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ï‡∏£' },
                { id: 'sla-inspection', name: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô' },
                { id: 'sla-user-request', name: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠ User' },
                { id: 'sla-vehicle-approval', name: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏ñ' }
            ];

            cardElements.forEach(card => {
                const element = document.getElementById(card.id);
                const displayValue = element ? element.textContent : '‡πÑ‡∏°‡πà‡∏û‡∏ö';
                const validationData = validation[card.name];
                
                summaryText += `${card.name}:\n`;
                summaryText += `  ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏™‡∏î‡∏á: ${displayValue}\n`;
                summaryText += `  ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á: ${validationData.actualCount} ‡∏Ñ‡∏ô\n`;
                summaryText += `  ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${validationData.match ? '‚úì ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á' : '‚úó ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô'}\n\n`;
            });

            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ß‡∏°
            const totalCount = filteredData2025.length;
            const registeredCount = filteredData2025.filter(row => row.c[34]?.v === '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢').length;
            
            summaryText += `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ß‡∏°:\n`;
            summaryText += `‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${totalCount} ‡∏Ñ‡∏ô\n`;
            summaryText += `‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢: ${registeredCount} ‡∏Ñ‡∏ô\n`;

            alert(summaryText);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
        function loadDailyReport() {
            if (!filteredData2025 || filteredData2025.length === 0) {
                console.warn('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô');
                return;
            }

            // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏õ‡∏µ 2025 (‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏° trainingMonth)
            console.log(`‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏õ‡∏µ 2025:`, filteredData2025.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');

            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 6 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
            const juneRelatedData = filteredData2025.filter(row => {
                const endDate = row.c[36]?.v || '';
                const startDate = row.c[35]?.v || '';
                const trainingMonth = row.c[28]?.v || '';
                
                return (endDate.includes('/6/2025') || endDate.includes('/06/2025')) ||
                       (startDate.includes('/6/2025') || startDate.includes('/06/2025')) ||
                       trainingMonth === 'Jun25';
            });

            console.log(`‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 6:`, juneRelatedData.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
            const totalRegistered = juneRelatedData.length;
            const successCount = juneRelatedData.filter(row => row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢").length;
            
            // ‡∏ô‡∏±‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ
            const problemStatuses = [
                '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°', '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°', '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å', 
                '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°', '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô'
            ];
            
            const issuesCount = juneRelatedData.filter(row => 
                problemStatuses.includes(row.c[34]?.v)
            ).length;
            
            const successRate = totalRegistered > 0 ? ((successCount / totalRegistered) * 100).toFixed(1) : 0;

            // ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏£‡∏∏‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß



            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ (‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 6)
            createProblemsTable(juneRelatedData, problemStatuses);


            console.log('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô');
        }

                 // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤
         function createProblemsTable(data, problemStatuses) {
             // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ç‡∏≤‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
             
             // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
             const documentTypes = {
                 'R': '‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô',
                 'S': '‡∏ß‡∏∏‡∏í‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤', 
                 'U': '‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå',
                 'W': '‡πÉ‡∏ö‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà',
                 'X': '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°'
             };

             // ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î
             const allProblemsData = [];
             
             data.forEach(row => {
                 const status = row.c[34]?.v || '';
                 const name = row.c[3]?.v || '-';
                 const area = row.c[26]?.v || '-';
                 const sla = row.c[37]?.v || '-';
                 const agent = row.c[6]?.v || '-'; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å index 4 ‡πÄ‡∏õ‡πá‡∏ô 6 (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå G)
                 
                 // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î
                 const missingDocuments = [];
                 const documentColumns = {
                     'R': row.c[17]?.v || '',
                     'S': row.c[18]?.v || '',
                     'U': row.c[20]?.v || '',
                     'W': row.c[22]?.v || '',
                     'X': row.c[23]?.v || ''
                 };
                 
                 Object.keys(documentColumns).forEach(colKey => {
                     const docValue = documentColumns[colKey];
                     const docType = documentTypes[colKey];
                     
                     // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î
                     let isMissing = false;
                     
                     if (colKey === 'S') {
                         // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ß‡∏∏‡∏í‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 18) - ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏Ñ‡∏£‡∏ö ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£" ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á
                         isMissing = !docValue || docValue.trim() === '' || docValue.includes('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£');
                     } else {
                         // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£"
                         isMissing = !docValue || docValue.trim() === '' || docValue.includes('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£');
                     }
                     
                     if (isMissing) {
                         missingDocuments.push(docType);
                     }
                 });
                 
                 // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö" ‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                 if (status === '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö') {
                     allProblemsData.push({
                         name: name,
                         area: area,
                         status: status, // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"
                         missingDocs: missingDocuments,
                         sla: sla,
                         agent: agent,
                         slaNumber: parseFloat(sla) || 0
                     });
                 }
             });
             
             // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ï‡∏≤‡∏° SLA ‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢
             allProblemsData.sort((a, b) => b.slaNumber - a.slaNumber);

             // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ global
             originalProblemsData = allProblemsData;
             
             // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á
             renderProblemsTable(allProblemsData);
         }


         // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ
         function extractMonthYear(dateString) {
             if (!dateString) return '';
             
             // ‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô string
             const cleanDateString = dateString.toString().trim();
             
             // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö DD/MM/YYYY, D/M/YYYY, DD/M/YYYY, D/MM/YYYY
             if (cleanDateString.includes('/')) {
                 const parts = cleanDateString.split('/');
                 if (parts.length === 3) {
                     const month = parseInt(parts[1]);
                     const year = parseInt(parts[2]);
                     
                     // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                     if (month >= 1 && month <= 12 && year >= 2020) {
                         const monthNames = {
                             1: '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', 2: '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', 3: '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', 4: '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô',
                             5: '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', 6: '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô', 7: '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', 8: '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°',
                             9: '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', 10: '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', 11: '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', 12: '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
                         };
                         return `${monthNames[month]} ${year}`;
                     }
                 }
             }
             
             // ‡∏•‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ (DD-MM-YYYY)
             if (cleanDateString.includes('-')) {
                 const parts = cleanDateString.split('-');
                 if (parts.length === 3) {
                     const month = parseInt(parts[1]);
                     const year = parseInt(parts[2]);
                     
                     if (month >= 1 && month <= 12 && year >= 2020) {
                         const monthNames = {
                             1: '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', 2: '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', 3: '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', 4: '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô',
                             5: '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', 6: '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô', 7: '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', 8: '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°',
                             9: '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', 10: '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', 11: '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', 12: '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
                         };
                         return `${monthNames[month]} ${year}`;
                     }
                 }
             }
             
             return '';
         }

         // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö
         function convertMonthForSort(monthString) {
             if (!monthString) return 0;
             
             const monthNames = {
                 '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°': 1, '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå': 2, '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°': 3, '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô': 4,
                 '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°': 5, '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô': 6, '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°': 7, '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°': 8,
                 '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô': 9, '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°': 10, '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô': 11, '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°': 12
             };
             
             // ‡πÅ‡∏¢‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏µ ‡πÄ‡∏ä‡πà‡∏ô "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô 2025" -> ["‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô", "2025"]
             const parts = monthString.split(' ');
             if (parts.length === 2) {
                 const monthName = parts[0];
                 const year = parseInt(parts[1]);
                 const month = monthNames[monthName] || 1;
                 
                 // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö: ‡∏õ‡∏µ*100 + ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                 return year * 100 + month;
             }
             
             return 0;
         }


    </script>
</body>
</html>