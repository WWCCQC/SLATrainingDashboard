<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
            cursor: text;
        }
        th {
            background-color: #003366;
            color: white;
            padding: 12px 8px;
            text-align: center;
            position: relative;
            cursor: pointer;
            font-weight: bold;
        }
        th:hover {
            background-color: #004080;
        }
        th::after {
            content: '';
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
        }
        th.sort-asc::after {
            border-bottom: 5px solid #fff;
            margin-top: -2.5px;
        }
        th.sort-desc::after {
            border-top: 5px solid #fff;
            margin-top: 2.5px;
        }
        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô sort */
        th::before,
        th::after {
            content: '';
            position: absolute;
            right: 8px;
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            opacity: 0.7;
        }
        th::before {
            top: 40%;
            border-bottom: 5px solid #fff;
        }
        th::after {
            top: 55%;
            border-top: 5px solid #fff;
        }
        /* ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠ active */
        th.sort-asc::before {
            opacity: 1;
            border-bottom-color: #fff;
        }
        th.sort-desc::after {
            opacity: 1;
            border-top-color: #fff;
        }
        /* ‡πÄ‡∏°‡∏∑‡πà‡∏≠ hover ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô */
        th:hover::before,
        th:hover::after {
            opacity: 0.9;
        }
        .pivot-table th {
            background-color: #f4f4f4;
            color: #333;
            font-weight: normal;
        }
        .pivot-table th:first-child {
            background-color: #f4f4f4;
            color: #333;
        }
        .grand-total th, .grand-total td {
            background-color: #b7e1cd;
            color: #333;
        }
        .pivot-table th, .pivot-table td {
            background-color: #e6f3ff;
        }
        .pivot-table th:first-child, .pivot-table td:first-child {
            background-color: #d9ead3;
        }
        .area-total {
            color: #006400; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
        }
        canvas {
            margin-top: 20px;
            max-width: 800px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏£‡∏≤‡∏ü */
            max-height: 400px;
        }
        .controls {
            margin-bottom: 20px;
            display: flex;
            justify-content: flex-end;
            align-items: center;
        }
        .controls button {
            margin-right: 10px;
            padding: 10px 15px;
            font-size: 14px;
            cursor: pointer;
        }
        .card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 15px 25px;
            text-align: center;
            margin: 0;
            min-width: 250px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .card-icon {
            width: 48px;
            height: 48px;
            color: #006400;
            margin-right: 15px;
            flex-shrink: 0;
        }
        .card-content {
            flex-grow: 1;
        }
        .card-title {
            color: #333;
            font-size: 14px;
            margin-bottom: 5px;
            text-align: left;
        }
        .card-value {
            color: #006400;
            font-size: 20px;
            font-weight: bold;
            text-align: left;
        }
        #chart-container {
            margin-left: 320px;
            position: relative;
            display: flex;
            gap: 20px;
        }
        .chart-wrapper {
            flex: 1;
            min-width: 0;
            position: relative;
        }
        .total-display {
            position: absolute;
            top: -30px;
            right: 0;
            font-size: 16px;
            font-weight: bold;
            color: #006400;
        }
        #chart-label {
            position: absolute;
            top: -20px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° */
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            font-weight: bold;
        }
        canvas#myChart, canvas#lineChart {
            height: 500px !important; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏ü */
            max-height: 500px !important;
        }
        .card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 15px 25px;
            text-align: center;
            margin: 0;
            min-width: 250px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .card-content {
            flex: 1;
        }
        .card-icon {
            width: 48px;
            height: 48px;
            color: #006400;
        }
        .card-title {
            color: #333;
            font-size: 18px;
            margin-bottom: 10px;
        }
        .card-value {
            color: #006400;
            font-size: 24px;
            font-weight: bold;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å */
        #data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
        }
        #data-table th, #data-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
            cursor: text;
            background-color: white;
            position: relative;
        }
        #data-table tbody tr td {
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
            cursor: text;
        }
        #data-table th {
            background-color: #003366;
            color: white;
            padding: 12px 8px;
            text-align: center;
            position: relative;
            cursor: pointer;
            font-weight: bold;
        }
        #data-table th:hover {
            background-color: #004080;
        }
        /* ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô sort ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å */
        #data-table th::before,
        #data-table th::after {
            content: '';
            position: absolute;
            right: 8px;
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            opacity: 0.7;
        }
        #data-table th::before {
            top: 40%;
            border-bottom: 5px solid #fff;
        }
        #data-table th::after {
            top: 55%;
            border-top: 5px solid #fff;
        }
        #data-table th.sort-asc::before {
            opacity: 1;
        }
        #data-table th.sort-desc::after {
            opacity: 1;
        }
        #data-table th:hover::before,
        #data-table th:hover::after {
            opacity: 0.9;
        }
        .table-header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .table-header-container h2 {
            margin: 0;
        }
        .table-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .search-container {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .search-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            width: 200px;
        }
        .search-input:focus {
            outline: none;
            border-color: #003366;
            box-shadow: 0 0 0 2px rgba(0, 51, 102, 0.1);
        }
        .table-buttons button {
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .table-buttons button:hover {
            background-color: #f0f0f0;
        }
        .table-buttons button svg {
            width: 16px;
            height: 16px;
        }
        .legend-container {
            position: absolute;
            left: -200px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            width: 180px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .legend-item:hover {
            background-color: #f5f5f5;
        }
        .legend-item.hidden .legend-color {
            opacity: 0.5;
        }
        .legend-item.hidden span {
            color: #999;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        .header-container {
            background-color: #003366;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            width: 100%;
        }
        h1 {
            color: white;
            margin: 0;
            font-size: 24px;
        }
        #current-date {
            color: white;
            font-size: 16px;
        }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤ */
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding: 10px 0;
        }
        .pagination-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .pagination-button {
            padding: 8px 12px;
            background-color: #003366;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        .pagination-button:hover {
            background-color: #004080;
        }
        .pagination-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .pagination-info {
            font-size: 14px;
            color: #333;
            margin: 0 10px;
        }
        .page-size-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .page-size-selector select {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .page-size-selector label {
            font-size: 14px;
            color: #333;
        }
        .pagination-pages {
            display: flex;
            gap: 5px;
            align-items: center;
        }
        .page-number {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        .page-number.active {
            background-color: #003366;
            color: white;
            border-color: #003366;
        }
        .page-number:hover:not(.active) {
            background-color: #f5f5f5;
        }
        .page-ellipsis {
            padding: 6px 5px;
            font-size: 14px;
            color: #333;
        }

        /* Navigation Bar Styles */
        .nav-bar {
            background-color: #f8f9fa;
            border-bottom: 2px solid #003366;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .nav-menu {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
        }

        .nav-item {
            margin: 0;
        }

        .nav-link {
            display: block;
            padding: 15px 30px;
            text-decoration: none;
            color: #333;
            font-weight: 500;
            font-size: 16px;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .nav-link:hover {
            background-color: #e9ecef;
            color: #003366;
        }

        .nav-link.active {
            background-color: #003366;
            color: white;
            border-bottom-color: #0056b3;
        }

        .nav-link.active:hover {
            background-color: #004080;
        }

        /* Section Styles */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .section-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #003366;
        }

        .section-header h2 {
            color: #003366;
            margin: 0 0 10px 0;
            font-size: 24px;
        }

        .section-header p {
            color: #666;
            margin: 0;
            font-size: 16px;
        }

        .placeholder-content {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
        }

        /* Loading state */
        .content-section.loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .content-section.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #003366;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        /* Responsive navigation */
        @media (max-width: 768px) {
            .nav-menu {
                flex-direction: column;
            }

            .nav-link {
                padding: 12px 20px;
                text-align: center;
                border-bottom: 1px solid #ddd;
            }

            .nav-link.active {
                border-bottom: 3px solid #0056b3;
            }

            .section-header h2 {
                font-size: 20px;
            }

            .section-header p {
                font-size: 14px;
            }
        }

        /* Smooth transitions */
        .content-section {
            transition: opacity 0.3s ease-in-out;
        }

        .nav-link {
            transition: all 0.3s ease;
        }

        /* Group Code Chart Container */
        #group-code-chart-container {
            margin-left: 320px;
            position: relative;
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        #group-code-legend {
            position: absolute;
            left: -200px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            width: 180px;
        }

        canvas#groupCodeChart, canvas#groupCodeLineChart {
            height: 500px !important;
            max-height: 500px !important;
        }

        /* Animation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö loading spinner */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</head>
<body>
    <div class="header-container">
        <h1>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà(2025)</h1>
        <p id="current-date"></p>
    </div>

    <!-- Navigation Bar -->
    <nav class="nav-bar">
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="#" class="nav-link active" data-section="home">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-section="daily-report">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</a>
            </li>
        </ul>
    </nav>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å Section -->
    <div id="home-section" class="content-section active">
        <div class="section-header">
            <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ 2025</h2>
            <p>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</p>
        </div>

    <!-- Training Status Section -->
    <div id="training-status">
        <div class="controls">
            <div style="display: flex; gap: 20px; justify-content: flex-end;">
                <div class="card">
                    <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 14V16C8.69 16 6 18.69 6 22H4C4 17.58 7.58 14 12 14ZM12 13C9.33 13 7 10.67 7 8C7 5.33 9.33 3 12 3C14.67 3 17 5.33 17 8C17 10.67 14.67 13 12 13ZM12 5C10.44 5 9 6.44 9 8C9 9.56 10.44 11 12 11C13.56 11 15 9.56 15 8C15 6.44 13.56 5 12 5Z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°</div>
                        <div class="card-value" id="total-technician-count">-</div>
                    </div>
                </div>
                <div class="card">
                    <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</div>
                        <div class="card-value" id="new-technician-count">-</div>
                    </div>
                </div>
                <div class="card">
                    <svg class="card-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 14V16C8.69 16 6 18.69 6 22H4C4 17.58 7.58 14 12 14ZM12 13C9.33 13 7 10.67 7 8C7 5.33 9.33 3 12 3C14.67 3 17 5.33 17 8C17 10.67 14.67 13 12 13ZM12 5C10.44 5 9 6.44 9 8C9 9.56 10.44 11 12 11C13.56 11 15 9.56 15 8C15 6.44 13.56 5 12 5ZM20.75 16C21.44 16 22 16.56 22 17.25C22 17.94 21.44 18.5 20.75 18.5H19.5V19.75C19.5 20.44 18.94 21 18.25 21C17.56 21 17 20.44 17 19.75V18.5H15.75C15.06 18.5 14.5 17.94 14.5 17.25C14.5 16.56 15.06 16 15.75 16H17V14.75C17 14.06 17.56 13.5 18.25 13.5C18.94 13.5 19.5 14.06 19.5 14.75V16H20.75Z"/>
                    </svg>
                    <div class="card-content">
                        <div class="card-title">SLA: ‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°-‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</div>
                        <div class="card-value" id="sla-value">-</div>
                    </div>
                </div>
            </div>
        </div>

    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ -->
    <div style="display: flex; flex-wrap: nowrap; gap: 8px; margin-bottom: 20px; justify-content: center; overflow-x: auto;">
        <div class="card" style="background-color: #008080; color: white; width: 12.5%; min-width: 120px; padding: 8px 12px;">
            <div class="card-content">
                <div class="card-title" style="font-size: 13px;">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö</div>
                <div class="card-value" id="sla-incomplete-docs" style="font-size: 16px;">-</div>
            </div>
        </div>
        <div class="card" style="background-color: #DC143C; color: white; width: 12.5%; min-width: 120px; padding: 8px 12px;">
            <div class="card-content">
                <div class="card-title" style="font-size: 13px;">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°</div>
                <div class="card-value" id="sla-not-attend" style="font-size: 16px;">-</div>
            </div>
        </div>
        <div class="card" style="background-color: #FF69B4; color: white; width: 12.5%; min-width: 120px; padding: 8px 12px;">
            <div class="card-content">
                <div class="card-title" style="font-size: 13px;">‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°</div>
                <div class="card-value" id="sla-failed-training" style="font-size: 16px;">-</div>
            </div>
        </div>
        <div class="card" style="background-color: #FF6B00; color: white; width: 12.5%; min-width: 120px; padding: 8px 12px;">
            <div class="card-content">
                <div class="card-title" style="font-size: 13px;">‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å</div>
                <div class="card-value" id="sla-resigned" style="font-size: 16px;">-</div>
            </div>
        </div>
        <div class="card" style="background-color: #FF1493; color: white; width: 12.5%; min-width: 120px; padding: 8px 12px;">
            <div class="card-content">
                <div class="card-title" style="font-size: 13px;">‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</div>
                <div class="card-value" id="sla-not-submitted" style="font-size: 16px;">-</div>
            </div>
        </div>
        <div class="card" style="background-color: #4169E1; color: white; width: 12%; min-width: 120px; padding: 8px 12px;">
            <div class="card-content">
                <div class="card-title" style="font-size: 13px;">‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°</div>
                <div class="card-value" id="sla-criminal-record" style="font-size: 16px;">-</div>
            </div>
        </div>
        <div class="card" style="background-color: #4CA64C; color: white; width: 12%; min-width: 120px; padding: 8px 12px;">
            <div class="card-content">
                <div class="card-title" style="font-size: 13px;">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ</div>
                <div class="card-value" id="sla-theory-training" style="font-size: 16px;">-</div>
            </div>
        </div>
        <div class="card" style="background-color: #90EE90; color: white; width: 12%; min-width: 120px; padding: 8px 12px;">
            <div class="card-content">
                <div class="card-title" style="font-size: 13px;">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥</div>
                <div class="card-value" id="sla-practical-training" style="font-size: 16px;">-</div>
            </div>
        </div>
    </div>

    <div id="chart-container">
        <div class="chart-wrapper">
            <div class="legend-container">
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #006400;"></div>
                    <span>‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #FF6B00;"></div>
                    <span>‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #FF1493;"></div>
                    <span>‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #4169E1;"></div>
                    <span>‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #90EE90;"></div>
                    <span>‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #008080;"></div>
                    <span>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #4CA64C;"></div>
                    <span>‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #FF69B4;"></div>
                    <span>‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°</span>
                </div>
            </div>
            <div id="chart-label"></div>
            <canvas id="myChart" width="400" height="400"></canvas>
        </div>
        <div class="chart-wrapper">
            <canvas id="lineChart" width="400" height="400"></canvas>
        </div>
    </div>

    <!-- SLA Analysis Section -->
    <div style="background-color: #f8f9fa; border: 2px solid #003366; border-radius: 8px; margin: 20px 0; padding: 20px;">
        <h3 style="color: #003366; text-align: center; margin-bottom: 20px;">‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå SLA (Service Level Agreement)</h3>
        
        <!-- SLA Summary Cards -->
        <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 25px; justify-content: center;">
            <div class="card" style="background-color: #28a745; color: white; min-width: 200px; padding: 15px 20px;">
                <div class="card-content">
                    <div class="card-title" style="font-size: 16px; color: white;">SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à)</div>
                    <div class="card-value" id="sla-success-avg" style="font-size: 22px; color: white;">-</div>
                </div>
            </div>
            
            <div class="card" style="background-color: #17a2b8; color: white; min-width: 200px; padding: 15px 20px;">
                <div class="card-content">
                    <div class="card-title" style="font-size: 16px; color: white;">SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)</div>
                    <div class="card-value" id="sla-overall-avg" style="font-size: 22px; color: white;">-</div>
                </div>
            </div>
            
            <div class="card" style="background-color: #6f42c1; color: white; min-width: 200px; padding: 15px 20px;">
                <div class="card-content">
                    <div class="card-title" style="font-size: 16px; color: white;">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ SLA</div>
                    <div class="card-value" style="font-size: 22px; color: white;">‚â§ 30 ‡∏ß‡∏±‡∏ô</div>
                </div>
            </div>
            
            <div class="card" style="background-color: #fd7e14; color: white; min-width: 200px; padding: 15px 20px;">
                <div class="card-content">
                    <div class="card-title" style="font-size: 16px; color: white;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ SLA</div>
                    <div class="card-value" id="sla-status" style="font-size: 22px; color: white;">-</div>
                </div>
            </div>
        </div>

        <!-- SLA by Status Table -->
        <div style="margin: 20px 0;">
            <h4 style="color: #003366; margin-bottom: 15px;">‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå SLA ‡∏£‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h4>
            <table id="sla-analysis-table" style="width: 100%; border-collapse: collapse; background-color: white;">
                <thead>
                    <tr style="background-color: #003366; color: white;">
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: left;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏Ñ‡∏ô)</th>
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (‡∏ß‡∏±‡∏ô)</th>
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">SLA ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (‡∏ß‡∏±‡∏ô)</th>
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">SLA ‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (‡∏ß‡∏±‡∏ô)</th>
                        <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</th>
                    </tr>
                </thead>
                <tbody id="sla-analysis-body">
                    <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- SLA Performance Indicators -->
        <div style="margin: 20px 0;">
            <h4 style="color: #003366; margin-bottom: 15px;">‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û SLA</h4>
            <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                <div class="card" style="background-color: #20c997; color: white; min-width: 180px; padding: 12px 15px;">
                    <div class="card-content">
                        <div class="card-title" style="font-size: 14px; color: white;">% ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤</div>
                        <div class="card-value" id="sla-ontime-percentage" style="font-size: 18px; color: white;">-</div>
                    </div>
                </div>
                
                <div class="card" style="background-color: #e83e8c; color: white; min-width: 180px; padding: 12px 15px;">
                    <div class="card-content">
                        <div class="card-title" style="font-size: 14px; color: white;">% ‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î SLA</div>
                        <div class="card-value" id="sla-overdue-percentage" style="font-size: 18px; color: white;">-</div>
                    </div>
                </div>
                
                <div class="card" style="background-color: #ffc107; color: #212529; min-width: 180px; padding: 12px 15px;">
                    <div class="card-content">
                        <div class="card-title" style="font-size: 14px;">‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</div>
                        <div class="card-value" id="sla-followup-count" style="font-size: 18px;">-</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <h2 id="pivot-table-title">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</h2>
    <table id="pivot-table" class="pivot-table">
        <thead>
            <tr id="pivot-header"></tr>
        </thead>
        <tbody id="pivot-body"></tbody>
    </table>

    <div class="table-header-container">
        <h2>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà</h2>
    </div>
    <div style="display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 10px;">
        <div class="card month-card" data-month="all" style="background-color: #003366; color: white; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">All</div>
        <div class="card month-card" data-month="Jan" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Jan</div>
        <div class="card month-card" data-month="Feb" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Feb</div>
        <div class="card month-card" data-month="Mar" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Mar</div>
        <div class="card month-card" data-month="Apr" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Apr</div>
        <div class="card month-card" data-month="May" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">May</div>
        <div class="card month-card" data-month="Jun" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Jun</div>
        <div class="card month-card" data-month="Jul" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Jul</div>
        <div class="card month-card" data-month="Aug" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Aug</div>
        <div class="card month-card" data-month="Sep" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Sep</div>
        <div class="card month-card" data-month="Oct" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Oct</div>
        <div class="card month-card" data-month="Nov" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Nov</div>
        <div class="card month-card" data-month="Dec" style="background-color: #f0f0f0; color: black; padding: 5px 10px; font-size: 14px; min-width: auto; cursor: pointer;">Dec</div>
    </div>
    <div class="table-buttons" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: -40px; margin-bottom: 10px;">
        <form class="search-container" onsubmit="event.preventDefault(); searchTableData();">
            <input type="text" id="search-input" class="search-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...">
            <button type="button" id="search-button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
            </button>
        </form>
        <button id="reset-filter-button" title="‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 3h18v18H3z"></path>
                <path d="M21 3l-9 9M3 21l9-9"></path>
            </svg>
            ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á
        </button>
        <button id="refresh-button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"/>
            </svg>
            ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        </button>
        <button id="download-button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
            ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
        </button>
    </div>
    <table id="data-table">
        <thead>
            <tr>
                <th>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</th>
                <th>‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                <th>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°</th>
                <th>week</th>
                <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                <th>‡∏ä‡∏∑‡πà‡∏≠ ‡∏ö‡∏à‡∏Å./‡∏´‡∏à‡∏Å/‡∏£‡πâ‡∏≤‡∏ô (‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô)</th>
                <th>‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô</th>
                <th>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô</th>
                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô (‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á)</th>
                <th>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                <th>Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</th>
                <th>‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</th>
                <th>‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</th>
                <th>SLA</th>
                <th>‡∏õ‡∏µ</th>
            </tr>
        </thead>
        <tbody id="data-body"></tbody>
    </table>

    <div class="pagination-container">
        <div class="pagination-controls">
            <button id="prev-button" class="pagination-button" disabled>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
            <div class="pagination-pages" id="pagination-pages">
                <!-- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢ JavaScript -->
            </div>
            <div class="pagination-info" id="pagination-info">‡∏´‡∏ô‡πâ‡∏≤ 1 ‡∏à‡∏≤‡∏Å 10</div>
            <button id="next-button" class="pagination-button">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
        </div>
        <div class="page-size-selector">
            <label for="page-size">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤:</label>
            <select id="page-size">
                <option value="50">50</option>
                <option value="100">100</option>
                <option value="200">200</option>
            </select>
        </div>
    </div>
    <!-- End Training Status Section -->
    </div>
    <!-- End ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å Section -->

    <!-- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô Section -->
    <div id="daily-report-section" class="content-section">
        <div class="section-header">
            <h2>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h2>
            <p>‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</p>
        </div>
        
        <!-- Daily Report Content -->
        <div style="padding: 20px;">
            <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö (‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß) -->
            <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px; padding: 10px; margin-bottom: 20px;">
                <h4 style="color: #856404; margin: 0 0 10px 0;">üîß ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h4>
                <button onclick="testDailyReport()" style="padding: 8px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; margin-right: 10px; cursor: pointer;">
                    ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
                <button onclick="loadDailyReportData()" style="padding: 8px 15px; background-color: #28a745; color: white; border: none; border-radius: 4px; margin-right: 10px; cursor: pointer;">
                    ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
                </button>
                <button onclick="console.log('filteredData2025:', filteredData2025 ? filteredData2025.length + ' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£' : '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•')" style="padding: 8px 15px; background-color: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
                <div id="test-status" style="margin-top: 10px; padding: 5px; background-color: #f8f9fa; border-radius: 3px; font-size: 14px; color: #495057;"></div>
            </div>

            <!-- Daily Summary Cards -->
            <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 30px; justify-content: center;">
                <div class="card" style="background-color: #007bff; color: white; min-width: 250px; padding: 20px;">
                    <div class="card-content">
                        <div class="card-title" style="font-size: 18px; color: white;">‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                        <div class="card-value" id="daily-registered" style="font-size: 28px; color: white;">-</div>
                    </div>
                </div>
                
                <div class="card" style="background-color: #28a745; color: white; min-width: 250px; padding: 20px;">
                    <div class="card-content">
                        <div class="card-title" style="font-size: 18px; color: white;">‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                        <div class="card-value" id="daily-success" style="font-size: 28px; color: white;">-</div>
                    </div>
                </div>
                
                <div class="card" style="background-color: #ffc107; color: #212529; min-width: 250px; padding: 20px;">
                    <div class="card-content">
                        <div class="card-title" style="font-size: 18px;">‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•</div>
                        <div class="card-value" id="daily-pending" style="font-size: 28px;">-</div>
                    </div>
                </div>
                
                <div class="card" style="background-color: #dc3545; color: white; min-width: 250px; padding: 20px;">
                    <div class="card-content">
                        <div class="card-title" style="font-size: 18px; color: white;">‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤/‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</div>
                        <div class="card-value" id="daily-issues" style="font-size: 28px; color: white;">-</div>
                    </div>
                </div>
            </div>

            <!-- Daily Progress Chart -->
            <div style="background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 30px;">
                <h3 style="color: #003366; margin-bottom: 20px; text-align: center;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h3>
                <div style="width: 100%; height: 400px; display: flex; justify-content: center; align-items: center;">
                    <canvas id="dailyProgressChart" width="800" height="400"></canvas>
                </div>
            </div>

            <!-- Daily Tasks/Alerts -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <!-- Tasks for Today -->
                <div style="background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); padding: 20px;">
                    <h3 style="color: #003366; margin-bottom: 15px;">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
                    <div id="daily-tasks">
                        <div style="padding: 10px; border-left: 4px solid #007bff; margin-bottom: 10px; background-color: #f8f9fa;">
                            <strong>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô SLA</strong><br>
                            <small>‡∏°‡∏µ‡∏ä‡πà‡∏≤‡∏á 5 ‡∏Ñ‡∏ô ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô SLA 30 ‡∏ß‡∏±‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</small>
                        </div>
                        <div style="padding: 10px; border-left: 4px solid #28a745; margin-bottom: 10px; background-color: #f8f9fa;">
                            <strong>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°</strong><br>
                            <small>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ä‡πà‡∏≤‡∏á 12 ‡∏Ñ‡∏ô ‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô</small>
                        </div>
                        <div style="padding: 10px; border-left: 4px solid #ffc107; margin-bottom: 10px; background-color: #f8f9fa;">
                            <strong>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</strong><br>
                            <small>‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö 8 ‡∏ä‡∏∏‡∏î</small>
                        </div>
                    </div>
                </div>

                <!-- Recent Alerts -->
                <div style="background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); padding: 20px;">
                    <h3 style="color: #003366; margin-bottom: 15px;">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                    <div id="daily-alerts">
                        <div style="padding: 10px; border-left: 4px solid #dc3545; margin-bottom: 10px; background-color: #fff5f5;">
                            <strong>‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: SLA ‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î</strong><br>
                            <small>‡∏ä‡πà‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™ TH001234 ‡πÄ‡∏Å‡∏¥‡∏ô SLA ‡πÅ‡∏•‡πâ‡∏ß 5 ‡∏ß‡∏±‡∏ô</small>
                            <small style="display: block; color: #666;">2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß</small>
                        </div>
                        <div style="padding: 10px; border-left: 4px solid #ffc107; margin-bottom: 10px; background-color: #fffbf0;">
                            <strong>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö</strong><br>
                            <small>‡∏°‡∏µ‡∏ä‡πà‡∏≤‡∏á 3 ‡∏Ñ‡∏ô ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</small>
                            <small style="display: block; color: #666;">4 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß</small>
                        </div>
                        <div style="padding: 10px; border-left: 4px solid #17a2b8; margin-bottom: 10px; background-color: #f0f9ff;">
                            <strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ‡∏≠‡∏ö‡∏£‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</strong><br>
                            <small>‡∏£‡∏∏‡πà‡∏ô TH-2025-06 ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡πÅ‡∏•‡πâ‡∏ß</small>
                            <small style="display: block; color: #666;">6 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div style="background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); padding: 20px; margin-top: 20px;">
                <h3 style="color: #003366; margin-bottom: 15px;">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡πà‡∏ß‡∏ô</h3>
                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                    <button style="padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
                    </button>
                    <button style="padding: 10px 20px; background-color: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    </button>
                    <button style="padding: 10px 20px; background-color: #ffc107; color: #212529; border: none; border-radius: 5px; cursor: pointer;">
                        ‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                    </button>
                    <button style="padding: 10px 20px; background-color: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πà‡∏ß‡∏ô
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- End ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô Section -->

    <script>
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢
        function updateCurrentDateTime() {
            const currentDateElement = document.getElementById('current-date');
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long', hour: 'numeric', minute: 'numeric', second: 'numeric' };
            const thaiYear = now.getFullYear() + 543;
            const thaiDate = now.toLocaleDateString('th-TH', options).replace(now.getFullYear(), thaiYear);
            currentDateElement.textContent = `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${thaiDate}`;
        }

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        updateCurrentDateTime();

        // URL for Google Sheets
        const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTLKGmFsdD4oMcVdnf_wyrwAD3-3R7Ys9hXCg2gwBsudfJIUliRymBnVYHapN7a3Yq08Lgxf9cYYV6Y/pub?gid=377151035&single=true&output=csv";

        let chart;
        let originalData;
        let filteredData2025;
        let lineChart;

        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
        let currentPage = 1;
        let pageSize = 50;
        let totalPages = 1;

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function fetchDataAndUpdateTable() {
            fetch(sheetUrl)
                .then(response => response.text())
                .then(csvText => {
                    const rows = parseCsvData(csvText);
                    originalData = rows;
                    filteredData2025 = filterDataByYear(rows, 2025);
                    
                    // ‡πÅ‡∏¢‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞ pivot table
                    updateChartAndTables(filteredData2025);
                    updateLineChart(filteredData2025);
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    updateMainTable(filteredData2025);
                    
                    // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    const allButton = document.querySelector('.month-card[data-month="all"]');
                    if (allButton) {
                        // ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏õ‡∏∏‡πà‡∏° All
                        document.querySelectorAll('.month-card').forEach(card => {
                            card.style.backgroundColor = '#f0f0f0';
                            card.style.color = 'black';
                        });
                        allButton.style.backgroundColor = '#003366';
                        allButton.style.color = 'white';
                    }
                    
                    // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏≠‡∏Å
                    const existingInfo = document.getElementById('data-count-info');
                    if (existingInfo) {
                        existingInfo.remove();
                    }
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
                    const paginationContainer = document.querySelector('.pagination-container');
                    if (paginationContainer) {
                        paginationContainer.style.display = 'flex';
                    }
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢
                    loadDailyReportData();
                })
                .catch(error => {
                    console.error("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:", error);
                    const messageDiv = document.createElement('div');
                    messageDiv.style.padding = '10px';
                    messageDiv.style.margin = '10px 0';
                    messageDiv.style.backgroundColor = '#f8d7da';
                    messageDiv.style.border = '1px solid #f5c6cb';
                    messageDiv.style.borderRadius = '4px';
                    messageDiv.style.color = '#721c24';
                    messageDiv.innerHTML = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á';
                    document.querySelector('.controls').insertAdjacentElement('afterend', messageDiv);
                });
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å
        function updateMainTable(rows) {
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏õ‡∏µ 2025
            window.tableData = rows.filter(row => row.c[41]?.v === '2025').map(row => ({
                area: row.c[26]?.v || '',
                roundDate: row.c[27]?.v || '',
                trainingMonth: row.c[28]?.v || '',
                week: row.c[39]?.v || '',
                name: row.c[3]?.v || '',
                company: row.c[6]?.v || '',
                agentCode: row.c[7]?.v || '',
                province: row.c[8]?.v || '',
                workStatus: row.c[13]?.v || '',
                registerResult: row.c[33]?.v || '',
                latestStatus: row.c[34]?.v || '',
                startDate: row.c[35]?.v || '',
                endDate: row.c[36]?.v || '',
                sla: row.c[37]?.v || '',
                year: row.c[41]?.v || ''
            }));
            
            // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡πÑ‡∏ß‡πâ
            window.originalTableData = [...window.tableData];

            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
            const dataTable = document.getElementById('data-table');
            const thead = dataTable.getElementsByTagName('thead')[0];
            thead.innerHTML = '';

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß
            const headerRow = thead.insertRow();
            const columnHeaders = [
                { text: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà", key: "area" },
                { text: "‡∏£‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà", key: "roundDate" },
                { text: "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°", key: "trainingMonth" },
                { text: "week", key: "week" },
                { text: "‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•", key: "name" },
                { text: "‡∏ä‡∏∑‡πà‡∏≠ ‡∏ö‡∏à‡∏Å./‡∏´‡∏à‡∏Å/‡∏£‡πâ‡∏≤‡∏ô (‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô)", key: "company" },
                { text: "‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô", key: "agentCode" },
                { text: "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô", key: "province" },
                { text: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≠‡∏á‡∏á‡∏≤‡∏ô (‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á)", key: "workStatus" },
                { text: "‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô", key: "registerResult" },
                { text: "Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î", key: "latestStatus" },
                { text: "‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô", key: "startDate" },
                { text: "‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î", key: "endDate" },
                { text: "SLA", key: "sla" },
                { text: "‡∏õ‡∏µ", key: "year" }
            ];

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏±‡∏ß‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏û‡∏£‡πâ‡∏≠‡∏° event listener
            columnHeaders.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header.text;
                th.dataset.key = header.key;
                th.addEventListener('click', () => handleSort(header.key));
                headerRow.appendChild(th);
            });

            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            renderTableData(window.tableData);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV
        function parseCsvData(csvText) {
            const rows = [];
            const lines = csvText.split('\n');
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (line) {
                    let currentChar = 0;
                    let inQuotes = false;
                    let currentValue = '';
                    const values = [];
                    
                    while (currentChar < line.length) {
                        const char = line[currentChar];
                        
                        if (char === '"' && line[currentChar - 1] !== '\\') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            values.push(currentValue.replace(/^"|"$/g, '').trim());
                            currentValue = '';
                        } else {
                            currentValue += char;
                        }
                        
                        currentChar++;
                    }
                    
                    values.push(currentValue.replace(/^"|"$/g, '').trim());
                    rows.push({
                        c: values.map(value => ({ v: value }))
                    });
                }
            }
            
            return rows;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏õ‡∏µ
        function filterDataByYear(data, year) {
            return data.filter(row => {
                const yearValue = row.c[41]?.v;
                return yearValue === year.toString();
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function updateChartAndTables(rows, selectedMonth = null, selectedStatus = null) {
            const monthOrder = ['Jan25', 'Feb25', 'Mar25', 'Apr25', 'May25', 'Jun25'];
            const statusList = ["‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢", "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å", "‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô", "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°", "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥", "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö", "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ", "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°"];
            const colors = ['#006400', '#FF6B00', '#FF1493', '#4169E1', '#90EE90', '#008080', '#4CA64C', '#FF69B4'];

            let filteredRows = rows;
            if (selectedMonth) {
                filteredRows = filteredRows.filter(row => row.c[28]?.v === selectedMonth);
            }
            if (selectedStatus) {
                filteredRows = filteredRows.filter(row => row.c[34]?.v === selectedStatus);
            }

            const chartData = {
                labels: monthOrder,
                datasets: statusList.map((status, index) => ({
                    label: status,
                    data: monthOrder.map(month => {
                        return filteredRows.filter(row => row.c[28]?.v === month && row.c[34]?.v === status).length;
                    }),
                    backgroundColor: colors[index],
                    hidden: false // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏ã‡πà‡∏≠‡∏ô ‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ legend ‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á
                }))
            };

            const chartCanvas = document.getElementById('myChart').getContext('2d');
            if (chart) {
                chart.destroy();
            }
            chart = new Chart(chartCanvas, {
                type: 'bar',
                data: chartData,
                options: {
                    maintainAspectRatio: false,
                    layout: {
                        padding: {
                            top: 30
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        datalabels: {
                            color: 'white',
                            anchor: 'center',
                            align: 'center',
                            formatter: function(value) {
                                return value > 0 ? value : '';
                            },
                            font: {
                                weight: 'bold',
                                size: 14
                            }
                        },
                        tooltip: {
                            callbacks: {
                                footer: (tooltipItems) => {
                                    let sum = 0;
                                    tooltipItems.forEach(function(tooltipItem) {
                                        sum += tooltipItem.parsed.y;
                                    });
                                    return '‡∏£‡∏ß‡∏°: ' + sum;
                                }
                            }
                        }
                    },
                    responsive: true,
                    scales: {
                        x: {
                            stacked: true,
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            max: 120,
                            ticks: {
                                stepSize: 10
                            },
                            grid: {
                                color: '#e0e0e0'
                            }
                        }
                    },
                    onClick: (event, elements) => {
                        if (elements.length > 0) {
                            const datasetIndex = elements[0].datasetIndex;
                            const index = elements[0].index;
                            const clickedStatus = chart.data.datasets[datasetIndex].label;
                            const clickedMonth = chart.data.labels[index];
                            updateChartAndTables(filteredData2025, clickedMonth, clickedStatus);
                        } else {
                            updateChartAndTables(filteredData2025);
                        }
                    }
                },
                plugins: [ChartDataLabels, {
                    // Plugin ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ö‡∏ô‡πÅ‡∏ó‡πà‡∏á ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ legend ‡πÑ‡∏´‡∏ô‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                    afterDatasetsDraw: function(chart) {
                        if (window.selectedLegendItems && window.selectedLegendItems.size > 0) return;
                        const ctx = chart.ctx;
                        const datasets = chart.data.datasets;
                        const labels = chart.data.labels;
                        labels.forEach((label, i) => {
                            let sum = 0;
                            datasets.forEach(ds => {
                                if (!ds.hidden) sum += ds.data[i] || 0;
                            });
                            // ‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á y ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏ó‡πà‡∏á
                            let meta = null;
                            for (let d = datasets.length - 1; d >= 0; d--) {
                                if (!datasets[d].hidden && datasets[d].data[i] > 0) {
                                    meta = chart.getDatasetMeta(d);
                                    break;
                                }
                            }
                            if (meta && meta.data[i]) {
                                const x = meta.data[i].x;
                                const y = meta.data[i].y - 10;
                                ctx.save();
                                ctx.font = 'bold 16px Arial';
                                ctx.fillStyle = '#000';
                                ctx.textAlign = 'center';
                                ctx.fillText(sum, x, y);
                                ctx.restore();
                            }
                        });
                    }
                }]
            });

            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á Pivot ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å
            updatePivotTable(filteredRows);

            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Legend
            initializeLegendHandlers();

            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const totalTechnicianCount = countTotalTechnicians(filteredData2025);
            document.getElementById('total-technician-count').textContent = totalTechnicianCount + ' ‡∏Ñ‡∏ô';

            const newTechnicianCount = countNewTechnicians(filteredData2025);
            const percentage = ((newTechnicianCount / totalTechnicianCount) * 100).toFixed(2);
            document.getElementById('new-technician-count').textContent = `${newTechnicianCount} ‡∏Ñ‡∏ô (${percentage}%)`;

            const averageSLA = calculateAverageSLA(filteredData2025);
            document.getElementById('sla-value').textContent = averageSLA + ' ‡∏ß‡∏±‡∏ô';

            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡πà‡∏≤‡∏á‡πÜ
            updateStatusCards(filteredData2025);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ SLA
        function calculateAverageSLA(rows) {
            let count = 0;
            let totalSLA = 0;
            
            // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ SLA ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"
            rows.forEach(row => {
                if (row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢") {
                    const sla = parseFloat(row.c[37]?.v) || 0;
                    if (sla > 0) {
                        totalSLA += sla;
                        count++;
                    }
                }
            });
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ ‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏°
            return count > 0 ? Math.ceil(totalSLA / count) : '-';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ SLA ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏â‡∏û‡∏≤‡∏∞
        function calculateStatusSLA(rows, status) {
            let count = 0;
            let totalSLA = 0;
            
            // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ SLA ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏
            rows.forEach(row => {
                if (row.c[34]?.v === status) {
                    const sla = parseFloat(row.c[37]?.v) || 0;
                    count++; // ‡∏ô‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ SLA ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    if (sla > 0) {
                        totalSLA += sla;
                    }
                }
            });
            
            return {
                average: count > 0 && totalSLA > 0 ? Math.ceil(totalSLA / count) : '-',
                count: count
            };
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
        function countNewTechnicians(rows) {
            let count = 0;
            rows.forEach(row => {
                if (row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢") {
                    count++;
                }
            });
            return count;
        }

        // Function to search table data
        function searchTableData() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
            
            if (!searchTerm) {
                currentPage = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
                renderTableData(window.tableData);
                return;
            }

            const filteredData = window.tableData.filter(row => {
                return Object.values(row).some(value => {
                    if (value === null || value === undefined) return false;
                    return value.toString().toLowerCase().includes(searchTerm);
                });
            });

            currentPage = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            renderTableData(filteredData);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
        function filterTableByMonth(monthName) {
            if (!window.originalTableData) {
                // ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
                window.originalTableData = window.tableData ? [...window.tableData] : [];
            }
            
            if (monthName === 'all') {
                // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï
                resetTableData();
                return;
            }
            
            // ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            const filteredData = window.originalTableData.filter(row => {
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°
                // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏ö‡∏£‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 'Jan25', 'Feb25', ‡∏Ø‡∏•‡∏Ø
                // ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏ï‡∏£‡∏¥‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                return row.trainingMonth && row.trainingMonth.startsWith(monthName);
            });
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            renderAllMonthData(filteredData);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
        function renderAllMonthData(data) {
            const tbody = document.querySelector('#data-table tbody');
            tbody.innerHTML = '';
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            data.forEach(row => {
                const tr = document.createElement('tr');
                Object.values(row).forEach(value => {
                    const td = document.createElement('td');
                    td.textContent = value;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
            
            // ‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            const paginationContainer = document.querySelector('.pagination-container');
            paginationContainer.style.display = 'none';
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏≠‡∏Å
            const dataCountInfo = document.createElement('div');
            dataCountInfo.id = 'data-count-info';
            dataCountInfo.style.textAlign = 'right';
            dataCountInfo.style.marginTop = '10px';
            dataCountInfo.style.fontSize = '14px';
            dataCountInfo.style.color = '#666';
            dataCountInfo.textContent = `‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
            
            // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
            const existingInfo = document.getElementById('data-count-info');
            if (existingInfo) {
                existingInfo.remove();
            }
            
            // ‡πÅ‡∏ó‡∏£‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const dataTable = document.getElementById('data-table');
            dataTable.parentNode.insertBefore(dataCountInfo, dataTable.nextSibling);
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°
        document.addEventListener('DOMContentLoaded', function() {
            // ‡∏•‡∏ö event listeners ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
            const searchButton = document.getElementById('search-button');
            const searchInput = document.getElementById('search-input');
            const searchForm = document.querySelector('.search-container');

            // ‡∏•‡∏ö event listener ‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
            if (searchButton) {
                searchButton.replaceWith(searchButton.cloneNode(true));
                const newSearchButton = document.getElementById('search-button');
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡πÉ‡∏´‡∏°‡πà
                newSearchButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    searchTableData();
                });
            }

            if (searchForm) {
                searchForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    searchTableData();
                });
            }
            
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        searchTableData();
                    }
                });
            }

            const resetButton = document.getElementById('reset-filter-button');
            if (resetButton) {
                resetButton.addEventListener('click', function() {
                    resetTableData();
                });
            }

            const refreshButton = document.getElementById('refresh-button');
            if (refreshButton) {
                refreshButton.addEventListener('click', function() {
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≤‡∏ü
                    fetchDataAndUpdateTable();
                });
            }
            
            const downloadButton = document.getElementById('download-button');
            if (downloadButton) {
                downloadButton.addEventListener('click', downloadTableAsExcel);
            }
            
            // Event Listeners ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            const prevButton = document.getElementById('prev-button');
            if (prevButton) {
                prevButton.addEventListener('click', function() {
                    if (currentPage > 1) {
                        goToPage(currentPage - 1);
                    }
                });
            }
            
            const nextButton = document.getElementById('next-button');
            if (nextButton) {
                nextButton.addEventListener('click', function() {
                    if (currentPage < totalPages) {
                        goToPage(currentPage + 1);
                    }
                });
            }
            
            // Event Listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤
            const pageSizeSelect = document.getElementById('page-size');
            if (pageSizeSelect) {
                pageSizeSelect.addEventListener('change', function() {
                    pageSize = parseInt(this.value);
                    currentPage = 1; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
                    renderTableData(window.tableData);
                });
            }
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° Event Listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
            const monthCards = document.querySelectorAll('.month-card');
            monthCards.forEach(card => {
                card.addEventListener('click', function() {
                    const selectedMonth = this.getAttribute('data-month');
                    filterTableByMonth(selectedMonth);
                    
                    // ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                    monthCards.forEach(c => {
                        c.style.backgroundColor = '#f0f0f0';
                        c.style.color = 'black';
                    });
                    this.style.backgroundColor = '#003366';
                    this.style.color = 'white';
                });
            });

            // ‡πÄ‡∏û‡∏¥‡πà‡∏° Navigation Event Listeners
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');

            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetSection = this.getAttribute('data-section');
                    console.log('‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà nav:', targetSection);
                    
                    // ‡∏•‡∏ö active class ‡∏à‡∏≤‡∏Å nav links ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    navLinks.forEach(navLink => {
                        navLink.classList.remove('active');
                    });
                    
                    // ‡πÄ‡∏û‡∏¥‡πà‡∏° active class ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö link ‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å
                    this.classList.add('active');
                    
                    // ‡∏ã‡πà‡∏≠‡∏ô sections ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    contentSections.forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // ‡πÅ‡∏™‡∏î‡∏á section ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                    const activeSection = document.getElementById(targetSection + '-section');
                    if (activeSection) {
                        activeSection.classList.add('active');
                        console.log('‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤:', targetSection + '-section');
                        
                        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô ‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
                        if (targetSection === 'daily-report') {
                            console.log('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô...');
                            
                            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                            if (!filteredData2025) {
                                console.warn('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà...');
                                fetchDataAndUpdateTable();
                                // ‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏Å loadDailyReportData
                                setTimeout(() => {
                                    if (filteredData2025) {
                                        loadDailyReportData();
                                    } else {
                                        console.warn('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
                                    }
                                }, 3000);
                            } else {
                                console.log('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•...');
                                loadDailyReportData();
                            }
                            
                            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£ retry ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                            setTimeout(() => {
                                const dailyRegistered = document.getElementById('daily-registered');
                                if (dailyRegistered && (dailyRegistered.textContent === '-' || dailyRegistered.textContent === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...')) {
                                    console.log('‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á...');
                                    loadDailyReportData();
                                }
                            }, 2000);
                        }
                    } else {
                        console.error('‡πÑ‡∏°‡πà‡∏û‡∏ö section:', targetSection + '-section');
                    }
                });
            });

            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
            console.log('‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô...');
            fetchDataAndUpdateTable();
            
            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö navigation
            setTimeout(() => {
                console.log('=== ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Navigation System ===');
                const navLinks = document.querySelectorAll('.nav-link');
                const contentSections = document.querySelectorAll('.content-section');
                console.log('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Nav Links:', navLinks.length);
                console.log('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Content Sections:', contentSections.length);
                
                navLinks.forEach((link, index) => {
                    console.log(`Nav Link ${index + 1}:`, link.getAttribute('data-section'), link.textContent.trim());
                });
                
                contentSections.forEach((section, index) => {
                    console.log(`Content Section ${index + 1}:`, section.id, section.classList.contains('active') ? 'ACTIVE' : 'HIDDEN');
                });
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ daily report elements ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                console.log('=== ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Daily Report Elements ===');
                const dailyElements = [
                    'daily-registered',
                    'daily-success', 
                    'daily-pending',
                    'daily-issues',
                    'dailyProgressChart',
                    'daily-tasks'
                ];
                
                dailyElements.forEach(elementId => {
                    const element = document.getElementById(elementId);
                    console.log(`Element ${elementId}:`, element ? '‡∏û‡∏ö' : '‡πÑ‡∏°‡πà‡∏û‡∏ö');
                    if (element && element.textContent) {
                        console.log(`  ‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: "${element.textContent.trim()}"`);
                    }
                });
                
                // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                console.log('=== ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô ===');
                if (filteredData2025) {
                    console.log('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• filteredData2025 ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:', filteredData2025.length);
                    console.log('‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏Å loadDailyReportData()...');
                    loadDailyReportData();
                } else {
                    console.warn('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• filteredData2025 ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°');
                }
            }, 2000);
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å console
            window.testDailyReport = function() {
                console.log('=== ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á ===');
                
                const statusDiv = document.getElementById('test-status');
                let statusText = '';
                
                console.log('1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• filteredData2025:', filteredData2025 ? filteredData2025.length : '‡πÑ‡∏°‡πà‡∏°‡∏µ');
                statusText += `üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${filteredData2025 ? filteredData2025.length + ' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£' : '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'}<br>`;
                
                console.log('2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô...');
                
                const dailySection = document.getElementById('daily-report-section');
                console.log('3. ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô:', dailySection ? '‡∏û‡∏ö' : '‡πÑ‡∏°‡πà‡∏û‡∏ö');
                statusText += `üì± ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô: ${dailySection ? '‡∏û‡∏ö' : '‡πÑ‡∏°‡πà‡∏û‡∏ö'}<br>`;
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö elements
                const elements = ['daily-registered', 'daily-success', 'daily-pending', 'daily-issues'];
                let foundElements = 0;
                elements.forEach(id => {
                    if (document.getElementById(id)) foundElements++;
                });
                statusText += `üéØ Elements: ${foundElements}/${elements.length} ‡∏û‡∏ö<br>`;
                
                if (statusDiv) {
                    statusDiv.innerHTML = statusText;
                }
                
                if (dailySection) {
                    console.log('4. ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô...');
                    
                    // ‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ
                    document.querySelectorAll('.content-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
                    dailySection.classList.add('active');
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï nav
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('data-section') === 'daily-report') {
                            link.classList.add('active');
                        }
                    });
                    
                    console.log('5. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
                    statusText += `üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...<br>`;
                    if (statusDiv) statusDiv.innerHTML = statusText;
                    
                    setTimeout(() => {
                        loadDailyReportData();
                        statusText += `‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î<br>`;
                        if (statusDiv) statusDiv.innerHTML = statusText;
                    }, 500);
                } else {
                    statusText += `‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô<br>`;
                    if (statusDiv) statusDiv.innerHTML = statusText;
                }
            };
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á
            window.switchToDailyReport = function() {
                const navLink = document.querySelector('.nav-link[data-section="daily-report"]');
                if (navLink) {
                    navLink.click();
                } else {
                    console.error('‡πÑ‡∏°‡πà‡∏û‡∏ö nav link ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô');
                }
            };
            
            console.log('=== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ===');
            console.log('‡∏û‡∏¥‡∏°‡∏û‡πå testDailyReport() ‡πÉ‡∏ô console ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
            console.log('‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå switchToDailyReport() ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô');
        });

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        updateCurrentDateTime();

        // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        fetchDataAndUpdateTable();

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function countTotalTechnicians(rows) {
            return rows.length;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function getAllUniqueStatuses(rows) {
            const statuses = new Set();
            rows.forEach(row => {
                const status = row.c[34]?.v; // ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "Status ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"
                if (status && status.trim()) {
                    statuses.add(status.trim());
                }
            });
            return Array.from(statuses).sort();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ñ‡∏£‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        function validateStatusCards(rows) {
            const allStatuses = getAllUniqueStatuses(rows);
            const cardStatuses = [
                '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
                '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°',
                '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°',
                '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å',
                '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô',
                '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥'
            ];
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢‡πÑ‡∏õ
            const missingStatuses = allStatuses.filter(status => !cardStatuses.includes(status));
            
            if (missingStatuses.length > 0) {
                console.warn('‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î:', missingStatuses);
            } else {
                console.log('‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
            }
            
            console.log('‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', allStatuses);
            return { allStatuses, missingStatuses };
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡πà‡∏≤‡∏á‡πÜ
        function updateStatusCards(rows) {
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
            validateStatusCards(rows);
            
            // Debug ‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å"
            const resignedCount = debugStatusCount(rows, '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å');
            console.log('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å" ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö‡πÑ‡∏î‡πâ:', resignedCount);
            
            const statuses = [
                { id: 'sla-incomplete-docs', status: '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö' },
                { id: 'sla-not-attend', status: '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°' },
                { id: 'sla-failed-training', status: '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°' },
                { id: 'sla-resigned', status: '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å' },
                { id: 'sla-not-submitted', status: '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô' },
                { id: 'sla-criminal-record', status: '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°' },
                { id: 'sla-theory-training', status: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ' },
                { id: 'sla-practical-training', status: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥' }
            ];

            statuses.forEach(item => {
                const result = calculateStatusSLA(rows, item.status);
                const element = document.getElementById(item.id);
                if (element) {
                    // Debug ‡∏Å‡∏≤‡∏£‡πå‡∏î "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å"
                    if (item.status === '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å') {
                        console.log('‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å":', result);
                    }
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÅ‡∏•‡∏∞ SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
                    if (result.count > 0 && result.average !== '-') {
                        element.textContent = `${result.count} ‡∏Ñ‡∏ô (${result.average} ‡∏ß‡∏±‡∏ô)`;
                    } else if (result.count > 0) {
                        element.textContent = `${result.count} ‡∏Ñ‡∏ô`;
                    } else {
                        element.textContent = '0 ‡∏Ñ‡∏ô';
                    }
                }
            });
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï SLA Analysis
            updateSLAAnalysis(rows);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå SLA ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
        function updateSLAAnalysis(rows) {
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
            const successRows = rows.filter(row => row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
            let successSLATotal = 0;
            let successCount = 0;
            
            successRows.forEach(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                if (sla > 0) {
                    successSLATotal += sla;
                    successCount++;
                }
            });
            
            const avgSuccessSLA = successCount > 0 ? Math.ceil(successSLATotal / successCount) : 0;
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            let totalSLA = 0;
            let totalCount = 0;
            
            rows.forEach(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                if (sla > 0) {
                    totalSLA += sla;
                    totalCount++;
                }
            });
            
            const avgTotalSLA = totalCount > 0 ? Math.ceil(totalSLA / totalCount) : 0;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î SLA
            document.getElementById('sla-success-avg').textContent = avgSuccessSLA > 0 ? `${avgSuccessSLA} ‡∏ß‡∏±‡∏ô` : '-';
            document.getElementById('sla-overall-avg').textContent = avgTotalSLA > 0 ? `${avgTotalSLA} ‡∏ß‡∏±‡∏ô` : '-';
            
            // ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ SLA
            let slaStatus = '';
            let slaStatusColor = '';
            if (avgSuccessSLA <= 30) {
                slaStatus = '‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°';
                slaStatusColor = '#28a745';
            } else if (avgSuccessSLA <= 45) {
                slaStatus = '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á';
                slaStatusColor = '#ffc107';
            } else {
                slaStatus = '‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á';
                slaStatusColor = '#dc3545';
            }
            
            const slaStatusElement = document.getElementById('sla-status');
            if (slaStatusElement) {
                slaStatusElement.textContent = slaStatus;
                slaStatusElement.parentElement.parentElement.style.backgroundColor = slaStatusColor;
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á SLA Analysis
            createSLAAnalysisTable(rows);
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
            updateSLAPerformanceIndicators(rows);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á SLA Analysis
        function createSLAAnalysisTable(rows) {
            const statusList = [
                "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢",
                "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å", 
                "‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô",
                "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥",
                "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ",
                "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°",
                "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°"
            ];
            
            const tbody = document.getElementById('sla-analysis-body');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            statusList.forEach(status => {
                const statusRows = rows.filter(row => row.c[34]?.v === status);
                
                if (statusRows.length > 0) {
                    // ‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô calculateStatusSLA ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î
                    const result = calculateStatusSLA(rows, status);
                    const slaValues = statusRows.map(row => parseFloat(row.c[37]?.v) || 0).filter(sla => sla > 0);
                    
                    const maxSLA = slaValues.length > 0 ? Math.max(...slaValues) : 0;
                    const minSLA = slaValues.length > 0 ? Math.min(...slaValues) : 0;
                    
                    let assessment = '';
                    let assessmentColor = '';
                    
                    if (status === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢") {
                        const avgSLANum = result.average !== '-' ? parseInt(result.average) : 0;
                        if (avgSLANum > 0 && avgSLANum <= 30) {
                            assessment = '‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°';
                            assessmentColor = '#28a745';
                        } else if (avgSLANum > 30 && avgSLANum <= 45) {
                            assessment = '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á';
                            assessmentColor = '#ffc107';
                        } else if (avgSLANum > 45) {
                            assessment = '‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á';
                            assessmentColor = '#dc3545';
                        } else {
                            assessment = '‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°';
                            assessmentColor = '#6c757d';
                        }
                    } else if (status === "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å") {
                        assessment = '‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°';
                        assessmentColor = '#28a745';
                    } else {
                        assessment = '‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°';
                        assessmentColor = '#6c757d';
                    }
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td style="padding: 8px; border: 1px solid #ddd;">${status}</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${result.count}</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${result.average}</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${maxSLA > 0 ? Math.ceil(maxSLA) : '-'}</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${minSLA > 0 ? Math.ceil(minSLA) : '-'}</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: center; background-color: ${assessmentColor}; color: white; font-weight: bold;">${assessment}</td>
                    `;
                    
                    tbody.appendChild(row);
                }
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û SLA
        function updateSLAPerformanceIndicators(rows) {
            const successRows = rows.filter(row => row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
            const totalRows = rows.filter(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                return sla > 0;
            });
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (SLA <= 30 ‡∏ß‡∏±‡∏ô)
            const onTimeCount = successRows.filter(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                return sla > 0 && sla <= 30;
            }).length;
            
            const onTimePercentage = successRows.length > 0 ? ((onTimeCount / successRows.length) * 100).toFixed(1) : 0;
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î SLA (SLA > 30 ‡∏ß‡∏±‡∏ô)
            const overdueCount = totalRows.filter(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                return sla > 30;
            }).length;
            
            const overduePercentage = totalRows.length > 0 ? ((overdueCount / totalRows.length) * 100).toFixed(1) : 0;
            
            // ‡∏ô‡∏±‡∏ö‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢" ‡πÅ‡∏•‡∏∞ "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å"
            const followUpCount = rows.filter(row => {
                const status = row.c[34]?.v;
                return status && status !== "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢" && status !== "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å";
            }).length;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î
            document.getElementById('sla-ontime-percentage').textContent = `${onTimePercentage}%`;
            document.getElementById('sla-overdue-percentage').textContent = `${overduePercentage}%`;
            document.getElementById('sla-followup-count').textContent = `${followUpCount} ‡∏Ñ‡∏ô`;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Line Chart
        function updateLineChart(rows) {
            const monthOrder = ['Jan25', 'Feb25', 'Mar25', 'Apr25', 'May25', 'Jun25'];
            const lineChartCanvas = document.getElementById('lineChart').getContext('2d');

            const lineChartData = {
                labels: monthOrder,
                datasets: [{
                    label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà',
                    data: monthOrder.map(month => {
                        return rows.filter(row => row.c[28]?.v === month && row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢").length;
                    }),
                    backgroundColor: '#006400',
                    borderColor: '#006400',
                    fill: true
                }]
            };

            if (lineChart) {
                lineChart.destroy();
            }

            lineChart = new Chart(lineChartCanvas, {
                type: 'bar',
                data: lineChartData,
                options: {
                    responsive: true,
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            formatter: function(value) {
                                return value === 0 ? '' : Math.round(value);
                            },
                            font: {
                                weight: 'bold',
                                size: 14
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 120,
                            ticks: {
                                stepSize: 10
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Legend
        function initializeLegendHandlers() {
            const legendItems = document.querySelectorAll('.legend-item');
            if (!chart || !chart.data || legendItems.length === 0) {
                return; // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏£‡∏≤‡∏ü‡∏´‡∏£‡∏∑‡∏≠ legend items ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ
            }
            
            const datasets = chart.data.datasets;
            let selectedItems = window.selectedLegendItems || new Set();
            window.selectedLegendItems = selectedItems;
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á
            document.addEventListener('click', (event) => {
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà legend-item ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                const clickedLegend = event.target.closest('.legend-item');
                const clickedChart = event.target.closest('canvas');
                
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà legend-item ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≤‡∏ü ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                if (!clickedLegend && !clickedChart) {
                    selectedItems.clear();
                    legendItems.forEach((item, i) => {
                        item.classList.remove('selected');
                        if (datasets[i]) datasets[i].hidden = false;
                    });
                    if (chart) chart.update();
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ú‡∏ô‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á pivot ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å
                    updatePivotTable(filteredData2025);
                }
            });

            // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà Legend items
            legendItems.forEach((item, index) => {
                item.addEventListener('click', (event) => {
                    event.stopPropagation();
                    if (event.ctrlKey || event.metaKey) {
                        if (selectedItems.has(index)) {
                            selectedItems.delete(index);
                            item.classList.remove('selected');
                        } else {
                            selectedItems.add(index);
                            item.classList.add('selected');
                        }
                    } else {
                        selectedItems.clear();
                        selectedItems.add(index);
                        legendItems.forEach((otherItem, i) => {
                            if (i === index) {
                                otherItem.classList.add('selected');
                            } else {
                                otherItem.classList.remove('selected');
                            }
                        });
                    }
                    window.selectedLegendItems = selectedItems;
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏£‡∏≤‡∏ü
                    datasets.forEach((dataset, i) => {
                        if (selectedItems.size === 0) {
                            // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                            dataset.hidden = false;
                        } else {
                            // ‡∏ã‡πà‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                            dataset.hidden = !selectedItems.has(i);
                        }
                    });

                    if (chart) chart.update();
                    
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á pivot ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å
                    const selectedStatuses = Array.from(selectedItems).map(i => datasets[i].label);
                    const filteredRows = filteredData2025.filter(row => {
                        if (selectedItems.size === 0) {
                            return true; // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                        } else {
                            return selectedStatuses.includes(row.c[34]?.v);
                        }
                    });
                    
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á pivot ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å updateTables
                    updatePivotTable(filteredRows);
                });
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô Excel
        function downloadTableAsExcel() {
            if (!window.XLSX) {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î Excel library ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
                return;
            }

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á HTML ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            const tempTable = document.createElement('table');
            
            // ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const headerRow = document.createElement('tr');
            const headers = document.querySelectorAll('#data-table th');
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header.textContent;
                headerRow.appendChild(th);
            });
            
            const thead = document.createElement('thead');
            thead.appendChild(headerRow);
            tempTable.appendChild(thead);
            
            const tbody = document.createElement('tbody');
            
            if (window.tableData) {
                window.tableData.forEach(row => {
                    const tr = document.createElement('tr');
                    Object.values(row).forEach(value => {
                        const td = document.createElement('td');
                        td.textContent = value;
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
            }
            
            tempTable.appendChild(tbody);
            
            try {
                const workbook = XLSX.utils.table_to_book(tempTable, { sheet: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á" });
                const now = new Date();
                const datePart = now.toLocaleDateString('th-TH', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                }).replace(/\//g, '-');
                
                const filename = `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á_${datePart}.xlsx`;
                XLSX.writeFile(workbook, filename);
            } catch (error) {
                console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå Excel:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        function renderTableData(data) {
            if (!data || data.length === 0) {
                console.warn("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á");
                return;
            }
            
            const tbody = document.querySelector('#data-table tbody');
            tbody.innerHTML = '';
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            totalPages = Math.ceil(data.length / pageSize);
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, data.length);
            const currentPageData = data.slice(startIndex, endIndex);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            currentPageData.forEach(row => {
                const tr = document.createElement('tr');
                Object.values(row).forEach(value => {
                    const td = document.createElement('td');
                    td.textContent = value;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            const paginationContainer = document.querySelector('.pagination-container');
            if (paginationContainer) {
                paginationContainer.style.display = 'flex';
            }
            
            // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏≠‡∏Å
            const existingInfo = document.getElementById('data-count-info');
            if (existingInfo) {
                existingInfo.remove();
            }
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
            updatePagination(data.length);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤
        function updatePagination(totalItems) {
            if (!totalItems || totalItems === 0) {
                console.warn("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤");
                return;
            }
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            totalPages = Math.max(1, Math.ceil(totalItems / pageSize));
            
            // ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            if (currentPage > totalPages) {
                currentPage = totalPages;
            }
            
            const paginationInfo = document.getElementById('pagination-info');
            const prevButton = document.getElementById('prev-button');
            const nextButton = document.getElementById('next-button');
            const paginationPages = document.getElementById('pagination-pages');
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πâ‡∏≤
            paginationInfo.textContent = `‡∏´‡∏ô‡πâ‡∏≤ ${currentPage} ‡∏à‡∏≤‡∏Å ${totalPages} (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${totalItems})`;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°
            prevButton.disabled = currentPage === 1;
            nextButton.disabled = currentPage === totalPages;
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤
            paginationPages.innerHTML = '';
            
            // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á
            const maxPageButtons = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxPageButtons / 2));
            let endPage = Math.min(totalPages, startPage + maxPageButtons - 1);
            
            // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ startPage ‡πÄ‡∏°‡∏∑‡πà‡∏≠ endPage ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
            if (endPage === totalPages) {
                startPage = Math.max(1, endPage - maxPageButtons + 1);
            }
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
            if (startPage > 1) {
                const firstPageButton = createPageButton(1);
                paginationPages.appendChild(firstPageButton);
                
                if (startPage > 2) {
                    const ellipsis = document.createElement('div');
                    ellipsis.textContent = '...';
                    ellipsis.className = 'page-ellipsis';
                    paginationPages.appendChild(ellipsis);
                }
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤
            for (let i = startPage; i <= endPage; i++) {
                const pageButton = createPageButton(i);
                paginationPages.appendChild(pageButton);
            }
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    const ellipsis = document.createElement('div');
                    ellipsis.textContent = '...';
                    ellipsis.className = 'page-ellipsis';
                    paginationPages.appendChild(ellipsis);
                }
                
                const lastPageButton = createPageButton(totalPages);
                paginationPages.appendChild(lastPageButton);
            }
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤
        function createPageButton(pageNumber) {
            const pageButton = document.createElement('div');
            pageButton.className = 'page-number' + (pageNumber === currentPage ? ' active' : '');
            pageButton.textContent = pageNumber;
            pageButton.addEventListener('click', () => goToPage(pageNumber));
            return pageButton;
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤
        function goToPage(page) {
            currentPage = page;
            renderTableData(window.tableData);
        }

        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£ sort
        let currentSort = {
            key: null,
            isAsc: true
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£ sort
        function handleSort(key) {
            const isAsc = currentSort.key === key ? !currentSort.isAsc : true;
            currentSort = { key, isAsc };

            const sortedData = sortData(window.tableData, key, isAsc);
            renderTableData(sortedData);
            updateSortIndicators(key, isAsc);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô sort ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function sortData(data, key, isAsc) {
            return [...data].sort((a, b) => {
                let valueA = a[key];
                let valueB = b[key];

                // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á
                if (!valueA && valueA !== 0) return isAsc ? 1 : -1;
                if (!valueB && valueB !== 0) return isAsc ? -1 : 1;

                // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
                if (key === 'week') {
                    valueA = parseInt(valueA.replace(/\D/g, '')) || 0;
                    valueB = parseInt(valueB.replace(/\D/g, '')) || 0;
                } else if (key === 'trainingMonth') {
                    const months = {
                        'Jan': 1, 'Feb': 2, 'Mar': 3, 'Apr': 4,
                        'May': 5, 'Jun': 6, 'Jul': 7, 'Aug': 8,
                        'Sep': 9, 'Oct': 10, 'Nov': 11, 'Dec': 12
                    };
                    valueA = months[valueA.substring(0, 3)] || 0;
                    valueB = months[valueB.substring(0, 3)] || 0;
                } else if (key === 'startDate' || key === 'endDate') {
                    const parseDate = (str) => {
                        const [day, month, year] = (str || '').split('/').map(Number);
                        return day ? new Date(year, month - 1, day) : new Date(0);
                    };
                    valueA = parseDate(valueA);
                    valueB = parseDate(valueB);
                } else if (key === 'sla') {
                    valueA = parseFloat(valueA) || 0;
                    valueB = parseFloat(valueB) || 0;
                }

                // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡πà‡∏≤
                if (valueA instanceof Date) {
                    return isAsc ? valueA - valueB : valueB - valueA;
                }
                if (typeof valueA === 'number') {
                    return isAsc ? valueA - valueB : valueB - valueA;
                }
                return isAsc ? 
                    String(valueA).localeCompare(String(valueB), 'th') : 
                    String(valueB).localeCompare(String(valueA), 'th');
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô sort
        function updateSortIndicators(key, isAsc) {
            const headers = document.querySelectorAll('#data-table th');
            headers.forEach(header => {
                header.classList.remove('sort-asc', 'sort-desc');
                if (header.dataset.key === key) {
                    header.classList.add(isAsc ? 'sort-asc' : 'sort-desc');
                }
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á Pivot
        function updatePivotTable(rows) {
            const pivotHeader = document.getElementById('pivot-header');
            const pivotBody = document.getElementById('pivot-body');
            
            // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
            const columns = [
                "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢",
                "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å",
                "‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô",
                "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥",
                "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö",
                "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ",
                "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°",
                "Grand Total"
            ];

            // ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (Jun25)
            const currentMonth = 'Jun25';
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            document.getElementById('pivot-table-title').textContent = `‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà June 2025`;
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            pivotHeader.innerHTML = `
                <th>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</th>
                ${columns.map(col => `<th>${col}</th>`).join('')}
            `;

            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const areas = [
                "RSM1_BMA-West", "RSM2_BMA-East", "RSM3_UPC-East", "RSM4_UPC-NOR",
                "RSM5_UPC-NOE1", "RSM6_UPC-NOE2", "RSM7_UPC-CEW", "RSM8_UPC-SOU"
            ];

            let tableHTML = '';
            let finalGrandTotal = new Array(columns.length).fill(0);

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            areas.forEach(area => {
                const areaData = rows.filter(row => 
                    row.c[26]?.v === area && row.c[28]?.v === currentMonth
                );

                if (areaData.length > 0) {
                    const rowData = [
                        areaData.filter(row => row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥").length,
                        areaData.filter(row => row.c[34]?.v === "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö").length,
                        areaData.filter(row => row.c[34]?.v === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ").length,
                        areaData.filter(row => row.c[34]?.v === "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°").length
                    ];

                    const areaTotal = rowData.reduce((a, b) => a + b, 0);
                    rowData.push(areaTotal);

                    tableHTML += `
                        <tr>
                            <td>${area}</td>
                            ${rowData.map(val => `<td>${val || ''}</td>`).join('')}
                        </tr>
                    `;

                    rowData.forEach((val, idx) => {
                        finalGrandTotal[idx] += val;
                    });
                }
            });

            tableHTML += `
                <tr class="grand-total">
                    <td>Grand Total</td>
                    ${finalGrandTotal.map(val => `<td>${val || ''}</td>`).join('')}
                </tr>
            `;

            pivotBody.innerHTML = tableHTML;
        }

        function resetTableData() {
            if (!window.originalTableData) return;
            
            window.tableData = [...window.originalTableData];
            currentPage = 1;
            
            const paginationContainer = document.querySelector('.pagination-container');
            if (paginationContainer) {
                paginationContainer.style.display = 'flex';
            }
            
            const existingInfo = document.getElementById('data-count-info');
            if (existingInfo) {
                existingInfo.remove();
            }
            
            const monthCards = document.querySelectorAll('.month-card');
            monthCards.forEach(card => {
                card.style.backgroundColor = '#f0f0f0';
                card.style.color = 'black';
            });
            
            const allButton = document.querySelector('.month-card[data-month="all"]');
            if (allButton) {
                allButton.style.backgroundColor = '#003366';
                allButton.style.color = 'white';
            }
            
            renderTableData(window.originalTableData);
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô debug ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function debugStatusCount(rows, targetStatus) {
            console.log(`=== Debug ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${targetStatus} ===`);
            console.log('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:', rows.length, '‡πÅ‡∏ñ‡∏ß');
            
            const matchedRows = rows.filter(row => row.c[34]?.v === targetStatus);
            console.log(`‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "${targetStatus}":`, matchedRows.length);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 5 ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å
            matchedRows.slice(0, 5).forEach((row, index) => {
                console.log(`‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà ${index + 1}:`, {
                    name: row.c[3]?.v,
                    status: row.c[34]?.v,
                    sla: row.c[37]?.v,
                    month: row.c[28]?.v
                });
            });
            
            return matchedRows.length;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö
        function validateAllStatusCounts(rows) {
            console.log('\n=== ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ===');
            
            const statuses = [
                '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
                '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°',
                '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°',
                '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å',
                '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô',
                '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ',
                '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥',
                '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'
            ];

            const validationResults = {};
            
            statuses.forEach(status => {
                // ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
                const actualCount = rows.filter(row => row.c[34]?.v === status).length;
                
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å calculateStatusSLA
                const calculatedResult = calculateStatusSLA(rows, status);
                
                validationResults[status] = {
                    actualCount: actualCount,
                    calculatedCount: calculatedResult.count,
                    match: actualCount === calculatedResult.count,
                    slaAverage: calculatedResult.average
                };
                
                console.log(`${status}:`);
                console.log(`  - ‡∏ô‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á: ${actualCount} ‡∏Ñ‡∏ô`);
                console.log(`  - ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô: ${calculatedResult.count} ‡∏Ñ‡∏ô`);
                console.log(`  - SLA ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ${calculatedResult.average}`);
                console.log(`  - ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô: ${actualCount === calculatedResult.count ? '‚úì' : '‚úó'}`);
                console.log('');
            });

            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ
            const mismatches = Object.entries(validationResults)
                .filter(([_, result]) => !result.match);
            
            if (mismatches.length === 0) {
                console.log('‚úÖ ‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!');
            } else {
                console.warn('‚ùå ‡∏û‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô:');
                mismatches.forEach(([status, result]) => {
                    console.warn(`  - ${status}: ‡∏à‡∏£‡∏¥‡∏á ${result.actualCount} vs ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ${result.calculatedCount}`);
                });
            }

            return validationResults;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function showStatusCardsSummary() {
            if (!filteredData2025) {
                alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
                return;
            }

            const validation = validateAllStatusCounts(filteredData2025);
            
            let summaryText = '‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:\n\n';
            
            const cardElements = [
                { id: 'sla-incomplete-docs', name: '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö' },
                { id: 'sla-not-attend', name: '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°' },
                { id: 'sla-failed-training', name: '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°' },
                { id: 'sla-resigned', name: '‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å' },
                { id: 'sla-not-submitted', name: '‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô' },
                { id: 'sla-criminal-record', name: '‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°' },
                { id: 'sla-theory-training', name: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ' },
                { id: 'sla-practical-training', name: '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥' }
            ];

            cardElements.forEach(card => {
                const element = document.getElementById(card.id);
                const displayValue = element ? element.textContent : '‡πÑ‡∏°‡πà‡∏û‡∏ö';
                const validationData = validation[card.name];
                
                summaryText += `${card.name}:\n`;
                summaryText += `  ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏™‡∏î‡∏á: ${displayValue}\n`;
                summaryText += `  ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á: ${validationData.actualCount} ‡∏Ñ‡∏ô\n`;
                summaryText += `  ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${validationData.match ? '‚úì ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á' : '‚úó ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô'}\n\n`;
            });

            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ß‡∏°
            const totalCount = filteredData2025.length;
            const registeredCount = filteredData2025.filter(row => row.c[34]?.v === '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢').length;
            
            summaryText += `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ß‡∏°:\n`;
            summaryText += `‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${totalCount} ‡∏Ñ‡∏ô\n`;
            summaryText += `‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢: ${registeredCount} ‡∏Ñ‡∏ô\n`;

            alert(summaryText);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
        function loadDailyReportData() {
            console.log('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô...');
            console.log('filteredData2025:', filteredData2025 ? filteredData2025.length : '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
            
            if (!filteredData2025 || filteredData2025.length === 0) {
                console.warn('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô');
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° loading
                const dailyRegistered = document.getElementById('daily-registered');
                const dailySuccess = document.getElementById('daily-success');
                const dailyPending = document.getElementById('daily-pending');
                const dailyIssues = document.getElementById('daily-issues');
                
                if (dailyRegistered) dailyRegistered.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
                if (dailySuccess) dailySuccess.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
                if (dailyPending) dailyPending.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
                if (dailyIssues) dailyIssues.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
                
                // ‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
                setTimeout(() => {
                    if (!filteredData2025) {
                        console.log('‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà...');
                        fetchDataAndUpdateTable();
                    }
                }, 1000);
                return;
            }
            
            console.log('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å June 2025...');
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å June 2025 (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
            const currentMonthData = filteredData2025.filter(row => row.c[28]?.v === 'Jun25');
            console.log('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• June 2025:', currentMonthData.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
            
            // ‡∏ô‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            const totalRegistered = currentMonthData.length;
            const successfulRegistrations = currentMonthData.filter(row => 
                row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"
            ).length;
            
            const pendingCases = currentMonthData.filter(row => 
                row.c[34]?.v === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ" || 
                row.c[34]?.v === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏ö‡∏£‡∏°‡∏õ‡∏é‡∏¥‡∏ö‡∏±‡∏ï‡∏¥" ||
                row.c[34]?.v === "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö"
            ).length;
            
            const issues = currentMonthData.filter(row => 
                row.c[34]?.v === "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏ö‡∏£‡∏°" || 
                row.c[34]?.v === "‡∏ï‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏°" ||
                row.c[34]?.v === "‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°" ||
                row.c[34]?.v === "‡∏ä‡πà‡∏≤‡∏á‡∏•‡∏≤‡∏≠‡∏≠‡∏Å" ||
                row.c[34]?.v === "‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô"
            ).length;
            
            console.log('‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì:', {
                totalRegistered,
                successfulRegistrations,
                pendingCases,
                issues
            });
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const dailyRegistered = document.getElementById('daily-registered');
            const dailySuccess = document.getElementById('daily-success');
            const dailyPending = document.getElementById('daily-pending');
            const dailyIssues = document.getElementById('daily-issues');
            
            if (dailyRegistered) {
                dailyRegistered.textContent = totalRegistered + ' ‡∏Ñ‡∏ô';
                console.log('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï daily-registered:', totalRegistered + ' ‡∏Ñ‡∏ô');
            } else {
                console.error('‡πÑ‡∏°‡πà‡∏û‡∏ö element daily-registered');
            }
            
            if (dailySuccess) {
                dailySuccess.textContent = successfulRegistrations + ' ‡∏Ñ‡∏ô';
                console.log('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï daily-success:', successfulRegistrations + ' ‡∏Ñ‡∏ô');
            } else {
                console.error('‡πÑ‡∏°‡πà‡∏û‡∏ö element daily-success');
            }
            
            if (dailyPending) {
                dailyPending.textContent = pendingCases + ' ‡∏Ñ‡∏ô';
                console.log('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï daily-pending:', pendingCases + ' ‡∏Ñ‡∏ô');
            } else {
                console.error('‡πÑ‡∏°‡πà‡∏û‡∏ö element daily-pending');
            }
            
            if (dailyIssues) {
                dailyIssues.textContent = issues + ' ‡∏Ñ‡∏ô';
                console.log('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï daily-issues:', issues + ' ‡∏Ñ‡∏ô');
            } else {
                console.error('‡πÑ‡∏°‡πà‡∏û‡∏ö element daily-issues');
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
            console.log('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤...');
            createDailyProgressChart();
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
            console.log('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...');
            updateDailyTasks(currentMonthData);
            
            console.log('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
        function updateDailyTasks(currentMonthData) {
            // ‡∏ô‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô SLA 30 ‡∏ß‡∏±‡∏ô
            const overdueSLA = currentMonthData.filter(row => {
                const sla = parseFloat(row.c[37]?.v) || 0;
                return sla > 30;
            }).length;
            
            // ‡∏ô‡∏±‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
            const incompleteDocsCount = currentMonthData.filter(row => 
                row.c[34]?.v === "‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö"
            ).length;
            
            // ‡∏ô‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡πÅ‡∏•‡πâ‡∏ß
            const completedTraining = currentMonthData.filter(row => 
                row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"
            ).length;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï tasks
            const tasksContainer = document.getElementById('daily-tasks');
            tasksContainer.innerHTML = `
                <div style="padding: 10px; border-left: 4px solid #dc3545; margin-bottom: 10px; background-color: #f8f9fa;">
                    <strong>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô SLA</strong><br>
                    <small>‡∏°‡∏µ‡∏ä‡πà‡∏≤‡∏á ${overdueSLA} ‡∏Ñ‡∏ô ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô SLA 30 ‡∏ß‡∏±‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</small>
                </div>
                <div style="padding: 10px; border-left: 4px solid #28a745; margin-bottom: 10px; background-color: #f8f9fa;">
                    <strong>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°</strong><br>
                    <small>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ä‡πà‡∏≤‡∏á ${completedTraining} ‡∏Ñ‡∏ô ‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</small>
                </div>
                <div style="padding: 10px; border-left: 4px solid #ffc107; margin-bottom: 10px; background-color: #f8f9fa;">
                    <strong>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</strong><br>
                    <small>‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ${incompleteDocsCount} ‡∏ä‡∏∏‡∏î</small>
                </div>
            `;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
        function createDailyProgressChart() {
            const canvas = document.getElementById('dailyProgressChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ
            const monthOrder = ['Jan25', 'Feb25', 'Mar25', 'Apr25', 'May25', 'Jun25'];
            const monthLabels = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.'];
            
            const registrationData = monthOrder.map(month => {
                return filteredData2025.filter(row => row.c[28]?.v === month).length;
            });
            
            const successData = monthOrder.map(month => {
                return filteredData2025.filter(row => 
                    row.c[28]?.v === month && row.c[34]?.v === "‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"
                ).length;
            });
            
            if (window.dailyChart) {
                window.dailyChart.destroy();
            }
            
            window.dailyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: monthLabels,
                    datasets: [{
                        label: '‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà',
                        data: registrationData,
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: '‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        data: successData,
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏õ‡∏µ 2025'
                        },
                        datalabels: {
                            display: true,
                            anchor: 'end',
                            align: 'top',
                            formatter: function(value) {
                                return value === 0 ? '' : value;
                            },
                            font: {
                                weight: 'bold',
                                size: 12
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 5
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }
    </script>
</body>
</html>